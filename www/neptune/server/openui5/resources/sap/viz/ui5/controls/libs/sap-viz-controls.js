/* SAP CVOM 4.0 Â© <2012-2014> SAP AG. All rights reserved. Build Version PI_bycheckin.1761 */
if(requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._){window.__sap_viz_internal_requirejs_nextTick__=requirejs.s.contexts._.nextTick;requirejs.s.contexts._.nextTick=function(f){f()}}define('sap/viz/controls/Version',[],function(){var V={};V.VERSION='PI_bycheckin.1761';return V});define('sap/viz/controls/common/config/GlobalConfig',[],function(){function f(n,s){if(n.length===0)return;if(n.length===1)return s[n[0]];var p=n.shift();if(s[p]!=null)return f(n,s[p]);return}var m=f("sap/viz/controls/common/config/GlobalConfig".split("/"),this);if(m)return m;var G={};G.DEFAULT_UICONFIG_TYPE_BUILDER='uiconfig-builder';G.DEFAULT_UICONFIG_TYPE_CHART='uiconfig-chart';G.DEFAULT_UICONFIG_TYPE_FEEDING='uiconfig-feeding';G.DEFAULT_UICONFIG_TYPE_FRAME='uiconfig-frame';G.DEFAULT_UICONFIG_TYPE_SWITCHBAR='uiconfig-switchbar';G.DEFAULT_UICONFIG_TYPE_FILTERBAR0='uiconfig-filterbar0';G.DEFAULT_UICONFIG_TYPE_FILTERBAR='uiconfig-filterbar';G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU='uiconfig-contextmenu';G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON='uiconfig-custombutton';G.DEFAULT_UICONFIG_TYPE_ANNOTATION='uiconfig-annotation';G.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL='uiconfig-annotationcontrol';G.DEFAULT_UICONFIG_TYPE_MAPBUILDER='uiconfig-mapbuilder';G.DEFAULT_UICONFIG_TYPE_PROPERTYEDITOR='uiconfig-propertyeditor';var _="../src";var a=false;var b={};var d=function(){if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getServiceMetadata!==undefined){var s;try{s=sap.bi.framework.getServiceMetadata("sap.viz.controls.common.config")}catch(e){}if(s&&s.customProperties.defaultAssetsRoot){return s.framework.bundleUrl+"/"+s.customProperties.defaultAssetsRoot}}return undefined};G.registerUIConfig=function(i,u){if(i!=null){b[i]=u}};G.defaultUIConfig=function(t){var u={};if(t!=null&&b[t]!=null&&b[t].instance){return b[t].instance()}for(var i in b){if(i&&b[i]&&b[i].instance){u[i]=b[i].instance()}}return u};G.defaultAssetsRoot=function(p){if(arguments.length>0){_=p;a=true;G._setResourcePath()}else{if(a){return _}var c=d();if(c){return c}return _}};G._setResourcePath=function(){var p=[G.defaultAssetsRoot()+"/locale/"];var c=sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths");var n=c?p.concat(c):p;sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths",n)};return G});define('sap/viz/controls/common/constants/ChartConst',[],function(){var C={};C.TYPE_COLUMN="viz/column";C.TYPE_STACKED_COLUMN="viz/stacked_column";C.TYPE_DUAL_COLUMN="viz/dual_column";C.TYPE_3D_COLUMN="viz/3d_column";C.TYPE_LINE="viz/line";C.TYPE_AREA="viz/area";C.TYPE_COMBINATION="viz/combination";C.TYPE_DUAL_LINE="viz/dual_line";C.TYPE_DUAL_COMBINATION="viz/dual_combination";C.TYPE_PIE="viz/pie";C.TYPE_DONUT="viz/donut";C.TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";C.TYPE_GEO_BUBBLE="viz/geobubble";C.TYPE_GEO_CHOROPLETH="viz/choropleth";C.TYPE_GEO_PIE="viz/geopie";C.TYPE_GEO_MAP='viz/geomap';C.TYPE_SCATTER="viz/scatter";C.TYPE_BUBBLE="viz/bubble";C.TYPE_SCATTER_MATRIX="viz/scatter_matrix";C.TYPE_HEATMAP="viz/heatmap";C.TYPE_TREEMAP="viz/treemap";C.TYPE_TABLE="viz/ext/table";C.TYPE_CROSSTAB="viz/ext/crosstab";C.TYPE_RADAR="viz/radar";C.TYPE_BOXPLOT="viz/boxplot";C.TYPE_WATERFALL="viz/waterfall";C.TYPE_TAG_CLOUD="viz/tagcloud";C.TYPE_TREE="viz/tree";C.TYPE_NETWORK="viz/network";C.TYPE_FUNNEL='viz/ext/pa/funnel';C.TYPE_PC='viz/ext/pa/pc';C.TYPE_NUMBER='viz/number';C.DIRECTION_HORIZONTAL="horizontal";C.DIRECTION_VERTICAL="vertical";C.STACKING_FULL="full";C.STACKING_NORMAL="normal";C.TYPE_BAR="viz/bar";C.TYPE_STACKED_BAR="viz/stacked_bar";C.TYPE_100_STACKED_COLUMN="viz/100_stacked_column";C.TYPE_100_STACKED_BAR="viz/100_stacked_bar";C.TYPE_DUAL_BAR="viz/dual_bar";C.TYPE_3D_BAR="viz/3d_bar";C.TYPE_HORIZONTAL_LINE="viz/horizontal_line";C.TYPE_HORIZONTAL_AREA="viz/horizontal_area";C.TYPE_100_AREA="viz/100_area";C.TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";C.TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";C.TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";C.TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";C.TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";C.TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";C.TYPE_BULLET="viz/bullet";C.TYPE_INFO_BAR="info/bar";C.TYPE_INFO_COLUMN="info/column";C.TYPE_INFO_LINE="info/line";C.TYPE_INFO_HORIZONTAL_LINE="info/horizontal_line";C.TYPE_INFO_DONUT="info/donut";C.FEEDING_PRIMARY_VALUES="primaryValues";C.FEEDING_SECONDARY_VALUES="secondaryValues";C.FEEDING_AXIS_LABELS="axisLabels";C.MEASURE_NAMES_DIMENSION="measureNamesDimension";C.MEASURE_VALUES_GROUP="measureValuesGroup";C.ANALYSIS_AXIS="analysisAxis";C.AXIS_XAXIS="xAxis";C.AXIS_XAXIS1="xAxis1";C.AXIS_XAXIS2="xAxis2";C.AXIS_YAXIS="yAxis";C.AXIS_YAXIS1="yAxis1";C.AXIS_YAXIS2="yAxis2";return C});define('sap/viz/controls/common/constants/CSSConst',[],function(){var C={};C.PREFIX="viz-controls-";C.COMMON_PREFIX=C.PREFIX+"common-";C.SWITCHBAR_PREFIX=C.PREFIX+"switchbar-";C.FEEDINGPANEL_PREFIX=C.PREFIX+"feeding-";C.PROPERTYEDITOR_PREFIX=C.PREFIX+"propertyeditor-";C.VIZDATAPICKER_PREFIX=C.PREFIX+"datapicker-";C.FRAME_PREFIX=C.PREFIX+"frame-";C.BUILDER_PREFIX=C.PREFIX+"builder-";C.TRELLIS_PREFIX=C.PREFIX+"trellis-";C.MAPBUILDER_PREFIX=C.PREFIX+"mapbuilder-";C.CHART_PREFIX=C.PREFIX+"chart-";C.FILTERBAR0_PREFIX=C.PREFIX+"filterbar0-";C.FILTERBAR_PREFIX=C.PREFIX+"filterbar-";C.CONTEXTMENU_PREFIX=C.PREFIX+"contextmenu-";C.CUSTOMBUTTON_PREFIX=C.PREFIX+"custombutton-";C.ANNOTATION_PREFIX=C.PREFIX+"annotation-";C.PLAYCTRL_PREFIX=C.PREFIX+"playcontrol-";C.FEEDINGSHELF_PREFIX=C.COMMON_PREFIX+"feeding-";return C});define('sap/viz/controls/common/constants/DatasetTypeConst',[],function(){var D={};D.FLAT_TABLE='FlatTableDataset';D.CROSS_TABLE='CrosstableDataset';D.RAW='RawDataset';return D});define('sap/viz/controls/common/constants/FilterEventConst',[],function(){var F={};F.REQUEST_ADD_FILTER="requestAddFilter";F.REQUEST_REMOVE_FILTER="requestRemoveFilter";F.REQUEST_EDIT_FILTER="requestEditFilter";F.SIZE_CHANGED="sizeChanged";F.CLEAR_FILTERS="clearFilters";return F});define('sap/viz/controls/common/utils/Utils',[],function(){var u={};var _=0;u.genUID=function(){if(!_){_=0}return"vcgen_"+(_++)};var c={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};u.encodingToken="_encoded_";u.applyObjectProperty=function(o,p,a){try{if(u.isFunction(o[p])){o[p](a)}else{o[p]=a}}catch(e){}};u.applyProperties=function(a,p){if(p){var l=p.length;for(var i=0;i<l;i++){var b=p[i];if(b){u.applyObjectProperty(a,b.name,b.value)}}}};u.getObjectProperty=function(o,p){try{if(u.isFunction(o[p])){return o[p]()}else if(o.hasOwnProperty(p)){return o[p]}}catch(e){}};u.type=function(o){return o==null?String(o):c[Object.prototype.toString.call(o)]||"object"};u.isFunction=function(o){return u.type(o)==="function"};u.isBoolean=function(o){return u.type(o)==="boolean"};u.isString=function(o){return u.type(o)==="string"};u.isArray=function(o){return u.type(o)==="array"};u.isNumber=function(o){return u.type(o)==="number"};u.isRegExp=function(o){return u.type(o)==="regexp"};u.sortArrayOn=function(d,p,e){if(u.isArray(d)&&u.isString(p)){d.sort(function(a,b){return e?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p])})}};u.noop=function(){};u.delay=function(h,w){return setTimeout(function(){return h.apply(null)},w)};u.defer=function(h){return u.delay.call(null,h,1)};u.getEventPosition=function(e){var p=null;var a=null;if(e.originalEvent&&e.originalEvent.targetTouches&&e.originalEvent.targetTouches.length!==0){p=e.originalEvent.targetTouches[0].pageX;a=e.originalEvent.targetTouches[0].pageY}else{p=e.pageX;a=e.pageY}var b={};b.pageX=p;b.pageY=a;return b};u.clone=function(a){if(a===null||typeof(a)!=='object'){return a}var o=a.constructor===Array?[]:{};for(var i in a){if(a.hasOwnProperty(i)){o[i]=arguments.callee.call(null,a[i])}}return o};u.toJSON=function(a,p){if(u.isArray(a)){var r=[];for(var i=0;i<a.length;i++){r.push(p.call(null,a[i]))}return r}else if(a){return p.call(null,a)}else{return null}};u.fromJSON=function(j,p){if(u.isArray(j)){var r=[];for(var i=0;i<j.length;i++){r.push(p.call(null,j[i]))}return r}else if(j){return p.call(null,j)}else{return undefined}};u.updateJSON=function(s,n){var r=u.clone(s);r=r||{};var a=function(b,d){for(var p in d){if(d.hasOwnProperty(p)){var e=d[p];if(e!==undefined){if(typeof(e)!=="object"||e instanceof(Array)||e===null){b[p]=e}else{var f=b[p];if(!f){if(e===null||e===undefined){f=e}else{f=b[p]={}}}a(f,e)}}}}};a(r,n);return r};u.substitute=function(s,r){if(!s)return'';for(var i=1;i<arguments.length;i++){s=s.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i])}return s};u.invert=function(o){var r={};for(var k in o){var v=o[k];r[v]=k}return r};u.encode=function(i,s){if(i.indexOf(u.encodingToken)>-1){return i}else{var e=i+u.encodingToken+s;return e}};u.decode=function(i){var r=i.split(u.encodingToken);return r};u.deepEqual=function(s,t){if(typeof s==='object'&&typeof t==='object'&&u.isExist(s)&&u.isExist(t)){var k=null;for(k in s){if(s.hasOwnProperty(k)){if(!t.hasOwnProperty(k)){return false}else if(!u.deepEqual(s[k],t[k])){return false}}}for(k in t){if(t.hasOwnProperty(k)){if(!s.hasOwnProperty(k)){return false}}}return true}else{return s===t}};u.hasCommonKeyValue=function(s,t){if(typeof s==='object'&&typeof t==='object'){var k=null;for(k in s){if(s.hasOwnProperty(k)){if(t.hasOwnProperty(k)&&u.deepEqual(s[k],t[k])){return true}}}return false}};u.isExist=function(o){if((typeof(o)==='undefined')||(o===null)){return false}return true};var g=u.genGetterSetter=function(n){return function(v){if(arguments.length>0){this[n]=v;return this}else{return this[n]}}};u.genGetterSetters=function(p,n){n.forEach(function(e){p[e.substring(1)]=g(e)})};return u});define('sap/viz/controls/common/managers/LangManager',[],function(){var L=function(){this.__className="sap.viz.controls.common.managers.LangManager"};L.get=function(n){return sap.viz.lang.langManager.get(n)};return L});define('sap/viz/controls/common/feeds/AnalyticalType',[],function(){var A={};A.UNIVERSAL='universal';A.MEASURE='measure';A.DIMENSION='dimension';A.HIERARCHY='hierarchy';A.MND='mnd';A.compatible=function(h,c){if(h===A.UNIVERSAL){return true}else if(h===A.DIMENSION){return c===A.DIMENSION||c===A.HIERARCHY||c===A.MND}else{return h===c}};return A});define('sap/viz/controls/common/utils/JsonUtil',[],function(){var J={};J.AnalysisObjectType='sap.viz.controls.common.feeds.AnalysisObject';J.HierarchyLevelObjectType='sap.viz.controls.common.feeds.HierarchyLevelObject';J.MenuItemType='sap.viz.controls.common.views.menu.MenuItem';J.MenuGroupType='sap.viz.controls.common.views.menu.MenuGroup';J._FuncMap={};J.register=function(t,f,a){var o={fromFunc:f,toFunc:a};J._FuncMap[t]=o};J.fromJSON=function(t,j){if(J._FuncMap[t]&&J._FuncMap[t].fromFunc){return J._FuncMap[t].fromFunc(j)}else{return null}};J.toJSON=function(t,o){if(J._FuncMap[t]&&J._FuncMap[t].toFunc){return J._FuncMap[t].toFunc(o)}else{return{}}};return J});define('sap/viz/controls/common/views/menu/MenuGroup',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(u,J){var M=function(m){this.__className="sap.viz.controls.common.views.menu.MenuGroup";this._menuItems=m};M.prototype.menuItems=function(){return this._menuItems};M.prototype.selectedItem=function(){for(var i=0;i<this._menuItems.length;i++){if(this._menuItems[i].selected()){return this._menuItems[i]}}return null};M.prototype.equal=function(m){if(m==undefined){return false}var a=this.menuItems()||[];var b=m.menuItems()||[];if(a.length!==b.length){return false}for(var i=0;i<a.length;i++){var c=a[i];var d=b[i];if(!(c==undefined&&d==undefined)){if(c==undefined){return false}if(!c.equal(d)){return false}}}return true};M.toJSON=function(i){return u.toJSON(i,function(i){return{'menuItems':J.toJSON(J.MenuItemType,i._menuItems)}})};M.fromJSON=function(j){return u.fromJSON(j,function(j){return new M(J.fromJSON(J.MenuItemType,j.menuItems))})};J.register(J.MenuGroupType,M.fromJSON,M.toJSON);return M});define('sap/viz/controls/common/feeds/HierarchyLevelObject',['require','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(r,u,J){var a=r||a;var H=function(i,n,b){this.__className="sap.viz.controls.common.feeds.HierarchyLevelObject";this._id=i;this._name=n;this._analysis=b;this._selected=false};H.prototype.id=function(){return this._id};H.prototype.name=function(v){if(arguments.length>0){this._name=v;return this}else{return this._name}};H.prototype.analysis=function(){return this._analysis};H.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this}else{return this._selected}};H.prototype.clone=function(){var b=null;if(this._analysis){b=this._analysis.clone()}var c=new H(this._id,this._name,b);c.selected(this._selected);return c};H.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'analysis':J.toJSON(J.AnalysisObjectType,i._analysis),'selected':i._selected}})};H.fromJSON=function(j){return u.fromJSON(j,function(j){var i=new H(j.id,j.name,J.fromJSON(J.AnalysisObjectType,j.analysis));i.selected(j.selected);return i})};J.register(J.HierarchyLevelObjectType,H.fromJSON,H.toJSON);return H});define('sap/viz/controls/common/feeds/AnalysisObject',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/utils/JsonUtil','sap/viz/controls/common/feeds/HierarchyLevelObject'],function(u,L,A,M,J){var a=function(i,n,t,d,b,c){this.__className="sap.viz.controls.common.feeds.AnalysisObject";this._id=i;this._name=n;this._type=t;this._dataType=d;this._aggregationType=b;this._aggregationTarget=c;this._actions=null;this._hierarchyLevels=null};a.genMND=function(){return new a('mnd','',A.MND,'string')};u.genGetterSetters(a.prototype,["_id","_name","_actions","_aggregationType","_aggregationTarget","_hierarchyLevels"]);a.prototype.type=function(){return this._type};a.prototype.dataType=function(){return this._dataType};a.prototype.selectedHierarchyLevel=function(){if(!this._hierarchyLevels){return}for(var i=0;i<this._hierarchyLevels.length;i++){if(this._hierarchyLevels[i].selected()){return this._hierarchyLevels[i]}}return};a.prototype.selectedHierarchyLevelID=function(b){if(!this._hierarchyLevels){return this}for(var i=0;i<this._hierarchyLevels.length;i++){var l=this._hierarchyLevels[i];l.selected(l.id()===b)}return this};a.prototype.clone=function(){var c=a.fromJSON(a.toJSON(this));return c};a.prototype.equal=function(b,o){if(this.type()===A.MND&&b.type()===A.MND){return true}if(this.type()!==b.type()||this.name()!==b.name()){return false}if(this.type()===A.HIERARCHY&&b.type()===A.HIERARCHY){if(this.selectedHierarchyLevel().id()!==b.selectedHierarchyLevel().id()){return false}var l=this.hierarchyLevels();var c=b.hierarchyLevels();if(!l||!c||l.length!==c.length){return false}for(var i=0;i<l.length;i++){var d=l[i];var e=c[i];if(d.id()!==e.id()){return false}if(d.name()!==e.name()){return false}}}if((!o||o.ignoreActions!==true)&&(this.actions()!=undefined||b.actions()!=undefined)){var f=this.actions()||[];var g=b.actions()||[];if(f.length!==g.length){return false}for(var i=0;i<f.length;i++){var m=f[i];var h=g[i];if(!(m==undefined&&h==undefined)){if(m==undefined){return false}if(!m.equal(h)){return false}}}}return true};a.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'type':i._type,'dataType':i._dataType,'actions':M.toJSON(i._actions),'hierarchyLevels':J.toJSON(J.HierarchyLevelObjectType,i._hierarchyLevels),'aggregationType':i._aggregationType,'aggregationTarget':i._aggregationTarget}})};a.fromJSON=function(j){return u.fromJSON(j,function(j){var i=new a(j.id,j.name,j.type,j.dataType,j.aggregationType,j.aggregationTarget);if(j.actions){i.actions(M.fromJSON(j.actions))}if(j.hierarchyLevels){i.hierarchyLevels(J.fromJSON(J.HierarchyLevelObjectType,j.hierarchyLevels))}return i})};J.register(J.AnalysisObjectType,a.fromJSON,a.toJSON);return a});define('sap/viz/controls/common/feeds/FeedItem',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/AnalysisObject'],function(u,A){var F=function(i,t,v){this.__className="sap.viz.controls.common.feeds.FeedItem";this._id=i;this._type=t;this._values=v};F.prototype.type=function(){return this._type};F.prototype.id=function(){return this._id};F.prototype.values=function(v){if(arguments.length>0){this._values=v;return this}else{return this._values}};F.prototype.hasValues=function(){return(this._values&&this._values.length>0)};F.prototype.clone=function(){return F.fromJSON(F.toJSON(this))};F.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'type':i._type,'values':A.toJSON(i._values)}})};F.fromJSON=function(j){return u.fromJSON(j,function(j){return new F(j.id,j.type,A.fromJSON(j.values))})};return F});define('sap/viz/controls/common/feeds/FeedItemType',[],function(){var F=function(){this.__className="sap.viz.controls.common.feeds.FeedItemType"};F.MEASURE='Measure';F.DIMENSION='Dimension';F.SUBTOTAL='Subtotal';F.GEOGRAPHY='Geography';F.ROWS='rows';F.ROW_SUBTOTALS='r_subtotals';F.COLUMNS='columns';F.COLUMNS_SUBTOTALS='c_subtotals';F.CALCULATION='calculation';F.LEVEL='level';F.HIERARCHY='hierarchy';return F});define('sap/viz/controls/common/feeds/valueobjects/Shelf',[],function(){var S=function(){this.id=null;this.name=null;this.type=null;this.analysisType=null;this.feedItemType=null;this.capacity=0};S.prototype.equals=function(s){if(null==s){return false}if(this.id==s.id&&this.name==s.name&&this.type==s.type&&this.analysisType==s.analysisType&&this.feedItemType==s.feedItemType&&this.capacity==s.capacity){return true}return false};return S});define('sap/viz/controls/common/feeds/valueobjects/ShelfType',[],function(){var S=function(){};S.MEASURE='measure';S.ATTRIBUTE='attribute';S.SUBTOTAL='subtotal';S.TRELLIS='trellis';return S});define('sap/viz/controls/common/utils/PropertyFilterUtil',[],function(){var P={};var F={"viz/bubble":["plotArea.maxBubbleHeight","plotArea.maxBubbleWidth","plotArea.maxPriValue","plotArea.maxSecValue","plotArea.minBubbleHeight","plotArea.minBubbleWidth","plotArea.minSecValue","plotArea.minPriValue"],"viz/geobubble":["plotArea.maxValue","plotArea.minValue"],"info/donut":["plotArea.applyUnhighlightSliceColor","plotArea.dataLabel.renderer","plotArea.sliceRenderer","plotArea.highlight.contextInfos"],"info/bar":["plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","legendGroup.renderTo","legendGroup.computedVisibility","plotArea.markerRenderer"],"info/column":["plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","legendGroup.renderTo","legendGroup.computedVisibility","plotArea.markerRenderer"],"info/line":["plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","plotArea.markerRenderer","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","legendGroup.renderTo","legendGroup.computedVisibility","plotArea.lineRenderer"],"info/horizontal_line":["plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","plotArea.markerRenderer","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.lineRenderer"],"info/stacked_bar":["legendGroup.renderTo","legendGroup.computedVisibility"],"info/stacked_column":["legendGroup.renderTo","legendGroup.computedVisibility"],"info/combination":["legendGroup.renderTo","legendGroup.computedVisibility"],"info/bubble":["legendGroup.renderTo","legendGroup.computedVisibility"],"info/bullet":["legendGroup.renderTo","legendGroup.computedVisibility"],"info/time_bubble":["legendGroup.renderTo","legendGroup.computedVisibility"]};P.addDefaultProperties=function(p,c){var f=F[c];if(f){f.forEach(function(a){P.addProperty(p,a)})}P.addProperty(p,"interaction.behaviorType");return p};P.addProperty=function(p,a){if(!a){return p}p=p||{};var t=p;var b=a.split(".");for(var i=0;i<b.length;i++){if(!t.hasOwnProperty(b[i])){t[b[i]]={}}t=t[b[i]]}return p};return P});define('sap/viz/controls/common/utils/VizUtils',['jquery','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/utils/PropertyFilterUtil'],function($,D,U,F,A,P){var V={};V.hasFakeData=function(d){var h=true;if(d){h=false;if(U.isFunction(d.hasFakeData)){h=d.hasFakeData()}else{h=d.isFake===true?true:false}}return h};V.getDatasetType=function(d){if(d){if(d instanceof sap.viz.api.data.CrosstableDataset){return D.CROSS_TABLE}else if(d instanceof sap.viz.api.data.FlatTableDataset){return D.FLAT_TABLE}else{return D.RAW}}return D.CROSS_TABLE};V.isArrayOfFeedItem=function(o){return V._isArrayOf(o,F)};V.isArrayOfAnalysisObject=function(o){return V._isArrayOf(o,A)};V._isArrayOf=function(o,c){if(U.isArray(o)){for(var i=0;i<o.length;i++){if(!(o[i]instanceof c)){return false}}return true}return false};V._parseProperties=function(p){var r={};for(var n in p){if(p.hasOwnProperty(n)&&p[n]){var c=p[n];var a=c.name||n;if(c.supportedValueType==="Object"){if(c.supportedValues){r[a]=V._parseProperties(c.supportedValues)}}else{r[a]=c.defaultValue}}}return r};V._convertProperties=function(a){var r={};for(var m in a){if(a.hasOwnProperty(m)){r[m]=V._parseProperties(a[m])}}return r};V._getAllProperties=function(t){if(!t){return null}var v=sap.viz.api.manifest.Viz.get(t)[0];if(!v){return null}var p=v.allProperties();if(!p){return null}return p};V._getDefaultProperties=function(t){var p=this._getAllProperties(t);if(p){return V._convertProperties(p)}else{return null}};V._propertyExist=function(p,a){if(!a){return false}var b=a.split(".");var t=p;var r=false;for(var i=0;i<b.length;++i){if(t&&t.hasOwnProperty(b[i])){t=t[b[i]];r=true}else{r=false;break}}return r};V.hasProperties=function(t,p){var r=[];if(!p||p.length==0){return r}var d=V._getDefaultProperties(t);for(var i=0;i<p.length;++i){if(U.isArray(p[i])){r[i]=false;for(var n=0;n<p[i].length;++n){r[i]=r[i]||V._propertyExist(d,p[i][n])}}else{r[i]=V._propertyExist(d,p[i])}}return r};V._removeProperty=function(p,a){if(!a){return null}var b=a.split(".");var t=p;for(var i=0;i<b.length;++i){if(t&&t.hasOwnProperty(b[i])){if(i===b.length-1){var r=t[b[i]];delete t[b[i]];return r}else{t=t[b[i]]}}else{break}}return null};V._getProperty=function(p,a){if(!a){return null}var b=a.split(".");var t=p;for(var i=0;i<b.length;++i){if(t&&t.hasOwnProperty(b[i])){if(i===b.length-1){var r=t[b[i]];return r}else{t=t[b[i]]}}else{break}}return null};V.removeProperties=function(p,r){if(!r||r.length==0){return}for(var i=0;i<r.length;++i){V._removeProperty(p,r[i])}};V.getValueAxis=function(t){var m=sap.viz.api.manifest.Viz.get(t)[0];if(!m){return null}return m.valueAxis};V.isValueAxis=function(t,a){var v=V.getValueAxis(t);if(v){for(var i=0;i<v.length;i++){if(a===v[i]){return true}}}return false};V.convertValueAxisScale=function(p,s,t){if(!p||!s||!t){return}var a=V.getValueAxis(s);var v=V.getValueAxis(t);if(!a||a.length===0){return}var b=[];for(var i=0;i<a.length;++i){b[i]=V._removeProperty(p,a[i]+".scale")}if(v&&v.length>0){for(var n=0;n<v.length;++n){if(b[n]){p[v[n]]=p[v[n]]||{};p[v[n]]["scale"]=b[n]}}}};V.getCategoryAxis=function(t){var m=sap.viz.api.manifest.Viz.get(t)[0];if(!m){return null}return m.categoryAxis};V.getValidProperties=function(s,t){var d=V._getDefaultProperties(t);var p=this._getAllProperties(t);d=P.addDefaultProperties(d,t);var r=U.clone(s);V._deleteInvalidProperty(r,d,p);return r};V._deleteInvalidProperty=function(s,d,p){if($.isEmptyObject(d)){return}var a;for(a in s){if(!d.hasOwnProperty(a)){delete s[a]}else if(U.type(s[a])==='object'){var c=p[a];if(!c||!c.supportedValueType){V._deleteInvalidProperty(s[a],d[a],c)}else if(c.supportedValueType==='Object'){V._deleteInvalidProperty(s[a],d[a],c.supportedValues)}}}};V.convertProperties=function(s,a,t){if(!s||!a||!t||a===t){return s}var p=U.clone(s);var b=V.getValueAxis(a);var v=V.getValueAxis(t);if(b&&b.length!==0){var c=[];for(var i=0;i<b.length;++i){c[i]=V._getProperty(s,b[i])}if(v&&v.length>0){for(var n=0;n<v.length;++n){if(c[n]){p[v[n]]=c[n]}}}}var d=V.getCategoryAxis(a);var e=V.getCategoryAxis(t);if(d&&d.length!==0){var f=[];for(var i=0;i<b.length;++i){f[i]=V._getProperty(s,d[i])}if(e&&e.length>0){for(var n=0;n<e.length;++n){if(f[n]){p[e[n]]=f[n]}}}}return p};return V});define('sap/viz/controls/common/utils/FakeDataUtils',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/Utils'],function($,C,A,F,L,U){var a={};a.buildFakeData=function(v,f,d){var r=d;var b=a.feedItems2feed(f);var c=a._buildRIVFeeding(v,b);return a._buildFake(v,c,r)};a.feedItems2feed=function(f){var b=[];f.forEach(function(c){var v=c.values();if(v.length>0){for(var i=0;i<v.length;++i){var d=v[i];var e={'feed':c.id().indexOf('multiplier')!==-1?c.id().split('.')[0]:c.id()};if(d.type()===A.HIERARCHY){var h=d.hierarchyLevels();for(var j=0;j<h.length;j++){var l=h[j];if(l.selected()){e.objId=l.id()}}if(d.aggregationType()){e.aggregationType=d.aggregationType()}}else{if(d.type()===A.MND){e.objId=null}else{if(d.aggregationType()){e.aggregationType=d.aggregationType();if(d.aggregationTarget()){e.objId=d.aggregationTarget()}else{e.objId=U.decode(d.id())[0]}}else{e.objId=d.id()}}}b.push(e)}}});return b};a._buildRIVFeeding=function(v,f){var c=sap.viz.api.manifest.Viz;var b=c.get(v)[0];var d=b.allFeeds();var e=[];var m=[];var g=[];for(var i=0;i<d.length;i++){var h=d[i].id;var l=d[i].type;var n=[];for(var j=0;j<f.length;j++){if(f[j].feed==h){n.push(f[j])}}if(n.length>0){var o={};o.feedId=h;o.binding=[];var p=0;for(var k=0;k<n.length;k++){if(n[k].objId!=null){if(l===F.DIMENSION){if($.inArray(d[i].aaIndex,e)==-1){o.binding[p]={};o.binding[p].type=C.ANALYSIS_AXIS;o.binding[p].index=d[i].aaIndex;e.push(d[i].aaIndex);p++}}else{if($.inArray(d[i].mgIndex,m)==-1){o.binding[p]={};o.binding[p].type=C.MEASURE_VALUES_GROUP;o.binding[p].index=d[i].mgIndex;m.push(d[i].mgIndex);p++}}}else if(l===F.DIMENSION){o.binding[p]={};o.binding[p].type=C.MEASURE_NAMES_DIMENSION;p++}}g.push(o)}}e.sort();m.sort();a._fillAxesHoles(g,e);a._fillMgHoles(g,m);return g};a._fillAxesHoles=function(d,b){var j,c;if(b.length>0){c=b[0]-1;if(c>0){for(var j=0;j<d.length;j++){for(var k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type==C.ANALYSIS_AXIS&&d[j].binding[k].index!=null&&d[j].binding[k].index>1){d[j].binding[k].index-=c}}}for(j=0;j<b.length;j++){b[j]-=c}}}for(var i=0;i<b.length-1;i++){c=b[i+1]-b[i]-1;if(c>0){for(j=0;j<d.length;j++){for(var k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type==C.ANALYSIS_AXIS&&d[j].binding[k].index!=null&&d[j].binding[k].index>b[i]){d[j].binding[k].index-=c}}}for(j=i+1;j<b.length;j++){b[j]-=c}}}};a._fillMgHoles=function(d,m){var j;if(m.length>0){var b=m[0]-1;if(b>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type==C.MEASURE_VALUES_GROUP&&d[j].binding[0].index!=null&&d[j].binding[0].index>1){d[j].binding[0].index-=b}}for(j=0;j<m.length;j++){m[j]-=b}}}for(var i=0;i<m.length-1;i++){var b=m[i+1]-m[i]-1;if(b>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type==C.MEASURE_VALUES_GROUP&&d[j].binding[0].index!=null&&d[j].binding[0].index>m[i]){d[j].binding[0].index-=b}}for(j=i+1;j<m.length;j++){m[j]-=b}}}};a._getMNDfeed=function(f,b){if(!b)return;var m={priority:-1};for(var i=0;i<f.length;i++){var I=f[i].id;var c=f[i];var d=U.isNumber(c.acceptMND)?Number(c.acceptMND):-1;var e=false;for(var j=0;j<b.length;j++){if(b[j].feedId==I){if(b[j].binding.length>0){for(var k=0;k<b[j].binding.length;k++){if(b[j].binding[k].type==C.MEASURE_NAMES_DIMENSION){return I}}}if(b[j].binding.length<c.min){if(d>m.priority){m={feedId:I,priority:c.acceptMND}}}e=true;break}}if(!e){if(c.min>0&&d>=0){m={feedId:I,priority:c.acceptMND}}}}return m.feedId};a._validateInput=function(f,d){var b=0;if(d&&d.analysisAxis){b=d.analysisAxis.length}var m=0;if(d&&d.measureValuesGroup){m=d.measureValuesGroup.length}for(var i=0;i<f.length;i++){var c=f[i];if(c.binding){for(var j=0;j<c.binding.length;j++){var e=c.binding[j].index;var t=c.binding[j].type;if(t==C.ANALYSIS_AXIS&&(e>b)){return false}else if(t==C.MEASURE_VALUES_GROUP&&(e>m)){return false}}}}return true};a._buildFake=function(v,r,b){if(!a._validateInput(r,b)){b.analysisAxis=[];b.measureValuesGroup=[];return{"feeding":r,"dataset":b}}var c=sap.viz.api.manifest.Viz;var d=c.get(v)[0];var f=d.allFeeds();var e=d.id;var m=a._getMNDfeed(f,r);var g=[];var h=[];var i,j;for(i=0;i<f.length;i++){if(f[i].id==m){continue}var l=a._getFakeToBeBuilt(f[i],r,b);if(l.nb>0){if(l.axisIndex!=null){g.push(l)}else if(l.mgIndex!=null){h.push(l)}}}if(b.analysisAxis==null){b.analysisAxis=[]}for(i=0;i<g.length;i++){var n=g[i];var o=null;for(var j=0;j<b.analysisAxis.length;j++){if(b.analysisAxis[j].index==n.axisIndex){o=b.analysisAxis[j]}}if(o==null){o={};o.data=[];o.index=n.axisIndex;b.analysisAxis.push(o)}var p={};p.type=F.DIMENSION;p.name=L.get('VIZ_COMMON_FAKE_DIMENSION');p.isFake=true;var q=false;for(j=0;j<b.analysisAxis.length;j++){if(b.analysisAxis[j].data[0]!=null&&b.analysisAxis[j].data[0].values.length>0){q=true}else{q=false}}if(q||i>0){if(e===C.TYPE_TREE||e===C.TYPE_NETWORK){p.values=a._buildFakeDimensionValues(o.data[0].values.length)}else{p.values=a._buildFakeDimensionValues(1)}}else{var s=10;if(b.measureValuesGroup!=null&&b.measureValuesGroup[0]!=null){s=b.measureValuesGroup[0].data[0].values.length}p.values=a._buildFakeDimensionValues(s);if(a._isGeoOrNor(v)){p.infos=a._buildFakeGeoInfos(s)}}o.data.push(p)}if(b.measureValuesGroup==null){b.measureValuesGroup=[]}var t=a._sortAxes(f,b,r);if(t){a._swapMeasure(b)}for(i=0;i<h.length;i++){var u=h[i];var w=null;for(j=0;j<b.measureValuesGroup.length;j++){if(b.measureValuesGroup[j].index==u.mgIndex){w=b.measureValuesGroup[j]}}if(w==null){w={};w.data=[];w.index=u.mgIndex;b.measureValuesGroup.push(w)}for(var k=0;k<u.nb;k++){var x={};x.type=F.MEASURE;x.name=L.get('VIZ_COMMON_FAKE_MEASURE')+(i+k+1);x.isFake=true;var y=[];for(j=b.analysisAxis.length-1;j>=0;j--){y.push(b.analysisAxis[j].data[0].values.length)}if(y.length===0){y=[1]}var z=a._buildFakeMeasureValues(y);if(!Array.isArray(z[0])){z=[z]}x.values=z;w.data.push(x)}}return{"feeding":r,"dataset":b}};a._sortAxes=function(f,r,b){var c={};if(r.analysisAxis.length>1){for(var i=0;i<f.length;i++){var d=f[i];if(d.type===F.DIMENSION){for(var j=0;j<b.length;j++){if(b[j].feedId===d.id){var e=d.aaIndex;var g=b[j].binding;for(var m=0;m<g.length;m++){if(g[m]&&g[m].type==C.ANALYSIS_AXIS){var h=g[m].index;for(var n=0;n<r.analysisAxis.length;n++){if(r.analysisAxis[n].index===h){c[n]=e;break}}}}}}}}}var l=false;for(var i=0;i<r.analysisAxis.length;i++){for(var j=r.analysisAxis.length-1;j>=i+1;j--){if(c[j]<c[j-1]){var o=r.analysisAxis[j];r.analysisAxis[j]=r.analysisAxis[j-1];r.analysisAxis[j-1]=o;l=true}}}var p=U.clone(b);for(var i=0;i<r.analysisAxis.length;i++){var o=r.analysisAxis[i];var e=i+1;for(var j=0;j<p.length;j++){var g=p[j].binding;for(var k=0;k<g.length;k++){if(g[k]&&g[k].type==C.ANALYSIS_AXIS&&g[k].index==o.index){b[j].binding[k].index=e}}}o.index=e}return l};a._swapMeasure=function(r){var b=r.measureValuesGroup;if(b){for(var m=0;m<b.length;m++){var d=b[m].data;if(d){for(var n=0;n<d.length;n++){var c=d[n];var l=c.values.length;var e=c.values[0].length;var f=new Array(e);for(var j=0;j<e;j++){f[j]=new Array(l)}for(var i=0;i<l;i++){for(var j=0;j<e;j++){f[j][i]=c.values[i][j]}}c.values=f}}}}};a._getFakeToBeBuilt=function(f,r,b){var c=f.min;if(f.id==="treeNode"||f.id==="link"){c=f.minStackedDims}if(c==0){return{"nb":0}}var n=0;var i,j,k;for(i=0;i<r.length;i++){var d=null;var m=null;if(f.id==r[i].feedId){if(f.type==F.DIMENSION){var e=r[i].binding;for(k=0;k<e.length;k++){if(e[k].index){d=e[k].index}}if(d!==null){if(!b.analysisAxis.length){return{"nb":0,"axisIndex":d}}else{for(j=0;j<b.analysisAxis.length;j++){if(b.analysisAxis[j].index==d){n=b.analysisAxis[j].data.length;var g=c-n;if(g<0){g=0}return{"nb":g,"axisIndex":d}}}}}else{return{"nb":0}}}else if(f.type==F.MEASURE){m=r[i].binding[0].index;for(j=0;j<b.measureValuesGroup.length;j++){if(b.measureValuesGroup[j].index==m){n=b.measureValuesGroup[j].data.length;var g=c-n;if(g<0){g=0}return{"nb":g,"mgIndex":m}}}return{"nb":0,"mgIndex":m}}}}if(f.type==F.DIMENSION){var h=1;for(i=0;i<r.length;i++){for(k=0;k<r[i].binding.length;k++){if(r[i].binding[k].type==C.ANALYSIS_AXIS&&r[i].binding[k].index>=h){h=r[i].binding[k].index+1}}}var l={};l.feedId=f.id;l.binding=[];l.binding[0]={};l.binding[0].type=C.ANALYSIS_AXIS;l.binding[0].index=h;r.push(l);return{"nb":c,"axisIndex":h}}else if(f.type==F.MEASURE){var o=1;for(i=0;i<r.length;i++){if(r[i].binding[0].type==C.MEASURE_VALUES_GROUP&&r[i].binding[0].index>=o){o=r[i].binding[0].index+1}}var l={};l.feedId=f.id;l.binding=[];l.binding[0]={};l.binding[0].type=C.MEASURE_VALUES_GROUP;l.binding[0].index=o;r.push(l);return{"nb":c,"mgIndex":o}}return null};a._buildFakeMeasureValues=function(b){var v=[];var c=b[0];var i=0;if(b.length==1){for(i=0;i<c;i++){v[i]=Math.round(Math.random()*100)}}else{b.shift();for(i=0;i<c;i++){v[i]=a._buildFakeMeasureValues(b)}}return v};a._buildFakeDimensionValues=function(n){var d=[];for(var i=0;i<n;i++){d[i]=i.toString()}return d};a._buildFakeGeoInfos=function(n){var f=[];for(var i=0;i<n;i++){f[i]=''}return f};a._isGeoOrNor=function(t){if(t.search('geo')==-1&&t.search('choropleth')==-1){return false}else{return true}};return a});define('sap/viz/controls/common/utils/InfoChartUtil',['jquery','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils'],function($,A,u,V){var C={'line':1,'column':1,'bar':1,'donut':1,'horizontal_line':1};var I={getInfoType:function(v){var b=String(v).match(/^viz\/(.*)$/);if(b&&C[b[1]]){var c="info/"+b[1];var d=sap.viz.api.manifest.Viz.get(c);if(d&&d[0]){return c}}return null},isInfoChart:function(t){return(/^info\/\w+$/).test(t)},getVizType:function(b){return this.isInfoChart(b)?b.replace('info/','viz/'):null},buildInfoDataset:function(c){var d=sap.viz.data.utils.CTB2TBConvertUtil.crossTable2FlatTableData(c);return new sap.viz.api.data.FlatTableDataset(d)},buildInfoFeeding:function(f,b){var c={};for(var i=0;i<f.length;i++){var d=f[i];var v=d.values()||[];var l=c[d.id()]=[];for(var j=0;j<v.length;j++){var e=v[j];if(e.type()===A.MND){if(b){l.unshift("MeasureNamesDimension")}else{l.push("MeasureNamesDimension")}}else{if(e.type()===A.HIERARCHY){for(var k=0;k<e.hierarchyLevels().length;k++){var h=e.hierarchyLevels()[k];l.push(h.id());if(h.selected()){break}}}else{l.push(e.id())}}}}return c},buildInfoProperties:function(v,b){var c=$.extend(true,{},b);var d=V.getCategoryAxis(v);if(d&&d.length){r(c,d[0],'categoryAxis');if(d.length>1){r(c,d[1],'categoryAxis2')}}var e=V.getValueAxis(v);if(e&&e.length){r(c,e[0],'valueAxis');if(e.length>1){r(c,e[1],'valueAxis2')}}m(c,'dataLabel','plotArea.dataLabel');m(c,'background','plotArea.background');m(c,'plotArea.background.body.color','plotArea.background.color');m(c,'valueAxis.scale','plotArea.primaryScale');m(c,'valueAxis2.scale','plotArea.secondaryScale');m(c,'valueAxis2.gridline','plotArea.gridline');m(c,'valueAxis.gridline','plotArea.gridline');r(c.valueAxis,'axisline','axisLine');r(c.valueAxis2,'axisline','axisLine');r(c.categoryAxis,'axisline','axisLine');r(c.categoryAxis2,'axisline','axisLine');m(c,'valueAxis.lineSize','valueAxis.axisLine.size');m(c,'valueAxis2.lineSize','valueAxis2.axisLine.size');m(c,'categoryAxis.lineSize','categoryAxis.axisLine.size');m(c,'categoryAxis2.lineSize','categoryAxis2.axisLine.size');a(c,'valueAxis.label.formatString');a(c,'valueAxis2.label.formatString');a(c,'plotArea.dataLabel.formatString');a(c,'tooltip.formatString');return c},buildInfoSeries:function(f,d){var b=f['regionColor'];var c=new Object,e=[];var h,v,k,l,n;if(!b||b.length===0){return null}var o=f['axisLabels'];var p=f['primaryValues'];var q=false;if(b.indexOf('MeasureNamesDimension')>=0){b.splice(b.indexOf('MeasureNamesDimension'),1);q=true}if(b.length<=0){var t;p.forEach(function(t){for(i=0;i<d.length;i++){h=d[i];if(h[t]!=null){n=new Object;n['name']=t;l=new Object;l['MeasureNamesDimension']=t;n['seriesData']=l;c[t]=n;break}}});return c}for(i=0;i<d.length;i++){h=d[i];v=false;for(j=0;j<p.length;j++){if(h[p[j]]!=null){v=true;break}}if(v){k=h[b[0]];l=new Object;n=new Object;l[b[0]]=h[b[0]];for(j=1;j<b.length;j++){k=k+" / "+h[b[j]];l[b[j]]=h[b[j]]}if(q){var w,x;for(j=0;j<p.length;j++){if(!h.hasOwnProperty(p[j])){continue}w=k+" / "+p[j];if(w&&e.indexOf(w)<0){e.push(w);x=u.clone(l);x[p[j]]=h[p[j]];n=new Object;n['name']=w;n['seriesData']=x;c[w]=n}}}else if(k&&e.indexOf(k)<0){e.push(k);n['name']=k;n['seriesData']=l;c[k]=n}}}return c}};function g(c,p){return p?p.split('.').reduce(function(o,b){return o&&typeof o=='object'?o[b]:null},c):c}function s(c,p,v){p.split('.').reduce(function(o,b,d,e){if(d<e.length-1){o[b]=o[b]!=null?o[b]:{}}else{o[b]=v}return o[b]},c)}function m(c,b,t,d){var v=g(c,b);if(v!=null){if(!d){var p=b.split('.');var e=p.pop();var f=p.join('.');delete g(c,f)[e]}s(c,t,v)}}function r(c,o,n){if(c&&o in c){c[n]=c[o];delete c[o]}}function a(c,f){var b=g(c,f);if(!b){return}if(u.isString(b)){return}if(u.isArray(b)&&u.isArray(b[0])&&u.isString(b[0][0])){s(c,f,b[0][0])}}return I});define('sap/viz/controls/common/utils/TrellisUtils',['sap/viz/controls/common/constants/ChartConst'],function(C){var t={};var T={};T.TRELLIS='trellis';T.MULTIPLE='multi';T._register=function(p,a){if(a){t[a]=p}else{t['_default']=p}};T._getProvider=function(a){var p=t[a];if(!p){p=t['_default']}return p};T.providerName=function(a){var p=T._getProvider(a);return p.name};T.isMultipleChart=function(a){if(!a){return false}var p=T._getProvider(a);return p.isMultipleChart(a)};T.supportMultiChart=function(a){if(!a){return false}var p=T._getProvider(a);return p.supportMultiChart(a)};T.toSingleChartType=function(a){if(!a){return a}var p=T._getProvider(a);return p.toSingleChartType(a)};T.toMultiChartType=function(a){if(!a){return a}var p=T._getProvider(a);if(p.isMultipleChart(a)){return a}else{return p.toMultiChartType(a)}};function c(n){var v='viz/'+n+'_';var p={name:n};p.isMultipleChart=function(a){if(!a){return false}return(a.indexOf(v)===0)};p.supportMultiChart=function(a){if(a.indexOf(v)===0){return true}var m=p.toMultiChartType(a);if(m!==a){return true}else{return false}};p.toSingleChartType=function(a){if(p.isMultipleChart(a)){return a.replace(v,'viz/')}return a};p.toMultiChartType=function(a){var m=a.replace('viz/',v);if(sap.viz.api.manifest.Viz.get(m)[0]){return m}return a};return p}T._register(c(T.MULTIPLE));return T});define('sap/viz/controls/common/utils/ChartTypeUtil',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/TrellisUtils'],function(C,D,L,I,T){var a={};a._CVOM_TYPE_MAPPING=function(){var m={};var b=function(c,v,d,e){var p={vizType:v};if(d){p.vizDirection=d}if(e){p.vizStacking=e}m[c]=p};b(C.TYPE_STACKED_BAR,C.TYPE_STACKED_BAR,null,C.STACKING_NORMAL);b(C.TYPE_100_STACKED_BAR,C.TYPE_STACKED_BAR,null,C.STACKING_FULL);b(C.TYPE_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,null,C.STACKING_NORMAL);b(C.TYPE_100_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,null,C.STACKING_FULL);b(C.TYPE_3D_BAR,C.TYPE_3D_COLUMN,C.DIRECTION_HORIZONTAL);b(C.TYPE_3D_COLUMN,C.TYPE_3D_COLUMN,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_LINE,C.TYPE_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_LINE,C.TYPE_LINE,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_NORMAL);b(C.TYPE_100_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_FULL);b(C.TYPE_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_NORMAL);b(C.TYPE_100_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_FULL);b(C.TYPE_HORIZONTAL_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_HORIZONTAL);b(C.TYPE_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_VERTICAL);b(C.TYPE_DUAL_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_VERTICAL);b(C.TYPE_DUAL_HORIZONTAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_HORIZONTAL);b(C.TYPE_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_HORIZONTAL);b(C.TYPE_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_VERTICAL);b(C.TYPE_INFO_HORIZONTAL_LINE,C.TYPE_INFO_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_INFO_LINE,C.TYPE_INFO_LINE,C.DIRECTION_VERTICAL);return m};a._VIZ_TYPE_MAPPING=function(){var m={};var b=function(v,i){var n;if(v===C.TYPE_TABLE){n=L.get('VIZ_COMMON_TABLE_TEXT')}else if(v===C.TYPE_CROSSTAB){n=L.get('VIZ_COMMON_CROSSTAB_TEXT')}else{var c=sap.viz.api.manifest.Viz.get(v)[0];n=c?c.name:v}m[v]={'id':v,'caption':n,'icon':i,'whiteIcon':i+'-white','greyIcon':i+'-grey'};var d=I.getInfoType(v);if(d){m[d]=m[v]}};b(C.TYPE_BAR,'bar');b(C.TYPE_COLUMN,'column');b(C.TYPE_STACKED_BAR,'stacked-bar');b(C.TYPE_STACKED_COLUMN,'stacked-column');b(C.TYPE_DUAL_BAR,'dual-bar');b(C.TYPE_DUAL_COLUMN,'dual-column');b(C.TYPE_3D_COLUMN,'3D-column');b(C.TYPE_LINE,'line');b(C.TYPE_AREA,'area');b(C.TYPE_COMBINATION,'combination');b(C.TYPE_DUAL_LINE,'dual-line');b(C.TYPE_DUAL_COMBINATION,'dual-combination');b(C.TYPE_PIE,'pie');b(C.TYPE_DONUT,'donut');b(C.TYPE_PIE_WITH_DEPTH,'pie-with-depth');b(C.TYPE_GEO_BUBBLE,'geo-bubble');b(C.TYPE_GEO_CHOROPLETH,'geo-choropleth');b(C.TYPE_GEO_PIE,'geo-pie');b(C.TYPE_GEO_MAP,'geo-map');b(C.TYPE_SCATTER,'scatter');b(C.TYPE_BUBBLE,'bubble');b(C.TYPE_SCATTER_MATRIX,'scatter-matrix');b(C.TYPE_HEATMAP,'heatmap');b(C.TYPE_TREEMAP,'treemap');b(C.TYPE_TABLE,'table');b(C.TYPE_CROSSTAB,'crosstab');b(C.TYPE_RADAR,'radar');b(C.TYPE_BOXPLOT,'boxplot');b(C.TYPE_WATERFALL,'waterfall');b(C.TYPE_TAG_CLOUD,'tag-cloud');b(C.TYPE_TREE,'tree');b(C.TYPE_NETWORK,'network');b(C.TYPE_FUNNEL,'funnel');b(C.TYPE_PC,'pc');b(C.TYPE_NUMBER,'number');b('viz/ext/samplesbar','viz/ext/samplesbar');b('viz/ext/flagbar','viz/ext/flagbar');return m};a.getVizTypeObject=function(v){if(a.VIZ_TYPE__MAPPING==null){a.VIZ_TYPE__MAPPING=a._VIZ_TYPE_MAPPING()}var t=a.VIZ_TYPE__MAPPING[v];if(t){t=JSON.parse(JSON.stringify(t))}return t};a.toVizProperties=function(c){if(a.CVOM_TYPE_MAPPING==null){a.CVOM_TYPE_MAPPING=a._CVOM_TYPE_MAPPING()}var p=a.CVOM_TYPE_MAPPING[c];if(!p){p={vizType:c}}return p};a.fromVizProperties=function(t,v,b){if(!v&&!b){return t}var c=a.toVizProperties(t).vizType;for(var d in a.CVOM_TYPE_MAPPING){if(a.CVOM_TYPE_MAPPING.hasOwnProperty(d)){var p=a.CVOM_TYPE_MAPPING[d];if(p.vizType===c&&(!v||!p.vizDirection||p.vizDirection===v)&&(!b||!p.vizStacking||p.vizStacking===b)){return d}}}return t};a.updateType=function(t,o){var n=t;if(o.hasOwnProperty("direction")){n=a.changeDirection(n,o["direction"]);o["direction"]=undefined}if(o.hasOwnProperty("stacking")){n=a.changeStacking(n,o["stacking"]);o["stacking"]=undefined}return n};a.isMultipleChart=function(t){return T.isMultipleChart(t)};a.toMultiChartType=function(t){return T.toMultiChartType(t)};a.toSingleChartType=function(t){return T.toSingleChartType(t)};a.supportMultiChart=function(v){return T.supportMultiChart(v)};a.getDirection=function(t){var c=a.toSingleChartType(t);var b=a.toVizProperties(c);if(b.vizDirection){return b.vizDirection}return null};a.getStacking=function(t){var c=a.toSingleChartType(t);var b=a.toVizProperties(c);if(b.vizStacking){return b.vizStacking}return null};a.changeDirection=function(t,d){var c=a.toSingleChartType(t);var b=a.getDirection(c);if(b===d||!b){return t}var s=a.getStacking(c);var n=a.fromVizProperties(c,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n)}return n};a.changeStacking=function(t,s){var c=a.toSingleChartType(t);var b=a.getStacking(c);if(b===s||!b){return t}var d=a.getDirection(c);var n=a.fromVizProperties(c,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n)}return n};a.getType=function(t,v){if(!t){return v}var c=a.toSingleChartType(t);var d=a.getDirection(c);var s=a.getStacking(c);c=a.fromVizProperties(v,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(c)}return c};a.getVizType=function(t){var c=a.toSingleChartType(t);return a.toVizProperties(c).vizType};a.getDatasetType=function(t){if(a.isGeo(t)||I.isInfoChart(t)){return D.FLAT_TABLE}else if(a.isTable(t)){return D.RAW}else{return D.CROSS_TABLE}};a.isTable=function(t){return(t===C.TYPE_TABLE||t===C.TYPE_CROSSTAB)};a.isGeo=function(t){return(t===C.TYPE_GEO_MAP)};a.isInfoChart=function(t){if(t&&t.indexOf("info/")==0){return true}return false};a.supportTitle=function(t){if(a.isGeo(t)){return false}else{return true}};a.isBuildInType=function(t){var m=sap.viz.api.manifest.Viz.get(t)[0]||{};return!!m.isBuiltIn};a.supportAnimation=function(t){return t===C.TYPE_GEO_BUBBLE||t===C.TYPE_BUBBLE||t===C.TYPE_SCATTER};a.isEmptyData=function(t,d){var b=a.getDatasetType(t);if(b===D.RAW){return false}else if(b===D.FLAT_TABLE){return false}else{var c=d?(d.data()?d.data().analysisAxis:null):null;var m=d?(d.data()?d.data().measureValuesGroup:null):null;if((!c||c&&c.length===0)&&(!c||m&&m.length===0)){return true}}return false};a.getCategoryAxis=function(t){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return['yAxis']}else{return['xAxis']}};a.getValueAxis=function(t){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return['xAxis']}else{return['yAxis']}};a.isHorizontal=function(t){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return true}else{return false}};a.isCategoryAxis=function(t,b){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return b==='yAxis'?true:false}else{return b==='xAxis'?true:false}};a.isSupportMorphing=function(t){if(t===C.TYPE_TREE||t===C.TYPE_NETWORK||t===C.TYPE_FUNNEL||t===C.TYPE_PC||a.supportAnimation(t)){return false}else if(!a.isBuildInType(t)){return false}else{return true}};a.getChartId=function(t){return a.getVizType(t).replace('viz/','')};return a});define('sap/viz/controls/common/feeds/FeedUtils',['require','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/FakeDataUtils','sap/viz/controls/common/utils/ChartTypeUtil'],function(r,C,F,b,A,U,c,d){var e=r||e;var f={};f.MultiplierFeedingName='multiplier';f.RowsFeedingName='multiplier.row';f.ColumnsFeedingName='multiplier.column';f.trillisFeeds={'id':'multiplier','row':{id:'multiplier.row',maxStacked:3,minStacked:0,type:b.DIMENSION},'column':{id:'multiplier.column',maxStacked:3,minStacked:0,type:b.DIMENSION}};f.geoFeeds={'id':'geoFeatures'};f.MaxDemensionFeedsCount=2;f._mapFeedItem=function(a,g,t){var h=a.id();var i;var j=null;for(i=0;i<g.length;i++){if(g[i].id===h){j=g[i];break}}if(j===null){return a}var k=a.type();var l='aaIndex';if(k!==b.DIMENSION){l='mgIndex'}var m=null;for(i=0;i<t.length;i++){if(t[i][l]===j[l]){m=new F(t[i].id,k,a.values());t.splice(i,1);return m}}for(i=0;i<t.length;i++){if(k===t[i].type&&t[i].id!==f.MultiplierFeedingName){m=new F(t[i].id,k,a.values());t.splice(i,1);return m}}return m};f._idEquals=function(a,g){var i=a.id();var h=false;if(i===g.id){h=true}else if(g.id===f.MultiplierFeedingName&&(i===f.RowsFeedingName||i===f.ColumnsFeedingName)){h=true}return h};f.getVizFeeds=function(v){var a=sap.viz.api.manifest.Viz.get(v)[0];if(a){return a.allFeeds()}else{return null}};f.mapFeeds=function(a,g,t){if(!t||g===t||(!a)){return{'feeds':a,'feedsChanged':false}}var h=[];if(g&&U.isString(g)){h=f.getVizFeeds(g)||[]}var j=f.getVizFeeds(t);if(!j){return{'feeds':[],'feedsChanged':true}}j=j.slice();var i,n;var k=[];var l=[];var o=false;for(i=0;i<a.length;i++){var p=a[i].id();o=false;for(n=0;n<j.length;n++){if(j[n].id===p){k.push(a[i]);j.splice(n,1);o=true;break}}if(!o){l.push(a[i])}}var q;var s=false;for(i=0;i<l.length;i++){q=f._mapFeedItem(l[i],h,j);if(q){k.push(q)}if(q!==l[i]){s=true}}for(n=0;n<j.length;n++){o=false;for(var m=0;m<k.length;m++){if(f._idEquals(k[m],j[n])){o=true;break}}if(!o){s=true;if(j[n].id===f.MultiplierFeedingName){k.push(new F(f.RowsFeedingName,j[n].type,[]));k.push(new F(f.ColumnsFeedingName,j[n].type,[]))}else{k.push(new F(j[n].id,j[n].type,[]))}}}if(f.isEmptyFeeds(k)){s=false}return{'feeds':k,'feedsChanged':s}};f.canAddFeed=function(a,g,h,z){var l=g.id===f.MultiplierFeedingName;var m=0;if(l){m=z?(z==="mainPlot"?2:1):2}for(var i=0;i<a.length;i++){if(!f._idEquals(a[i],g)){continue}if((z===f.RowsFeedingName||z===f.ColumnsFeedingName)&&a[i].id()!==z){continue}var v=a[i].values();for(var j=0;j<v.length;j++){var n=v[j];if(n.id()===h.id()){if(l){if(--m===0){return false}}else{return false}}}}var t=h.type();if(t){t=t.toLowerCase()}var o=h.dataType();if(o){o=o.toLowerCase()}var p=g.id===f.geoFeeds.id?b.GEOGRAPHY:g.type;if(!f.feedCompatible(p,t,o)){return false}else if(f.feedCompatible(t,A.MEASURE,o)){return true}var q=0;var s=0;for(var k=0;k<a.length;k++){var u=a[k];if(!u.hasValues()){continue}else if(f._idEquals(u,g)){return true}else if(u.type()===b.DIMENSION){if(u.id()===f.RowsFeedingName||u.id()===f.ColumnsFeedingName){s=Math.min(1,s+1)}else{q++}}}return(q+s)<f.MaxDemensionFeedsCount};f.checkDimensionFeedItemsToLimit=function(a){var n=0;var g=0;for(var i=0;i<a.length;i++){var h=a[i];if(h.type()===b.DIMENSION&&h.hasValues()){if(h.id()===f.RowsFeedingName||h.id()===f.ColumnsFeedingName){g=Math.min(1,g+1)}else{n++}}}return(g+n)>=f.MaxDemensionFeedsCount};f.getEmptyFeedItemsId=function(a){var g=[];var h=false;for(var i=0;i<a.length;i++){var j=a[i];if(j.type()===b.DIMENSION){if(j.id()===f.RowsFeedingName||j.id()===f.ColumnsFeedingName){if(j.values().length>0){h=true}continue}if(!j.values().length){g.push(j.id())}}}if(!h){g.push(f.RowsFeedingName);g.push(f.ColumnsFeedingName)}return g};f.hasRowOrColumn=function(a){var _=false;if(!a){return _}for(var i=0;i<a.length;i++){var g=a[i];if(g.id()===f.RowsFeedingName||g.id()===f.ColumnsFeedingName||g.id()===f.MultiplierFeedingName){if(g.values().length>0){_=true;break}}}return _};f.isEmptyFeeds=function(a){if(!a){return true}for(var i=0;i<a.length;i++){var g=a[i];if(g){var v=g.values();if(v&&v.length>0){return false}}}return true};f._toMap=function(a){var m={};for(var i=0;i<a.length;i++){var g=a[i];if(!g){continue}m[g.id()]={'index':i,'item':g}}return m};f.isFeedDefinitionEqual=function(t,a){if(t===a){return true}if(!t||!a){return false}var g=f.getVizFeeds(t);var h=f.getVizFeeds(a);if(!g||!h){return false}if(g.length!==h.length){return false}for(var i=0;i<g.length;i++){var j=g[i];var k=h[i];for(var p in j){if(j.hasOwnProperty(p)){if(j[p]!==k[p]){return false}}}}return true};f.equal=function(a,g,o){var i;var h=f._toMap(a);var j=f._toMap(g);var k;for(k in h){if(h.hasOwnProperty(k)){var l=h[k].item;var m=l.values();var n=j[k]?j[k].item:null;var p=j[k]?n.values():null;delete j[k];if(!n){if(m.length>0){return false}}else{if(p.length!==m.length){return false}else{var q;var s=f._toMap(m);var t=f._toMap(p);for(var u in s){if(s.hasOwnProperty(u)){if(t[u]===undefined){return false}else if(s[u].index!==t[u].index){return false}else if(!s[u].item.equal(t[u].item,o)){return false}}}}}}}for(k in j){if(j.hasOwnProperty(k)){var v=j[k].item;var w=v.values();if(w.length>0){return false}}}return true};f.cloneFeeds=function(a){if(!a){return null}if(a.length===0){return[]}var g=[];for(var i=0;i<a.length;i++){var h=a[i];g.push(h.clone())}return g};f.feedHasValue=function(n,a){if(!n||!a){return false}var g=false;var h=a.values();for(var i=0;i<h.length;i++){if(h[i].id()===n.id()){g=true;break}}return g};f.buildMNDFeedings=function(a,t){if(!a){return}var g=sap.viz.api.manifest.Viz;var h=g.get(t)[0];var k=h.allFeeds();var m={feedId:null,index:-1,priority:-1};for(var i=0;i<k.length;i++){var I=k[i].id;var l=k[i];var n=false;for(var j=0;j<a.length;j++){if(a[j].feedId===I){if(a[j].binding.length<l.min){if(f.canAcceptMND(l.acceptMND)){m={feedId:I,index:j,priority:l.acceptMND}}}n=true;break}}if(!n){if(l.min>0&&f.canAcceptMND(l.acceptMND)){m={feedId:I,index:-1,priority:l.acceptMND}}}}var o=a;if(o&&m.index>=0){o[m.index].binding.push({"type":C.MEASURE_NAMES_DIMENSION})}else if(o&&m.feedId){o.push({binding:[{"type":C.MEASURE_NAMES_DIMENSION}],feedId:m.feedId})}return o};f._useFullHierarchies=function(a,g,h){var i=true;if(a==="geoFeatures"){i=false}else if(U.isNumber(g.maxStackedDims)){var s=0;for(var j=0;j<h.length;j++){var l=h[j];if(l.type()===A.HIERARCHY){var m=l.hierarchyLevels();for(var k=0;k<m.length;k++){s++;if(m[k].selected()){break}}}else if(l.type()===A.DIMENSION){s++}}if(g.maxStackedDims<s){i=false}}return i};f.buildFeedings=function(t,a,g){return f.buildFeedingsWithFakeData(t,a,g)};f._adjustMND=function(a,g){var m=g['multiplier'];if(m){var h=f.getNumberOfDimensionsInColumn(a);var j=m.length-h;if(j>0&&h>0){for(var i=0;i<m.length;i++){if(m[i].type()===A.MND){if(i>0&&i<j+h-1){var k=m[i];if(i<j){m.unshift(k);m.splice(i+1,1)}else{m.push(k);m.splice(i,1)}}break}}}}};f._findBindingIndex=function(a,g){for(var i=0;i<a.length;i++){var h=a[i];if(h.data.length!==g.length){continue}var m=true;for(var j=0;j<h.data.length;j++){m=m&&h.data[j].name===g[j]}if(m){a.splice(i,1);return h.index}}};f.removeRowAndColumnFeedItems=function(a){var g=f.cloneFeeds(a);var l=g.length;while(l){var h=l-1;var i=g[h];if(i.id()===f.RowsFeedingName||i.id()===f.ColumnsFeedingName||i.id()===f.MultiplierFeedingName){g.splice(h,1)}l--}return g};f.getNumberOfDimensionsInColumn=function(a){var n=0;a.forEach(function(g){if(g.id()===f.ColumnsFeedingName){var h=g.values();h.forEach(function(j){if(j.type()===A.HIERARCHY){var l=j.hierarchyLevels();for(var i=0;i<l.length;i++){n++;if(l[i].selected()){break}}}else{n++}});return}});return n};f.buildFeedingsWithFakeData=function(v,a,g){var g=JSON.parse(JSON.stringify(g.data()));var h=c.buildFakeData(v,a,g).feeding;return h};f.meetMinDimensions=function(t,a){var i;var v=f.getManifestFeedsMap(t);var g=f._getFeedsValuesMap(a);for(i in v){var h=v[i];var j=g[i];var l=h.type.toLowerCase();if(A.compatible(A.DIMENSION,l)){var n=f.countDataContainers(j);if(n<h.min){return false}}}return true};f.removeMND=function(a){if(!a){return a}var g=[];for(var i=0;i<a.length;i++){if(a[i]){var h=a[i].clone();var v=h.values();if(v){for(var j=0;j<v.length;j++){var k=v[j];if(!k){continue}if(A.compatible(A.MND,k.type())){v.splice(j,1);j--}}}}g.push(h)}return g};f.hasMND=function(a){return f.countAnalyses(a,A.MND)>0};f.countAnalyses=function(a,t){var n=0;for(var i=0;i<a.length;i++){var g=a[i];var v=g.values();for(var j=0;j<v.length;j++){var h=v[j];if(A.compatible(t,h.type())){n++}}}return n};f.convertFeedType=function(a){if(a===b.GEOGRAPHY){return b.DIMENSION}return a};f.isGeoHierarchyFeed=function(a,g,h){var l=a?a.toLowerCase():null;var i=g?g.toLowerCase():null;var j=h?h.toLowerCase():null;return l===b.GEOGRAPHY.toLowerCase()&&i===A.HIERARCHY&&j===b.GEOGRAPHY.toLowerCase()};f.feedCompatible=function(a,g,h){var l=a?a.toLowerCase():null;var i=g?g.toLowerCase():null;var j=h?h.toLowerCase():null;if(l===b.DIMENSION.toLowerCase()){return i===A.DIMENSION||i===A.HIERARCHY||i===A.MND}else if(l===b.SUBTOTAL.toLowerCase()){return(i===b.DIMENSION.toLowerCase()||i===A.HIERARCHY)}else if(l===b.GEOGRAPHY.toLowerCase()){return(i===A.DIMENSION||i===A.HIERARCHY)&&j===b.GEOGRAPHY.toLowerCase()}else{return l===i}};f.getManifestFeedsMap=function(t){var v=f.getVizFeeds(t);if(!v){return{}}var a={};for(var i=0;i<v.length;i++){a[v[i].id]=v[i]}return a};f._getFeedsValuesMap=function(a,m){m=m!==false;var g={};for(var i=0;i<a.length;i++){var h=a[i];var j=h.id();if(m&&(j===f.RowsFeedingName||j===f.ColumnsFeedingName)){j='multiplier'}if(!g[j]){g[j]=h.values()}else{g[j]=g[j].concat(h.values())}}return g};f.countDataContainers=function(v){if(!v){return 0}var n=0,g=0,h=0;for(var i=0;i<v.length;i++){var a=v[i];if(A.compatible(A.MEASURE,a.type())){n++}else{if(A.compatible(A.MND,a.type())){h++}else if(A.compatible(A.DIMENSION,a.type())){g++}}}return n+Math.min(1,g)+Math.min(1,h)};f.countAAOfFeeds=function(a){var n=0;var g=0;for(var i=0;i<a.length;i++){var h=a[i];if(h.type()===b.DIMENSION&&f.countAAOfFeedItem(h)){if(h.id()===f.RowsFeedingName||h.id()===f.ColumnsFeedingName){g=Math.min(1,g+1)}else{n++}}}return(g+n)};f.countAAOfValues=function(v){if(!v||!v.length){return 0}var h=f.hasMNDInValues(v);if(h&&v.length===1){return 0}return 1};f.countAAOfFeedItem=function(a){if(!a||!a.hasValues()){return 0}var v=a.values();return f.countAAOfValues(v)};f.hasMNDInValues=function(v){return(f.indexOfMNDInValues(v)!==-1)};f.indexOfMNDInValues=function(v){if(!v||!v.length){return-1}var a=-1;for(var i=0;i<v.length;i++){var g=v[i];if(g.type()===A.MND){a=i;break}}return a};f._getCapacityOfFeedDef=function(a){var g=0;if(a.type===b.DIMENSION){if(a.id===f.RowsFeedingName||a.id===f.ColumnsFeedingName||a.id===f.MultiplierFeedingName){g=f.trillisFeeds.row.maxStacked}else{g=a.maxStackedDims?a.maxStackedDims:Number.MAX_VALUE}}else{g=a.max=='Infinity'?Number.MAX_VALUE:a.max}return g};f._getMNDfeed=function(a,g){if(!g)return;var m={priority:-1};for(var i in a){var h=a[i];var I=h.id;var k=U.isNumber(h.acceptMND)?Number(h.acceptMND):-1;var l=false;for(var j=0;j<g.length;j++){if(g[j].id()==I){var n=g[j].values().length;if(n<h.min){if(k>m.priority){m={feedId:I,priority:h.acceptMND}}}l=true}}if(!l){if(h.min>0&&k>m.priority){m={feedId:I,priority:h.acceptMND}}}}return m.feedId};f.canAddValue=function(a,s,g,h,k,l){var m=U.clone(g);if(!l){l=s}if(m[f.MultiplierFeedingName]){m[f.MultiplierFeedingName].min=0}if(m[f.RowsFeedingName]){m[f.RowsFeedingName].min=0}if(m[f.ColumnsFeedingName]){m[f.ColumnsFeedingName].min=0}var n=m[l];if(!n){return false}var o=f._toMap(a);var p=o[s]?o[s].item:null;var v=p?p.values():[];if(s===f.RowsFeedingName||s===f.ColumnsFeedingName){v=f.getRowAndColumnValues(a)}var q=f._getMNDfeed(m,a);var t=0;var u=0;for(var i=0;i<a.length;i++){var w=a[i];if(w.type()==b.DIMENSION){var x=w.values();for(var j=0;j<x.length;j++){var y=x[j];if(y.type()!='mnd'){t++;if(w.id()===f.RowsFeedingName||w.id()===f.ColumnsFeedingName){u++}break}}}}var z;for(var i=0;i<a.length;i++){var w=a[i];if(w.type()==b.DIMENSION){var x=w.values();for(var j=0;j<x.length;j++){var y=x[j];if(y.type()=='mnd'){z=w.id();break}}}}if(k&&z!=q&&s!=q){t++}else if(!k&&z&&q&&z!=q&&s!=q){t++}if(u>0){t-=u-1}if((s===f.RowsFeedingName||s===f.ColumnsFeedingName)&&u>0){t--}var B;if(k){B=f.canAcceptMND(n.acceptMND)&&(t<=f.MaxDemensionFeedsCount)}else{B=f._canAddValueAtAALimitaion(a,v,l,m);if(v.length==0||(v.length==1&&v[0].id()==A.MND)){B=B&&(t<=f.MaxDemensionFeedsCount-1)}}if(B){var D=n.max;B=f._canAddValueAtDataContainerLimitaion(v,D,h,k);if(B){var E=f._getCapacityOfFeedDef(n);B=f._canAddValueAtCapacityLimitaion(p,E,h)}}return B};f._canAddValueAtAALimitaion=function(a,v,g,h){var i=f.countAAOfFeeds(a);var j=(i<=f.MaxDemensionFeedsCount);if(j){var k=f.countAAOfValues(v);if(k===0){var m=0;var l=a.reduce(function(o,p){var q=p.id();var s=q===f.RowsFeedingName||q===f.ColumnsFeedingName;var t=h[q];if(!t&&s){t=h[f.MultiplierFeedingName]}if(t&&q!==g&&t.type===b.DIMENSION&&t.min>0&&!p.values().length){if(s){m++}return o+1}return o},0);if(m>1){l-=m-1}var n=i+l+1;if(n>f.MaxDemensionFeedsCount){j=false}}}return j};f._canAddValueAtDataContainerLimitaion=function(v,m,i,a){var n=f.countDataContainers(v);if(n>m){return false}var g=(m>0&&(n<=m));if(g&&n===m){var h=f.hasMNDInValues(v);if(a){if(!h){if(n===1){g=false}else if(n===2){}}else{g=false}}else{if(!h){if(n===1){g=true}else if(n===2){}}else{if(n===1){if(i){g=false}else{g=true}}else if(n===2){g=true}}}}return g};f._canAddValueAtCapacityLimitaion=function(a,g,i){var v=a?a.values().length:0;if(v&&!i&&f.hasMNDInValues(a.values())){v--}return(v<g)};f.canAcceptMND=function(a){a=U.isNumber(a)?Number(a):-1;return(a>=0)};f.supportMultiChart=function(a,g){if(!a){return true}var i;var h;var j;var n;var k;for(i=0;i<a.length;i++){h=a[i];j=h.id();if(j===f.RowsFeedingName||j===f.ColumnsFeedingName){k=g[f.MultiplierFeedingName]}else{k=g[j]}n=f.countDataContainers(h.values());if(k&&n>k.max){return false}}return true};f.getRowAndColumnValues=function(a){if(!a){return null}var i;var g;var h;var n;var j=[];for(i=0;i<a.length;i++){g=a[i];h=g.id();if(h===f.RowsFeedingName||h===f.ColumnsFeedingName){j=j.concat(g.values())}}return j};f.match=function(t,a,s){if(!s&&d.supportMultiChart(t)){var g=d.toSingleChartType(t);var m=d.toMultiChartType(t);return f.match(g,a,true)||f.match(m,a,true)}else{var v=f.getManifestFeedsMap(t);var h=f._getFeedsValuesMap(a);var i;for(i in h){if(h.hasOwnProperty(i)){var j=v[i];if(!j){return false}}}return true}};f.buildEmptyFeeds=function(v){var a=[];var t=f.getVizFeeds(v);if(t){for(var i=0;i<t.length;i++){var g=t[i];if(g.id===f.MultiplierFeedingName){a.push(new F(f.RowsFeedingName,g.type,[]));a.push(new F(f.ColumnsFeedingName,g.type,[]))}else{a.push(new F(g.id,g.type,[]))}}}else{}return a};f.merge=function(h,a){var g=f._getFeedsValuesMap(a,false);for(var i=0;i<h.length;i++){var j=h[i];if(g[j.id()]){j.values(j.values().concat(g[j.id()]))}}return h};f.getFeed=function(a,g){for(var i=0;i<a.length;i++){var h=a[i];if(h.id()===g){return h}}return null};f.supportMND=function(t){var v=f.getVizFeeds(t);for(var i=0;i<v.length;i++){var a=v[i].acceptMND;if(f.canAcceptMND(a)){return true}}return false};f.getColumnFeeding=function(a){var g=null;for(var i=0;i<a.length;i++){var h=a[i].id();if(h===f.trillisFeeds.column.id){g=a[i]}}return g};return f});define('sap/viz/controls/common/feeds/AutoFeedingUtils',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/valueobjects/Shelf','sap/viz/controls/common/feeds/valueobjects/ShelfType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil'],function(C,F,a,A,L,S,b,U,V,c,d){var e={};e.getInitialShelves=function(t){var f={"measure":[],"attribute":[],"subtotal":[],"trellis":[]};var g=e.getFeedDefsMap(t);if(g){var m=g.measure;var h=e._getSortedIds(m,false);var k;var l;for(var i=0;i<h.length;i++){k=h[i];l=m[k];f["measure"].push(e._getShelfByFeedDef(l,b.MEASURE,t))}var n=g.dimension;var o=e._getSortedIds(n,true);for(var j=0;j<o.length;j++){k=o[j];l=n[k];if(k===c.RowsFeedingName||k===c.ColumnsFeedingName){f["trellis"].push(e._getShelfByFeedDef(l,b.TRELLIS))}else{f["attribute"].push(e._getShelfByFeedDef(l,b.ATTRIBUTE,t))}}var p=g.subtotal;var q=e._getSortedIds(p,false);for(var i=0;i<q.length;i++){k=q[i];l=p[k];f["subtotal"].push(e._getShelfByFeedDef(l,b.SUBTOTAL,t))}if(!d.isMultipleChart(t)&&d.supportMultiChart(t)){f["trellis"].push(e._getShelfByFeedDef(c.trillisFeeds.row,b.TRELLIS));f["trellis"].push(e._getShelfByFeedDef(c.trillisFeeds.column,b.TRELLIS))}}return f};e._getShelfByFeedDef=function(f,g,t){var v=d.isMultipleChart(t)?d.toSingleChartType(t):t;var h=new S();h.id=f.id;h.type=g;if(h.id===C.FEEDING_PRIMARY_VALUES){var j=V.getValueAxis(v);if(!j){if(v===C.TYPE_3D_BAR){h.name=L.get(s[h.id][1])}else{h.name=L.get(s[h.id][0])}}else{if(j.length===1){if(j[0]===C.AXIS_YAXIS){h.name=L.get(s[h.id][0])}else{h.name=L.get(s[h.id][1])}}else{for(var i=0;i<j.length;i++){if(j[i]===C.AXIS_YAXIS2){h.name=L.get(s[h.id][2]);break}else if(j[i]===C.AXIS_XAXIS2){h.name=L.get(s[h.id][3]);break}else{h.name=L.get(s[h.id][1])}}}}}else if(h.id===C.FEEDING_SECONDARY_VALUES){var j=V.getValueAxis(v);if(!!j){for(var i=0;i<j.length;i++){if(j[i]===C.AXIS_YAXIS2){h.name=L.get(s[h.id][0]);break}else if(j[i]===C.AXIS_XAXIS2){h.name=L.get(s[h.id][2]);break}else{h.name=L.get(s[h.id][1])}}}}else if(h.id===C.FEEDING_AXIS_LABELS){var k=V.getCategoryAxis(v);if(!k){if(v===C.TYPE_3D_BAR){h.name=L.get(s[h.id][1])}else{h.name=L.get(s[h.id][0])}}else{if(k[0]===C.AXIS_XAXIS){h.name=L.get(s[h.id][0])}else{h.name=L.get(s[h.id][1])}}}else{h.name=L.get(s[h.id])}if(!h.name){h.name=f.name}h.analysisType=f.type.toLowerCase();h.feedItemType=h.id===c.geoFeeds.id?a.GEOGRAPHY:f.type;h.capacity=f.maxStacked;return h};e.smartFeeding=function(f,g,h,i){return e._autoFeedItems(e._STRATEGY_SMART,f,g,h,i)};e.directFeeding=function(f,g,h){return e._autoFeedItems(e._STRATEGY_DIRECT,f,g,h)};e._STRATEGY_SMART='smart';e._STRATEGY_DIRECT='direct';e._autoFeedItems=function(f,g,t,h,k){g=c.cloneFeeds(g);var l=e.getFeedDefsMap(t);var p=e._prepareData(g);if(!l||!p){return g}var m={'measure':[],'dimension':[],'subtotal':[]};h=h||[];for(var i=0;i<h.length;i++){var n=h[i];if(A.compatible(A.MEASURE,n.type())){m.measure.push(n)}else{if(A.compatible(A.DIMENSION,n.type())){m.dimension.push(n)}}}if(k){e._addFeedingScope(l.measure,k);e._addFeedingScope(l.dimension,k)}var o=e._mapFeedsProcess(f,p.measure,l.measure,false,m.measure);if(t==="viz/ext/table"&&p.dimension!==undefined&&p.dimension.length>=2&&p.dimension[0].id()==="regionColor"&&p.dimension[1].id()!=="regionShape"){var q=p.dimension[0];p.dimension[0]=p.dimension[1];p.dimension[1]=q}var r=e._mapFeedsProcess(f,p.dimension,l.dimension,true,m.dimension);var u=e._mapFeedsProcess(f,p.subtotal,l.subtotal,false,m.subtotal);for(var i=0;i<r.length;i++){var v=r[i];var w=v.values();for(var j=0;j<w.length;j++){var x=w[j];if(x.aggregationType()){w.splice(j,1)}}}var y=o.concat(r);y=y.concat(u);return y};e._addFeedingScope=function(f,g){if(g){for(var h in f){if(g.indexOf(h)===-1){f[h].outOfFeedingScope=true}}}};e.needAutoFeeding=function(f,g,t){var n=true;if(!t||g===t||(!f)){n=false}return n};e.getFeedDefsMap=function(v){var m={'measure':{},'dimension':{},'subtotal':{}};var t=c.getVizFeeds(v);if(t){for(var i=0;i<t.length;i++){var f=t[i];if(f.type===a.MEASURE){m.measure[f.id]=e._addMinAndMaxStackedToFeedDef(f)}else if(f.type===a.DIMENSION){if(f.id===c.MultiplierFeedingName){var r=U.clone(f);r.id=c.RowsFeedingName;m.dimension[c.RowsFeedingName]=e._addMinAndMaxStackedToFeedDef(r,true);var g=U.clone(f);g.id=c.ColumnsFeedingName;m.dimension[c.ColumnsFeedingName]=e._addMinAndMaxStackedToFeedDef(g,true)}else{m.dimension[f.id]=e._addMinAndMaxStackedToFeedDef(f,true)}}else if(f.type===a.SUBTOTAL){m.subtotal[f.id]=e._addMinAndMaxStackedToFeedDef(f)}}}else{return null}return m};e._addMinAndMaxStackedToFeedDef=function(f,i){var r=U.clone(f);if(i){if(f.id===c.RowsFeedingName){r.minStacked=c.trillisFeeds.row.minStacked;r.maxStacked=c.trillisFeeds.row.maxStacked}else if(f.id===c.ColumnsFeedingName){r.minStacked=c.trillisFeeds.column.minStacked;r.maxStacked=c.trillisFeeds.column.maxStacked}else{var m=0;if(f.min){m=f.minStackedDims?f.minStackedDims:f.min}r.minStacked=m;var g=f.maxStackedDims?f.maxStackedDims:Number.MAX_VALUE;r.maxStacked=g}}else{r.minStacked=f.min;r.maxStacked=f.max=='Infinity'?Number.MAX_VALUE:f.max}return r};e._prepareData=function(f){var M=[];var D=[];var g=[];if(f.length>0){for(var i=0;i<f.length;i++){var h=f[i];if(h._id===a.ROW_SUBTOTALS){g.push(h)}if(h.type()===a.MEASURE){M.push(h)}else if(h.type()===a.DIMENSION){D.push(h)}}}return{'measure':M,'dimension':D,'subtotal':g}};e._mapFeedsProcess=function(f,g,h,i,p){var r=e._idMapping(g,h);var t=r.feeds;p=r.pool.concat(p||[]);var j=e._getSortedIds(h,i,true);if(i){var k=c.indexOfMNDInValues(p);if(k!==-1){var m=p[k];p.splice(k,1);e._autoFeedMNDValue(j,h,t,m)}if(f===e._STRATEGY_SMART){e._feedGeographyFeedItem(j,h,t,p)}}j.forEach(function(u){t[u]=t[u]||new F(u,h[u].type,[])});var l=e._precalFeedItemValuesSize(f,j,h,t,p.length,i);var n=e._getSortedIds(h,i);var o=e._locateValuestoFeeds(n,h,t,p,l);var q=e._convertToFeeds(n,o);return q};e._idMapping=function(f,g){var t={};var p=[];var m;var r=c.getRowAndColumnValues(f);for(var i=0;i<f.length;i++){var h=f[i];var j=h.id();var v=h.values();v=v?v:[];var k=e._getIdByShelfName(j,g);if(k){if(g[k].outOfFeedingScope){t[k]=h;continue}var l=g[k].maxStacked;var n=c.canAcceptMND(g[k].acceptMND);var o=c.indexOfMNDInValues(v);var q=false;if(!n){q=true}else{if(o>l){q=true}else{var u=g[k].max;var w;var x=-1;if(j===c.RowsFeedingName||j===c.ColumnsFeedingName){w=c.countDataContainers(r);x=c.indexOfMNDInValues(r)}else{w=c.countDataContainers(v)}if(w>u){if(j===c.RowsFeedingName||j===c.ColumnsFeedingName){if(x===0){if(o===0){l=1}else if(o===-1){l=0}}else{q=true;if(o!==-1&&x!==-1){r.splice(x,1);}}}else{if(o===0){l=1}else{q=true}}}}}if(q&&o!==-1){m=v[o];v.splice(o,1);e._pushFeedItemValuesToPool([m],p)}if(l<v.length){var y=v.slice(l,v.length);e._pushFeedItemValuesToPool(y,p);var z=v.slice(0,l);var B=new F(k,h.type(),z);t[k]=B}else{t[k]=new F(k,h.type(),v)}}else{e._pushFeedItemValuesToPool(v,p)}}return{'feeds':t,'pool':p}};e._autoFeedMNDValue=function(f,g,h,m){var j=-1;var k;var l=e._convertToFeeds(f,h);for(var i=0;i<f.length;i++){var n=f[i];var o=g[n];var p=true;var q=true;var r=c.canAddValue(l,n,g,p,q);if(r){var t=o.acceptMND;var u=h[n];var v=u?u.values():null;var w=c.countDataContainers(v);var x=g[n].min;if(w<x){t+=10}if(t>j){j=t;k=n}}}if(k){var u=h[k];var o=g[k];var v=u?u.values():[];v.push(m);h[k]=new F(o.id,o.type,v)}};e._feedGeographyFeedItem=function(f,g,h,p){var j=g[c.geoFeeds.id];if(!j){return}var k=h[c.geoFeeds.id];if(!k){k=new F(c.geoFeeds.id,j.type,[])}var v=k.values();if(v.length>0){return}var _=function(t){var u=-1;for(var i=0;i<t.length;i++){var w=t[i];if(w.dataType()&&w.dataType().toLowerCase()===a.GEOGRAPHY.toLowerCase()){u=i;break}}return u};var n;var l=_(p);if(l!==-1){n=p[l];p.splice(l,1)}else{var m,o,q,r;for(var i=0;i<f.length;i++){m=f[i];o=g[m];q=h[m];if(m===c.geoFeeds.id||!q){continue}r=q.values();if(r.length>1&&r.length>o.minStacked){l=_(r);if(l!==-1){n=r[l];r.splice(l,1);break}}}}if(n){v.push(n);h[c.geoFeeds.id]=k}};e._getIdByShelfName=function(f,g){if(g[f]){return f}var h=s[f];for(var i in g){if(g.hasOwnProperty(i)){var j=g[i];var t=s[i];if(h===t){return i}}}return null};e._locateValuestoFeeds=function(f,g,h,p,j){var i,k,l,v,m;for(i=0;i<f.length;i++){k=f[i];l=h[k];if(l){v=l.values();m=j[k];if(v.length>m){var n=c.indexOfMNDInValues(v);if(n!==-1&&n>=m){var o=v[n];v.splice(n,1);v.splice(m-1,0,o)}var r=v.slice(m,v.length);e._pushFeedItemValuesToPool(r,p)}}}for(i=0;i<f.length;i++){k=f[i];l=h[k];if(!l){l=new F(k,g[k].type,[]);h[k]=l}var q=false;m=j[k];v=l.values();if(m<v.length){q=true;v=v.slice(0,m)}else if(m>v.length&&p.length>0){q=true;var t=[];var u=false;if(v.length>1&&v[v.length-1].type()===A.MND){u=true}while(p.length>0&&m>v.length){var w=p.shift();if(!c.feedHasValue(w,l)){if(u){v.splice(v.length-1,0,w)}else{v.push(w)}}else{t.push(w)}}if(t.length>0){p=p.concat(t)}}if(q){h[k]=new F(k,g[k].type,v)}}return h};e._pushFeedItemValuesToPool=function(f,p){for(var i=0;i<f.length;i++){var g=f[i];p.push(g)}};e._precalFeedItemValuesSize=function(f,g,h,j,p,k){var l=e._initializeId2Size(g,j);var m;if(k){m=e._getFeedsStatus(g,h,j)}var n=e._getNeedToFillFeedsId(g,l,h);var o=!n.length;var q=0;var r;var i;var t;var u;var v;var w;if(!o&&p>0){r=true;for(i=0;i<n.length;i++){q=i;t=n[i];if(k&&!m[t]){continue}u=l[t];v=h[t].minStacked;w=v-u;if(p<w){w=p;r=false}l[t]=u+w;p-=w;if(!p){break}}o=r&&(q==n.length-1)}else if(!o){if(f===e._STRATEGY_SMART){var x=e._getOverMinFeedsId(g,l,h);if(x.length>0){r=true;var y=[];var z=0;var B;for(i=0;i<x.length;i++){B=x[i];var D=l[B];var E=h[B].minStacked;var G=D-E;y[B]=G;z+=G}var H=q;for(i=q;i<n.length;i++){H=i;t=n[i];if(k&&!m[t]){continue}u=l[t];v=h[t].minStacked;w=v-u;var I=w;for(var J in y){if(y.hasOwnProperty(J)){var G=y[J];if(G<I){I-=G;l[B]-=G}else{y[B]-=I;l[B]-=I;I=0;break}}}if(I>0){w-=I;r=false}l[t]=u+w;z-=w;if(!z){break}}o=r&&(H==n.length-1)}}return l}if(o&&p>0){var K=e._getEmptyFeedsId(g,l);for(i=0;i<K.length;i++){t=K[i];if(k&&!m[t]){continue}p--;l[t]=1;if(!p){if(i<K.length){o=false}break}}}if(o&&p>0){var M=e._getNotFullFeedsId(g,l,h);for(i=0;i<M.length;i++){t=M[i];if(k&&!m[t]){continue}u=l[t];var N=h[t].maxStacked;w=N-u;if(p<w){w=p}l[t]=u+w;p-=w;if(!p){break}}}return l};e._convertToFeeds=function(f,g){var t=[];for(var i=0;i<f.length;i++){var h=f[i];var j=g[h];if(j){t.push(j)}}return t};e._getSortedIds=function(f,g,h){var j=[];var k=[];for(var l in f){var m=f[l];var p=g?m.aaIndex:m.mgIndex;if(l===c.RowsFeedingName||l===c.ColumnsFeedingName){p=1000+m.aaIndex}k.push({id:l,priority:p})};k.sort(function(o,q){return o.priority-q.priority});for(var i=0;i<k.length;i++){var n=k[i].id;if(h&&f[n].outOfFeedingScope){continue}j.push(n)};return j};e._initializeId2Size=function(f,g){var h={};for(var i=0;i<f.length;i++){var j=f[i];if(j===a.ROW_SUBTOTALS||j===a.COLUMNS_SUBTOTALS){continue}var k=0;var l=g[j];if(l){k=l.values().length}h[j]=k}return h};e._getNeedToFillFeedsId=function(f,g,h){var j=[];for(var i=0;i<f.length;i++){var k=f[i];var l=h[k];var m=l.minStacked;var n=g[k];if(n<m){j.push(k)}}return j};e._getNotFullFeedsId=function(f,g,h){var j=[];for(var i=0;i<f.length;i++){var k=f[i];var l=h[k];var m=l.maxStacked;var n=g[k];if(n<m){j.push(k)}}return j};e._getOverMinFeedsId=function(f,g,h){var j=[];for(var i=0;i<f.length;i++){var k=f[i];var l=h[k];var m=l.minStacked;var n=g[k];if(n>1&&n>m){j.push(k)}}return j};e._getEmptyFeedsId=function(f,g){var h=[];for(var i=0;i<f.length;i++){var j=f[i];var k=g[j];if(k===0){h.push(j)}}return h};e._getFeedsStatus=function(f,g,h){var j={};var k;var _=function(w){var x=0;if(w===c.RowsFeedingName||w===c.ColumnsFeedingName){if(k!==undefined){var y=h[c.RowsFeedingName]?h[c.RowsFeedingName].item:null;var z=h[c.ColumnsFeedingName]?h[c.ColumnsFeedingName].item:null;var B=y?y.values():[];var D=z?z.values():[];var E=B.concat(D);x=c.countAAOfValues(E);k=x}else{x=k}}else{var G=h[w];x=c.countAAOfFeedItem(G)}return x};var l=e._getSortedIds(g,true);var m=e._convertToFeeds(l,h);var n=c.countAAOfFeeds(m);var o=(n<=c.MaxDemensionFeedsCount);var p=true;var q=false;for(var i=0;i<f.length;i++){var r=false;if(o){var t=f[i];if(t===c.geoFeeds.id){j[t]=false;continue}var u=g[t];r=c.canAddValue(m,t,g,p,q);if(r){var v=_(t);if(v===0){n++;if(n>c.MaxDemensionFeedsCount){r=false;n--}else if(t===c.RowsFeedingName){n--}}o=(n<=c.MaxDemensionFeedsCount)}}j[t]=r}return j};var s={"primaryValues":['VIZ_COMMON_YAXIS','VIZ_COMMON_XAXIS','VIZ_COMMON_PRIMARY_YAXIS','VIZ_COMMON_PRIMARY_XAXIS'],"secondaryValues":['VIZ_COMMON_SECONDARY_YAXIS','VIZ_COMMON_YAXIS','VIZ_COMMON_SECONDARY_XAXIS'],"pieSectorSize":'VIZ_COMMON_PIE_SECTORS',"pieDepthSize":'VIZ_COMMON_PIE_DEPTH',"featureValues":'VIZ_COMMON_FEATUREVALUES',"bubbleWidth":'VIZ_COMMON_BUBBLE_WIDTH',"bubbleHeight":'VIZ_COMMON_BUBBLE_HEIGHT',"rectangleColor":'VIZ_COMMON_RECTANGLECOLOR',"rectangleWeight":'VIZ_COMMON_RECTANGLEWEIGHT',"regionColor":'VIZ_COMMON_REGIONCOLOR',"axisLabels":['VIZ_COMMON_XAXIS','VIZ_COMMON_YAXIS'],"pieSectorColor":'VIZ_COMMON_REGIONCOLOR',"geoFeatures":'VIZ_COMMON_GEO_FEATURES',"featureAnalysis":'VIZ_COMMON_FEATUREANALYSIS',"regionShape":'VIZ_COMMON_REGIONSHAPE',"rectangleTitle":'VIZ_COMMON_AREANAME',"mainLabelAxis":'VIZ_COMMON_AREANAME',"secondaryLabelAxis":'VIZ_COMMON_SECONDARY_AREANAME',"radarAxesValues":'VIZ_COMMON_YAXIS',"radarAxes":'VIZ_COMMON_RADAR_AXES',"tagWeight":'VIZ_COMMON_TAGWEIGHT',"tagFamily":'VIZ_COMMON_TAGFAMILY',"tagName":'VIZ_COMMON_TAGNAME',"multiplier.column":'VIZ_COMMON_COLUMNS',"multiplier.row":'VIZ_COMMON_ROWS',"treeNode":'VIZ_COMMON_TREENODE',"link":'VIZ_COMMON_LINK',"rows":'VIZ_COMMON_TABLE_DIMENSION',"values":'VIZ_COMMON_TABLE_MEASURE',"r_subtotals":'VIZ_COMMON_TABLE_ROWS_SUBTOTALS',"cols":'VIZ_COMMON_TABLE_COLUMNS_AXIS',"c_subtotals":'VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS'};return e});define('sap/viz/controls/common/filter/AbstractFilter',[],function(){var A=function(t,o,a){this.__className="sap.viz.controls.common.filter.AbstractFilter";this.filterType=t;this.filteredObjectId=o;this.filteredObjectName=a;this.isReverse=true;this._isGlobalFilter=false};A.VALUE_TYPE="VALUE_FILTER_TYPE";A.NUMERIC_RANGE_TYPE="NUMERIC_RANGE_TYPE";A.DATE_RANGE_TYPE="DATE_RANGE_TYPE";A.prototype.getType=function(){return this.filterType};A.prototype.getFilteredObjectId=function(){return this.filteredObjectId};A.prototype.getFilteredObjectName=function(){return this.filteredObjectName};A.prototype.setReverseSelection=function(r){this.isReverse=r};A.prototype.isReverseSelection=function(){return this.isReverse};A.prototype.isEmpty=function(){return false};A.prototype.toJSON=function(){var j={};j.filteredObjectId=this.filteredObjectId;j.filteredObjectName=this.filteredObjectName;j.filterType=this.filterType;j.isReverse=this.isReverse;j.isGlobalFilter=this._isGlobalFilter;return j};A.prototype.analysisObjectId=function(){return this.getFilteredObjectId()};A.prototype.id=function(){return this.getFilteredObjectId()};A.prototype.filterName=function(){return this.getFilteredObjectName()};A.prototype.isExcluded=function(i){if(arguments.length>0){this.isReverse=!i}else{return!this.isReverse}};A.prototype.isGlobalFilter=function(i){if(arguments.length>0){this._isGlobalFilter=i;return this}else{return this._isGlobalFilter}};A.prototype.filterTitle=function(){return this.filteredObjectName};A.prototype.filterContent=function(){return this.filteredObjectName};return A});define('sap/viz/controls/common/utils/OOUtil',[],function(){var u;var O={};O.extend=function(s,a){var b=s.prototype;s.superclass=a.prototype;var F=function(){};F.prototype=a.prototype;s.prototype=new F();for(var p in b){if(b.hasOwnProperty(p)){s.prototype[p]=b[p]}}s.prototype.constructor=s;if(a.prototype.constructor==Object.prototype.constructor){a.prototype.constructor=a}return s};return O});define('sap/viz/controls/common/filter/DateRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,A,L){var D=function(o,a){var b=[];b.push(A.DATE_RANGE_TYPE);b.push(o);b.push(a);D.superclass.constructor.apply(this,b);this.__className="sap.viz.controls.common.filter.DateRangeFilter";this.minDate=null;this.maxDate=null;this.excludeNull=false};O.extend(D,A);D.prototype.isEmpty=function(){if(this.minDate===null&&this.maxDate===null){return true}return false};D.prototype.getMin=function(){return this.minDate};D.prototype.getMax=function(){return this.maxDate};D.prototype.isExcludeNull=function(){return this.excludeNull};D.prototype.setMin=function(m){this.minDate=m};D.prototype.setMax=function(m){this.maxDate=m};D.prototype.setExcludeNull=function(e){this.excludeNull=e};D.prototype.toJSON=function(){var j=D.superclass.toJSON.apply(this,arguments);j.minDate=this.minDate;j.maxDate=this.maxDate;j.excludeNull=this.excludeNull;return j};D.fromJSON=function(f){var a=new D(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.minDate=f.minDate;a.maxDate=f.maxDate;a.excludeNull=f.excludeNull;return a};D.prototype.clone=function(){var j=this.toJSON();return D.fromJSON(j)};D.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')'};D.prototype.filterContent=function(){return'('+this.minDate+'  -  '+this.maxDate+')'};return D});define('sap/viz/controls/common/filter/NumericRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,A,L){var N=function(o,a){var b=[];b.push(A.NUMERIC_RANGE_TYPE);b.push(o);b.push(a);N.superclass.constructor.apply(this,b);this.__className="sap.viz.controls.common.filter.NumericRangeFilter";this.minValue=null;this.maxValue=null;this.excludeNull=false};O.extend(N,A);N.prototype.isEmpty=function(){if(this.minValue===null&&this.maxValue===null){return true}return false};N.prototype.getMin=function(){return this.minValue};N.prototype.getMax=function(){return this.maxValue};N.prototype.isExcludeNull=function(){return this.excludeNull};N.prototype.setMin=function(m){this.minValue=m};N.prototype.setMax=function(m){this.maxValue=m};N.prototype.setExcludeNull=function(e){this.excludeNull=e};N.prototype.toJSON=function(){var j=N.superclass.toJSON.apply(this,arguments);j.minValue=this.minValue;j.maxValue=this.maxValue;j.excludeNull=this.excludeNull;return j};N.fromJSON=function(f){var a=new N(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.minValue=f.minValue;a.maxValue=f.maxValue;a.excludeNull=f.excludeNull;return a};N.prototype.clone=function(){var j=this.toJSON();return N.fromJSON(j)};N.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')'};N.prototype.filterContent=function(){return'('+this.minValue+'  -  '+this.maxValue+')'};return N});define('sap/viz/controls/common/filter/ValueFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter'],function(O,A){var V=function(o,a){V.superclass.constructor.apply(this,[A.VALUE_TYPE,o,a]);this.__className="sap.viz.controls.common.filter.ValueFilter";this.hierarchyLevelId=null;this.filteredValues=[]};O.extend(V,A);V.prototype.getValues=function(){return this.filteredValues};V.prototype.isEmpty=function(){if(this.filteredValues&&this.filteredValues.length>0){return false}else{return true}};V.prototype.removeAllValues=function(){this.filteredValues.length=0};V.prototype.addValue=function(v){return this.filteredValues.push(v)};V.prototype.removeValue=function(v){for(var i=0;i<this.filteredValues.length;i++){if(this.filteredValues[i].key===v.key&&this.filteredValues[i].value===v.value){this.filteredValues.splice(i,1)}}};V.prototype.toJSON=function(){var j=V.superclass.toJSON.apply(this,arguments);j.filteredValues=this.filteredValues;if(this.hierarchyLevelId){j.hierarchyLevelId=this.hierarchyLevelId}return j};V.fromJSON=function(f){var a=new V(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.filteredValues=f.filteredValues;if(f.hierarchyLevelId){a.hierarchyLevelId=f.hierarchyLevelId}return a};V.prototype.clone=function(){var j=this.toJSON();return V.fromJSON(j)};V.prototype.values=function(){return this.filteredValues};V.prototype.updateValues=function(v){return this.filteredValues=v};V.prototype.filterTitle=function(){return this.filteredObjectName+' ('+this.filteredValues.length+')'};V.prototype.filterContent=function(){var v="";for(var i=0,l=this.filteredValues.length;i<l;i++){if(v){v+=", "+this.filteredValues[i].value}else{v=this.filteredValues[i].value}}return v};return V});define('sap/viz/controls/common/events/EventDispatcher',['sap/viz/controls/common/utils/Utils'],function(u){var E=function(){this.__className="sap.viz.controls.common.events.EventDispatcher";this._enableDispatchEvent=true};E.prototype.addEventListener=function(t,l,s,p){if(!p){p=0}var e=this._findEventListener(t,l,s);if(e){return}e={type:t,scope:s,listener:l,priority:p};var a=this.listeners()[t];if(!a){this.listeners()[t]=a=[e]}else{var i=false;for(var n=0;n<a.length;++n){var b=a[n];if(p>b.priority){a.splice(n,0,e);i=true;break}}if(i===false){a.push(e)}}};E.prototype.removeEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);if(e){var a=this.listeners()[t];a.splice(a.indexOf(e),1)}};E.prototype.removeEventListeners=function(t){this.listeners()[t]=[]};E.prototype.removeAllEventListeners=function(){this._listeners={}};E.prototype.hasEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);return e!==null};E.prototype.hasEventListeners=function(t){var l=this.listeners()[t];if(l){return l.length>0}return false};E.prototype._dispatchEvent=function(e){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true}if(this._enableDispatchEvent){var t=e.type();var l=this.listeners()[t];if(l){var c=l.slice(0);for(var n=0;n<c.length;++n){var a=c[n];a.listener.call(a.scope,e)}}}};E.prototype.enableDispatchEvent=function(v){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true}if(arguments.length>=1){if(u.isBoolean(v)){this._enableDispatchEvent=v}return this}else{return this._enableDispatchEvent}};E.prototype._findEventListener=function(t,l,s){var a=this.listeners()[t];if(!a){return null}for(var n=0;n<a.length;++n){var e=a[n];if(e.listener===l&&e.scope===s){return e}}return null};E.prototype.listeners=function(){if(this._listeners===undefined){this._listeners={}}return this._listeners};return E});define('sap/viz/controls/common/UIControl',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/utils/Utils'],function($,O,E,u){var U=function U(d,a){U.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.UIControl";this._dom=d;this._dom$=$(d);this._uiConfig=a;this._uid=u.genUID()};O.extend(U,E);U.prototype.size=function(v){if(arguments.length>0){if(v.width!=null){this._dom$.width(v.width)}if(v.height!=null){this._dom$.height(v.height)}this._validateSize();return this}else{return{'width':this._dom$.width(),'height':this._dom$.height()}}};U.prototype._validateSize=function(){};U.prototype.visible=function(v){this._dom$.css("visibility",v?"visible":"hidden");return this};U.prototype.hide=function(){this._dom$.hide();return this};U.prototype.show=function(){this._dom$.show();return this};U.prototype.destroy=function(){this._dom$.removeData().off().find('*').removeData().off();this._dom$.empty();this._dom=null};return U});define('sap/viz/controls/common/views/drag/DropAction',[],function(){var D={};D.ACCEPT='accept';D.ACCEPT_AS_REPLACEMENT='acceptAsReplacement';D.ACCEPT_AS_COPY='acceptAsCopy';D.DENY='deny';D.AS_TRASH='asTrash';return D});define('sap/viz/controls/common/views/drag/AnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction'],function($,C,O,u,U,D){var A=function(d,a,b){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.AnalysisToken";this._domHelper$=$(d);this._domDraggable$=$(a);this._fixDragingPosition();this._defaultAction=D.DENY;this.analysisObject=b;this.playDefaultAction()};O.extend(A,U);A.prototype._fixDragingPosition=function(){var d=this._domDraggable$;var a=$.proxy(function(e,c){c.position.top=c.offset.top;c.position.left=c.offset.left;c.helper.trigger('sap.viz.controls.analysisDrag.events.drag',[e.pageX,e.pageY])},this);var b=$.proxy(function(e,c){o()},this);var o=function(){d.off('drag',a);d.off('dragstop',b)};o();d.on('drag',a);d.on('dragstop',b)};A.prototype.defaultAction=function(v){if(arguments.length>0){this._defaultAction=v;return this}else{return this._defaultAction}};A.prototype.killRevertAnimation=function(){var d=this._domDraggable$;if(d){var o=d.draggable('option','revertDuration');d.draggable('option','revertDuration',0);u.defer(function(){try{d.draggable('option','revertDuration',o)}catch(e){}})}};A.prototype.dropTarget=function(v){};A.prototype.currentAction=function(v){if(arguments.length>0){this._domHelper$.data('sap.viz.controls.analysisDrag.action',v);this._domHelper$.trigger('sap.viz.controls.analysisDrag.events.dropAction',[v]);return this}else{return this._domHelper$.data('sap.viz.controls.analysisDrag.action')}};A.prototype.playDefaultAction=function(){this.currentAction(this._defaultAction)};A.prototype.showWarn=function(w){};return A});define('sap/viz/controls/common/views/drag/DefaultAnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/utils/Utils'],function($,C,A,O,U,a,D,b){var c=function(d,e,f){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.DefaultAnalysisToken";this._dom$=$(d);this._icon$=null;this._warn$=null;this._warnspan$=null;this._dropTarget=null;this._createChildren();this._dom$.appendTo(document.body);this.currentAction(this._defaultAction);c._instance=this};O.extend(c,a);c._ACTION_TO_CLASS=(function(){var m={};var p=C.COMMON_PREFIX;var d=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-'+'icon-dropAccepted';m[D.ACCEPT]=d;m[D.ACCEPT_AS_COPY]=d;d=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-icon-dropAcceptedAsReplacement';m[D.ACCEPT_AS_REPLACEMENT]=d;d=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-'+'icon-dropDenied';m[D.DENY]=d;d=p+'havanaSharedSprite16 '+p+'analysisDraggingToken-icon-dropAsTrash';m[D.AS_TRASH]=d;return m})();c.prototype.dropTarget=function(v){if(arguments.length>0){this._dropTarget=v;return this}else{return this._dropTarget}};c.prototype.currentAction=function(v){if(this._icon$){if(arguments.length>0){this._icon$.removeClass(c._ACTION_TO_CLASS[D.ACCEPT]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.ACCEPT_AS_COPY]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.ACCEPT_AS_REPLACEMENT]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.DENY]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.AS_TRASH]);this._icon$.addClass(c._ACTION_TO_CLASS[v])}}return c.superclass.currentAction.apply(this,arguments)};c.prototype.showWarn=function(w){if(w){if(!this._warn$){this._warn$=$(document.createElement('div')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn').appendTo(this._dom$);this._warnspan$=$(document.createElement('span')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text').appendTo(this._warn$)}this._warnspan$.text(w);this._layoutWarn();this._dom$.bind("mousemove",$.proxy(function(e){this._layoutWarn()},this))}else{if(this._warn$){this._warn$.hide(0);this._dom$.unbind("mousemove")}}};c.prototype._layoutWarn=function(){this._warn$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warn$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warnspan$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warnspan$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warn$.css({'maxWidth':$(window).width()+'px'});var d=this._dom$.outerWidth();var e=this._dom$.outerHeight();var l=this._dom$.offset().left-document.body.scrollLeft;var r=$(window).width()-this._dom$.offset().left-d;var w=false;var m=0;var f=0;var g=d;var h=this._warnspan$.outerWidth();this._warn$.hide(0);if(r>=h){m=-e;f=d;g=h}else if(l>=h){f=-h}else if(r>=g){w=true;m=-e;f=d;g=r}else if(l>=g){w=true;f=-l;h=l}else{w=true;f=-l}g=Math.min(g,$(window).width());h=Math.min(h,$(window).width());this._warn$.css({'marginTop':m+'px','marginLeft':f+'px','minWidth':g+'px','maxWidth':h+'px'});if(w){this._warnspan$.css({'whiteSpace':'pre-line'})}this._warn$.show(0)};c.prototype._createChildren=function(){this._dom$.addClass(C.COMMON_PREFIX+'analysisDraggingToken');var n=this.analysisObject.name();if(this.analysisObject.type()===A.HIERARCHY){var s=this.analysisObject.selectedHierarchyLevel();n=s.name()}var d=$(document.createElement('span')).appendTo(this._dom$).text(n);d.addClass(C.COMMON_PREFIX+'text-ellipsis');var i=this._icon$=$(document.createElement('input')).appendTo(this._dom$);i.addClass(C.COMMON_PREFIX+'analysisDraggingToken-icon')};return c});define('sap/viz/controls/common/managers/DragManager',['jquery','sap/viz/controls/common/views/drag/DefaultAnalysisToken','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction'],function($,D,A,a){var b=function(){this.__className="sap.viz.controls.common.managers.DragManager"};b._instance=null;b.instance=function(){if(!b._instance){b._instance=new b()}return b._instance};b.enableDraggableFeeding=function(d,c,e){var f=$(d);f.off('dragstart',b._feedingDragStartHandler);f.on('dragstart',b._feedingDragStartHandler);f.addClass(b.DRAGGABLE_CLASS_ANALYSIS);f.data(b._KEY_ANALYSIS,c);f.data(b._KEY_BACKUPAOS,e)};b.disableDraggableFeeding=function(d){var c=$(d);c.off('dragstart',b._feedingDragStartHandler);c.removeClass(b.DRAGGABLE_CLASS_ANALYSIS);c.removeData(b._KEY_ANALYSIS);c.removeData(b._KEY_BACKUPAOS)};b.getDefaultHelper=function(d){var c=$(d);var e=c.data(b._KEY_ANALYSIS);if(!e){return null}var h=document.createElement('div');var t=new D(h,d,e);var f=c.data(b._KEY_BACKUPAOS);if(f){t.backupAOs=f}$(h).data(b._KEY_TOKEN,t);return h};b._feedingDragStartHandler=function(e,u){var d=$(e.currentTarget);u.helper.data(b._KEY_ANALYSIS,d.data(b._KEY_ANALYSIS));u.helper.data(b._KEY_DRAGGABLE,d[0])};b.DRAGGABLE_CLASS_ANALYSIS='viz-controls-common-analysisDraggable';b._KEY_ANALYSIS='sap.viz.controls.reserved.draggableFeeding.analysisObject';b._KEY_BACKUPAOS='sap.viz.controls.reserved.draggableFeeding.backupAnalysisObjects';b._KEY_TOKEN='sap.viz.controls.reserved.draggableFeeding.analysisToken';b._KEY_DRAGGABLE='sap.viz.controls.reserved.draggableFeeding.domDraggable';b.prototype.getAnalysisToken=function(h){var t=h.data(b._KEY_TOKEN);if(t){return t}else{var c=h.data(b._KEY_ANALYSIS);if(c){t=new A(h[0],h.data(b._KEY_DRAGGABLE),c);h.data(b._KEY_TOKEN,t);return t}else{return null}}};return b});define('sap/viz/controls/common/utils/DatasetUtil',['sap/viz/controls/common/utils/Utils'],function(U){var D={};D.findAAIndex=function(f,a){for(var i=0;i<a.length;i++){if(a[i].feedId===f){var b=a[i].binding;for(var j=0;j<b.length;j++){var c=b[j];if(c.index!=null){return c.index}}}}return-1};D.getValue=function(d,a,b,c,e){var v=null;D._searchDimension(function(f,c,g){v=f.values[e]},d,a,b,c);return v};D.getInfoValue=function(d,a,b,c,e,f){var i;if(a&&a.length){i=D._getInfoValue(d,a,b,c,e,f)}return i};D._getInfoValue=function(d,a,b,c,e,f){for(var i=0;i<a.length;i++){var g=a[i];if(g.type!=='additionalData'){continue}var h=g.info;var j=null;D._searchDimension(function(k,e,l){j=h[l].infoValues[f]},d,b,c,e);return j}return null};D._searchDimension=function(c,d,a,b,e){var f=d.analysisAxis;var g=0;for(var i=0;i<f.length;i++){var h=f[i];if(a===h.index){for(var j=0;j<h.data.length;j++){var k=h.data[j];var m=isNaN(e)?k.name===b:e===j;if(m){c(k,j,g)}g++}}else{g+=h.data.length}}};D._hasNegativeValue=function(a){var r=false;for(var i=0;i<a.length;i++){if(U.isNumber(a[i])&&a[i]<0){r=true;break}}return r};var S={'viz/bubble':['bubbleWidth','bubbleHeight'],'viz/geobubble':['featureValues'],'viz/multi_geobubble':['featureValues'],'viz/multi_bubble':['bubbleWidth','bubbleHeight']};D.hasNegativeMeasureValue=function(c,a){var m=U.clone(S[a]);if(!m||!c){return false}var d=c.data();if(!d){return false}var b=d.measureValuesGroup;if(!sap.viz.api.manifest.Viz.get(a)[0]){return}var f=sap.viz.api.manifest.Viz.get(a)[0].allFeeds(true);var e=[];for(var i=0;i<f.length;i++){if(m.length<=0){break}for(var j=0;j<m.length;j++){if(f[i].id===m[j]){e.push(f[i].mgIndex);m.splice(j,1);break}}}for(i=0;i<b.length;i++){var g=b[i];if(!g||!U.isArray(g.data)){continue}if(e.indexOf(b[i].index)<0){continue}for(j=0;j<g.data.length;j++){var h=g.data[j];if(!h||!U.isArray(h.values)){continue}for(var k=0;k<h.values.length;k++){var v=h.values[k];if(!U.isArray(v)){continue}if(this._hasNegativeValue(v)){return true}}}}return false};return D});define('sap/viz/controls/common/filter/FilterHelper',['jquery','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter'],function($,u,D,A,F,a,b,c,N,V){var d={};d.getMapFilterItems=function(s,e,f,g){if(!s||s.length<1||!g||g.length<1){return f}var p=[];for(var i=0;i<s.length;++i){var h=s[i].layerIndex;var l=g[h];if(!l||l.length<1){continue}for(var j in s[i].data){if(!s[i].data.hasOwnProperty(j)){continue}var k=d._getAnalysisObject(j,l);if(!k){continue}var o=d.getFilterInfo(k);var q={'value':s[i].data[j]};var r=false;for(var n=0;n<p.length;++n){if(p[n].filterInfo.id===o.id&&p[n].filterInfo.hierarchyLevelId===o.hierarchyLevelId){r=true;p[n].values.push(q);break}}if(!r){p.push({filterInfo:o,values:[q]})}}}var t=f.slice(0);for(var m=0;m<p.length;m++){var v=d._getFilter(t,p[m].filterInfo.id,p[m].filterInfo.hierarchyLevelId);if(v){t=d._updateFilterItem(t,v,p[m].values,e)}else{t=d._addFilterItem(t,p[m].filterInfo,p[m].values,e)}}return t};d._getAnalysisObject=function(e,f){for(var i=0;i<f.length;i++){if(f[i].type()!==F.DIMENSION){continue}var g=f[i].values();for(var j=0;j<g.length;j++){if(g[j].id()===e){return g[j]}}}return null};d.getFilterInfo=function(e){var n=e.name();var i=e.id();if(e.type()===A.HIERARCHY){var s=e.selectedHierarchyLevel();n=s.name();i=s.analysis().id();return{name:n,id:i,hierarchyLevelId:s.id(),hierarchyInfo:d._buildFilterHierarchyInfo(e)}}return{name:n,id:i}};d._buildFilterHierarchyInfo=function(e){var h=null;if(e.type()===A.HIERARCHY){h={hierarchyId:e.id(),levels:d._buildFilterHierarchyLevels(e.hierarchyLevels())}}return h};d.getFilterItems=function(s,e,f,g,h,k){if(!s||s.length===0){return f}var l=h.data();var m=h.info('additionalData');var i;var n=a.cloneFeeds(g);var o=false;for(i=0;i<k.length;i++){if(k[i].feedId===a.MultiplierFeedingName&&k[i].binding.length>0){o=true;break}}if(o){n=d._getFilterFeeds(n)}var p=[],q=[],r=[];for(i=0;i<n.length;i++){if(n[i].type()!==F.DIMENSION){continue}var t=D.findAAIndex(n[i].id(),k);var v=n[i].values();var w=0;for(var j=0;j<v.length;j++){p.push(d.getFilterInfo(v[j]));if(v[j].type()===A.MND){q.push(-1);r.push(-1)}else{q.push(t);r.push(w);w++}}}f=f.slice(0);var x={};for(i=0;i<p.length;i++){var y=p[i];var t=q[i];if(t<0){continue}if(!x[t]){x[t]=0}var z=d._pathsIndex(y.hierarchyInfo);var B=d._getAADataLength(l,t);if(z>0&&z<B){x[t]+=z}var C=d._getFilterValues(l,m,s,t,y.name,r[i]+x[t],y.hierarchyInfo);if(!C||C.length===0){continue}var E=d._getFilter(f,y.id,y.hierarchyLevelId);if(E){f=d._updateFilterItem(f,E,C,e)}else{f=d._addFilterItem(f,y,C,e)}}return f};d._getFilterFeeds=function(f){var n;var v=[];for(var i=f.length-1;i>=0;i--){if(f[i].id().indexOf(a.MultiplierFeedingName)===0){v=v.concat(f[i].values().reverse());n=f[i];f.splice(i,1)}}n.values(v.reverse());n._id=a.MultiplierFeedingName;f.push(n);return f};d._excludeFilterValues=function(f,v){var e=f.values().slice(0);var i,n;if(f.isExcluded()){for(i=0;i<v.length;i++){var g=false;for(n=0;n<e.length;n++){if(d._filterValueEquals(v[i],e[n])){g=true;break}}if(!g){e.push(v[i])}}}else{for(i=0;i<v.length;i++){for(n=0;n<e.length;n++){if(d._filterValueEquals(v[i],e[n])){e.splice(n,1);break}}}}f.updateValues(e)};d._updateFilterItem=function(f,e,v,i){if(i){d._excludeFilterValues(e,v)}else{e.isExcluded(i);e.updateValues(v)}if(e.isEmpty()){var g=f.indexOf(e);f.splice(g,1)}return f};d._getFilterValues=function(e,f,s,g,h,j,k){var v=[];for(var i in s){var l=s[i];var m=l.ctx[0]['dii_a'+g];var n=D.getValue(e,g,h,j,m);if(!n){continue}var o=D.getInfoValue(e,f,g,h,j,m);var p;p={'value':n,'infoValue':o};if(!d._isValueExisted(v,p)){v.push(p)}}return v};d._getAADataLength=function(e,f){var l=0;var r=e;var i=f-1;if(r&&r.analysisAxis&&r.analysisAxis[i]){var g=r.analysisAxis[i].data;if(g){l=g.length}}return l};d._pathsIndex=function(h){if(h&&h.levels){var l=h.levels;for(var i in l){if(l[i].selected===true){return Number(i)}}}return-1};d._addFilterItem=function(f,i,v,e){var g=new V(i.id,i.name);g.hierarchyLevelId=i.hierarchyLevelId;g.updateValues(v);g.isExcluded(e);f.push(g);return f};d._buildFilterHierarchyLevels=function(h){var l=[];if(h&&h.length>0){for(var i in h){var e={id:h[i].id(),name:h[i].name(),selected:h[i].selected()};l.push(e)}}return l};d._filterValueEquals=function(v,e){if(!v&&!e){return true}if((!v&&e)||(v&&!e)){return false}if(v.value!==e.value){return false}if(v.infoValue===e.infoValue){return true}if(v.infoValue==null||e.infoValue==null){return true}if(u.isFunction(v.infoValue.equals)){return v.infoValue.equals(e.infoValue)}else if(v.infoValue.hasOwnProperty('key')){return v.infoValue.key===e.infoValue.key}else{return true}};d._isValueExisted=function(e,f){var v=f.value;var g=f.infoValue;var h=false;if(!e||e.length===0){return h}for(var i=0;i<e.length;i++){if(e[i]){h=d._filterValueEquals(e[i],f);if(h===true){break}}}return h};d._getFilter=function(f,e,h){var r=null;for(var i=0;i<f.length;i++){var g=f[i];if(!g.isGlobalFilter()&&g.id()===e&&(g.hierarchyLevelId==h)){r=g;break}}return r};d.isFilterItemExisted=function(m,i,h){var f=d._getFilter(m.filterItems(),i,h);if(f){return true}else{return false}};d.toJSON=function(i){return u.toJSON(i,function(i){return i.toJSON()})};d.fromJSON=function(j){return u.fromJSON(j,function(j){var f=j.filterType;var i;switch(f){case b.VALUE_TYPE:i=V.fromJSON(j);break;case b.NUMERIC_RANGE_TYPE:i=N.fromJSON(j);break;case b.DATE_RANGE_TYPE:i=c.fromJSON(j);break}return i})};return d});define('sap/viz/controls/services/FakeDataService',['sap/viz/controls/common/utils/FakeDataUtils'],function(F){var a=function(v,r,f){this._createChart(v,r,f)};a.feedItems2feed=function(f){return F.feedItems2feed(f)};a.prototype.getVizType=function(){return this._vizType};a.prototype.getVizDataset=function(){return this._vizDataset};a.prototype._createChart=function(v,r,f){this._vizType=v;var b=F.buildFakeData(v,f,r);this._vizDataset=b.dataset;this._vizFeeding=b.feeding};return a});define('sap/viz/controls/common/utils/IncompleteGhost',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/services/FakeDataService'],function(C,a,F){var I={};I.getDataset=function(t){if(!sap.viz.api.manifest.Viz.get(t)[0]){var d=new sap.viz.api.data.CrosstableDataset();return d}else if((!a.isBuildInType(t))&&t!==C.TYPE_PC&&t!==C.TYPE_FUNNEL&&!a.isTable(t)){var f=new F(t,{},[]);var d=new sap.viz.api.data.CrosstableDataset();var b=f.getVizDataset();d.data(b);return d}else{var b=I._DATA_BY_TYPE[t]?I._DATA_BY_TYPE[t]:I._DATA_COMMON;if(a.isTable(t)){return b}else{var d=new sap.viz.api.data.CrosstableDataset();d.data(b);return d}}};I._DATA_COMMON={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':'Margin','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};I._DATA_BY_TYPE={};I._DATA_BY_TYPE[C.TYPE_NUMBER]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[null]]}]}]};I._DATA_BY_TYPE[C.TYPE_COMBINATION]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]},{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]}]};I._DATA_BY_TYPE[C.TYPE_GEO_BUBBLE]=I._DATA_BY_TYPE[C.TYPE_GEO_CHOROPLETH]=I._DATA_BY_TYPE[C.TYPE_GEO_PIE]=I._DATA_BY_TYPE[C.TYPE_GEO_MAP]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Region','values':['United Kingdom','Italy','United States','New Zealand','Germany','China','Russia','Canada','Brazil'],'infos':[{'featureId':'UK,NAVTEQ','latLong':undefined},{'featureId':'20110484,NAVTEQ','latLong':undefined},{'featureId':'21000001,NAVTEQ','latLong':undefined},{'featureId':'23060936,NAVTEQ','latLong':undefined},{'featureId':'20147700,NAVTEQ','latLong':undefined},{'featureId':'22928332,NAVTEQ','latLong':undefined},{'featureId':'20485579,NAVTEQ','latLong':undefined},{'featureId':'21041602,NAVTEQ','latLong':undefined},{'featureId':'23028911,NAVTEQ','latLong':undefined}]}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':'Margin','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};I._DATA_BY_TYPE[C.TYPE_SCATTER_MATRIX]={"analysisAxis":[{"index":1,"data":[{'isFake':true,'type':'Dimension',"name":"Country","values":["Country 1","Country 1","Country 2","Country 2"]},{'isFake':true,'type':'Dimension',"name":"Product","values":['Product 1','Product 2','Product 3','Product 4']}]}],"measureValuesGroup":[{"index":1,"data":[{'isFake':true,'type':'Measure',"name":"Revenue","values":[[43,31,43,41]]},{'isFake':true,'type':'Measure',"name":"Cost","values":[[252,124,370,170]]}]}]};I._DATA_BY_TYPE[C.TYPE_TREE]=I._DATA_BY_TYPE[C.TYPE_NETWORK]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4']},{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 1','Product 1','Product 1','Product 2','Product 2','Product 2','Product 2','Product 3','Product 3','Product 3','Product 3','Product 4','Product 4','Product 4','Product 4']}]}],'measureValuesGroup':[]};I._DATA_BY_TYPE[C.TYPE_PC]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 1','Country 1','Country 2','Country 2','Country 3','Country 4','Country 4','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9','Country 9']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[5.1,4.9,4.7,4.6,5,7,6.4,6.9,5.5,6.5,6.3,5.8,7.1,6.3,6.5]]},{'isFake':true,'type':'Measure','name':'Cost','values':[[3.1,8.9,2.7,6.6,5,5,6.6,6.9,7.5,2.5,2.3,5.8,8.1,1.3,2.5]]}]}]};I._DATA_BY_TYPE[C.TYPE_TABLE]=I._DATA_BY_TYPE[C.TYPE_CROSSTAB]={"isFake":true,"queryResponse":[{"dimAxes":{"rowsDim":{"count":0,"values":[]}},"metadata":{"dictionary":{"rowsDim":[],"measures":[]}},"valueAxes":[],"ranges":{"cellsDim":[{"marksNum":[]}]},"executionStatus":{"status":"ok"}},{"valueAxes":[],"executionStatus":{"status":"ok"}}]};return I});define('sap/viz/controls/common/utils/Serialization',['sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/managers/LangManager','sap/viz/controls/Version','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/InfoChartUtil'],function(F,A,a,b,u,V,G,I,L,c,d,C,e){var S={};S.TypeConst={FlatTableDataset:'FlatTable',CrosstableDataset:'Crosstable',RawDataset:'JSON'};S.migrate=function(v){var r=u.clone(v);var i;var f=r['version'];if(f==='1.0'){var g=S.migrateVizFrame(r);r={};r['vizFrame']=g}else{var g=r['vizFrame'];if(g){r['vizFrame']=S.migrateVizFrame(g)}if(r['vizBuilder']){var h=r['vizBuilder']['feedingPanel'];if(h){r['vizBuilder']['feedingPanel']=S.migrateFeedingPanel(h)}}}return r};S.migrateVizFrame=function(v){var r=u.clone(v);var f=r['version'];if(f==='1.0'){var g={chart:{}};if(r['chart']){var m=r['chart']['vizModel'];if(m){g['chart']['type']=m['vizType'];g['chart']['feedingItems']=m['feedingItems'];g['filterBar']={};g['filterBar']['filterItems']=m['filterItems'];g['contextMenu']={};g['contextMenu']['isMNDVisible']=m['isMNDVisible']}var i=r['chart']['vizInstance'];if(i){g['chart']['vizInstance']=i}}var h=r['comments'];if(h){g['annotation']=h}g['version']=c.VERSION;r=g}if(r['chart']){var t=r['chart']['type'];var j=r['contextMenu']?r['contextMenu']['isMNDVisible']:null;S._migrateFeeds(r['chart'],t,j)}return r};S.migrateFeedingPanel=function(v){var r=u.clone(v);var t=r.type;var i=r['mndVisible'];S._migrateFeeds(r,t,i);return r};S._migrateFeeds=function(v,f,g){if(g===false){var h=S._getFeedsFromInnerControl(v);if(C.isGeo(f)){for(var i=0;i<h.length;i++){h=d.removeMND(h[i])}}else{h=d.removeMND(h)}S._updateFeedsToInnerControl(v,h)}};S.getFeeds=function(v){var f=null;var g=S._getValue(v,['vizFrame','chart','feedingItems']);var h=S._getValue(v,['vizBuilder','feedingPanel','feedingItems']);var i;if(g){f=g;var j=S._getValue(v,['vizFrame','contextMenu']);if(j){i=j.isMNDVisible}}else if(h){f=h;var k=S._getValue(v,['vizBuilder','feedingPanel']);if(k){i=k.mndVisible}}if(f==null){return[]}var l=F.fromJSON(f);if(i===false){l=d.removeMND(l)}return l};S._getFeedsFromInnerControl=function(v){var f=null;var g=S._getValue(v,['feedingItems']);if(g){f=g}if(f==null){return[]}var h=F.fromJSON(f);return h};S.updateFeeds=function(v,f){var g=F.toJSON(f);S._setValue(v,['vizFrame','chart','feedingItems'],g);S._setValue(v,['vizBuilder','feedingPanel','feedingItems'],g);return v};S._updateFeedsToInnerControl=function(v,f){var g=F.toJSON(f);S._setValue(v,['feedingItems'],g);return v};S.getFilters=function(v){var f=S._getValue(v,['vizFrame','filterBar','filterItems']);if(f==null){return[]}var g=b.fromJSON(f);return g};S.updateFilters=function(v,f){var g=b.toJSON(f);S._setValue(v,['vizFrame','filterBar','filterItems'],g);return v};S.removeDataset=function(v){var f=S._getValue(v,['vizFrame','chart','vizInstance']);if(f){var t=S.getChartType(v);if(!C.isGeo(t)){delete f['data']}else{sap.viz.geo.utils.Serialization.removeDataset(f)}}return v};S.emptyDataset=function(v){var f=S._getValue(v,['vizFrame','chart','vizInstance','data']);if(f){S._emptyDataset(f)}var s=S._getValue(v,['vizFrame','playControl','slicedData']);if(s){s.measuresInfo=[];s.slices=[]}return v};S._emptyDataset=function(f){if(!f){return}if(f instanceof Array){for(var i=0;i<f.length;i++){S._emptyDataset(f[i])}}else{var t=f['type'];var g=f['val'];var h={};var j={};if(t===S.TypeConst.CrosstableDataset){h=new sap.viz.api.data.CrosstableDataset();h.data(g);j=h.toJSON({emptyDataset:true}).data}else if(t===S.TypeConst.FlatTableDataset){h=new sap.viz.api.data.FlatTableDataset(feedData);j=h.toJSON({emptyDataset:true}).data}else if(t===S.TypeConst.RawDataset){j={}}else{throw L.get('VIZ_COMMON_SERIALIZATION_FAILED')+L.get('VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE')}f['val']=j}};S.updateDataset=function(v,f){var g=S._getValue(v,['vizFrame','chart','vizInstance']);if(g){g['data']={};if(e.isInfoChart(g.type)&&(f instanceof sap.viz.api.data.CrosstableDataset)){f=e.buildInfoDataset(f)}if(!C.isGeo(g.type)){S._updateDataset(g['data'],f)}else{sap.viz.geo.utils.Serialization.updateDataset(g,f)}}return v};S._updateDataset=function(f,g){if(!f||!g){return}if(g instanceof Array){for(var i=0;i<g.length;i++){var h=g[i];S._updateDataset(f[i],h)}}else if(g instanceof sap.viz.api.data.CrosstableDataset){f['type']=S.TypeConst.CrosstableDataset;f['val']=g.data()}else if(g instanceof sap.viz.api.data.FlatTableDataset){f['type']=S.TypeConst.FlatTableDataset;f['val']=g.data()}else{f['type']=S.TypeConst.RawDataset;f['val']=g}};S.convertToVizSerialization=function(v){var f=S._getValue(v,['vizFrame','vizInstance']);if(f){return u.clone(f)}return null};S.updateProperties=function(v,p){S._setValue(v,['vizFrame','chart','vizInstance','properties'],p);return v};S.getProperties=function(v){var p=S._getValue(v,['vizFrame','chart','vizInstance','properties']);return p||{}};S.updateAnalysisObjectLabels=function(v,f){if(!f){return v}var g=S.getFeeds(v)||[];var h=S.getFilters(v)||[];var s=S._getSliceDimension(v);function i(j){var k={};j.forEach(function(q){if(q){k[q.id()]=q}});return k}function l(j){var k={};var q=j.slice();while(q.length){var w=q.shift();if(w){var x=w.hierarchyLevels()||[];k[w.id()]={ao:w,hlHash:i(x)};q=q.concat(x.map(function(y){return y._analysis}))}}return k}var n=l(f);g.forEach(function(j){var k=j.values();if(k){var q=l(k);for(var w in q){var x=q[w];var m=n[w];if(m){x.ao.name(m.ao.name());for(var p in x.hlHash){var y=x.hlHash[p];var z=m.hlHash[p];if(z){y._name=z.name()}}}}}});h.forEach(function(q){if(q){var w=q.getType();if(w===a.NUMERIC_RANGE_TYPE||w===a.DATE_RANGE_TYPE||(w===a.VALUE_TYPE&&!q.hierarchyLevelId)){var m=n[q.getFilteredObjectId()];if(m){q.filteredObjectName=m.ao.name()}}else if(w===a.VALUE_TYPE&&q.hierarchyLevelId){for(var j=0;j<f.length;j++){var x=f[j].hierarchyLevels();if(x){for(var k=0;k<x.length;k++){var t=x[k];if(t&&t.id()===q.hierarchyLevelId){q.filteredObjectName=t.name();break}}}}}}});if(s){var m=n[s.id()];if(m){s.name(m.ao.name());var o=i(s.hierarchyLevels()||[]);for(var p in o){var r=o[p];var t=m.hlHash[p];if(t){r._name=t.name();if(r._analysis&&t._analysis&&r._analysis.id()===t._analysis.id()){r._analysis.name(t._analysis.name())}}}}}S.updateFeeds(v,g);S.updateFilters(v,h);S._updateSliceDimension(v,s);return v};S.defaultIncompletePackage=function(t){var f=G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART);var p;if(t){var g=C.getChartId(t);if(f&&f.hasOwnProperty('specificProperties')){p=u.updateJSON(f.defaultProperties,f.specificProperties[g])}else{p=f?f.defaultProperties:{}}p=V.convertProperties(p,C.getVizType(t),t)}else{p={}}var h=I.getDataset(t);var i;if(C.isTable(t)){i={type:S.TypeConst.RawDataset,val:h}}else{i={type:S.TypeConst.CrosstableDataset,val:h.data()}}return{vizFrame:{version:c.VERSION,chart:{vizInstance:{data:i,properties:p,type:t},vizTitleMode:"auto"},contextMenu:{}}}};S.updateCustomData=function(v,p){S._setValue(v,['customData'],p);return v};S.getCustomData=function(v){return S._getValue(v,['customData'])||{}};S.updateControlSettings=function(v,f,s,g){var t=S._getValue(v,['vizFrame','chart','type']);if(C.supportAnimation(t)&&f==='playControl'){if(s==='slicedData'){S._updateSlicedData(v,g)}else if(s==='sliceDimension'){S._updateSliceDimension(v,g)}else if(s==='value'){S._setValue(v,['vizFrame','playControl','value'],g)}}};S.getControlSettings=function(v,f,s){if(f==='playControl'){if(s==='slicedData'){return S._getSlicedData(v)}else if(s==='sliceDimension'){return S._getSliceDimension(v)}if(s==='value'){return S._getValue(v,['vizFrame','playControl','value'])}}else{return null}};S.getChartType=function(v){return S._getValue(v,['vizFrame','chart','type'])};S.updateCss=function(v,f){S._setValue(v,['vizFrame','chart','vizInstance','css'],f);return v};S._updateSliceDimension=function(v,f){if(u.isArray(f)){return}var g=A.toJSON(f);S._setValue(v,['vizFrame','playControl','sliceDimension'],g)};S._getSliceDimension=function(v){var f=S._getValue(v,['vizFrame','playControl','sliceDimension']);if(f){return A.fromJSON(f)}else{return null}};S._updateSlicedData=function(v,s){var r={};r.measuresInfo=s.measuresInfo;if(u.isArray(s.slices)){r.slices=[];for(var i=0;i<s.slices.length;i++){r.slices.push({data:s.slices[i].data.toJSON(),dimensionMember:s.slices[i].dimensionMember})}}S._setValue(v,['vizFrame','playControl','slicedData'],r)};S._getSlicedData=function(v){var s=S._getValue(v,['vizFrame','playControl','slicedData']);if(s){var r={};r.measuresInfo=s.measuresInfo;r.slices=[];var f=s.slices;if(f){for(var i=0;i<f.length;i++){var g=f[i];r.slices.push({data:sap.viz.api.data.CrosstableDataset.fromJSON(g.data),dimensionMemeber:g.dimensionMemeber})}}return r}else{return null}};S._getValue=function(r,p){if(!r||!p||!p.length){return null}var n=r;for(var i=0;i<p.length;i++){if(!n[p[i]]){return null}n=n[p[i]]}return n};S._setValue=function(r,p,v){if(!r||!p||!p.length){return null}var n=r;for(var i=0;i<p.length-1;i++){if(!n[p[i]]){return}n=n[p[i]]}var l=p[p.length-1];n[l]=v};return S});define('sap/viz/controls/common/utils/Feeds',['sap/viz/controls/common/feeds/FeedUtils',],function(F){var a={feedCompatible:function(f,b,d){return F.feedCompatible(f,b,d)},equal:function(f,b){return F.equal(f,b)}};return a});define('sap/viz/controls/common/views/menu/MenuItem',['require','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(r,u,J){var a=r||a;var M=function(i,n,s){this.__className="sap.viz.controls.common.views.menu.MenuItem";this._id=i;this._name=n;this._enabled=true;this._selected=false;this._subMenuGroups=s};M.prototype.id=function(){return this._id};M.prototype.name=function(){return this._name};M.prototype.icon=function(){return this._icon};M.prototype.subMenuGroups=function(){return this._subMenuGroups};M.prototype.enabled=function(v){if(arguments.length>0){this._enabled=v;return this}else{return this._enabled}};M.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this}else{return this._selected}};M.prototype.equal=function(m){if(m==undefined){return false}if(this.id()!==m.id()){return false}if(this.name()!==m.name()){return false}if(this.enabled()!==m.enabled()){return false}if(this.selected()!==m.selected()){return false}var s=this.subMenuGroups()||[];var b=m.subMenuGroups()||[];if(s.length!==b.length){return false}for(var i=0;i<s.length;i++){var c=s[i];var d=b[i];if(!(c==undefined&&d==undefined)){if(c==undefined){return false}if(!c.equal(d)){return false}}}return true};M.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'subMenuGroups':J.toJSON(J.MenuGroupType,i._subMenuGroups),'enabled':i._enabled,'selected':i._selected}})};M.fromJSON=function(j){return u.fromJSON(j,function(j){var m=new M(j.id,j.name,J.fromJSON(J.MenuGroupType,j.subMenuGroups));m.enabled(j.enabled);m.selected(j.selected);return m})};J.register(J.MenuItemType,M.fromJSON,M.toJSON);return M});define('sap/viz/controls/common/events/Event',[],function(){var E=function(t,a,d){this.__className="sap.viz.controls.common.events.Event";this._type=t;this._target=a;this.data=d};E.prototype.type=function(){return this._type};E.prototype.target=function(){return this._target};return E});define('sap/viz/controls/common/views/feed/FeedListEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedListEvent"};O.extend(F,E);F.DROP_DOWN_OPENED="dropDownOpened";F.DROP_DOWN_CLOSED="dropDownClosed";F.ITEM_SELECTED="itemSelected";return F});define('sap/viz/controls/common/events/FeedEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.events.FeedEvent"};O.extend(F,E);F.FEED_READY="feedReady";F.REQUEST_FEED="requestFeed";F.FEEDS_CHANGED="feedsChanged";return F});define('sap/viz/controls/runtime/Runtime',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function(O,E,a){var R=function(){this._models={};this._modelRefs={}};O.extend(R,a);R.prototype.registerModel=function(u,m){this._models[u]=m;this._modelRefs[u]=1};R.prototype.addModelRef=function(u){this._modelRefs[u]++};R.prototype.removeModelRef=function(u){this._modelRefs[u]--;if(this._modelRefs[u]===0){this._models[u]=null}};R.prototype.getModel=function(u){return this._models[u]};return R});define('sap/viz/controls/runtime/RuntimeManager',['sap/viz/controls/runtime/Runtime'],function(R){var a={};a.getRuntime=function(){var _=window["__viz_controls_runtime"];if(_==null){window["__viz_controls_runtime"]=_=new R();if(Object.defineProperty){}}return _};return a});define('sap/viz/controls/common/services/BVRService',['sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils'],function(F,A,C,U){var B={};B.VERSION='1.0';B.switchFeeds=function(n,c,f){if(!A.needAutoFeeding(f,c,n)){return{'vizType':n,'feeds':f}}if(n&&F.isEmptyFeeds(f)){var e=F.buildEmptyFeeds(n);if(!e.length){}return{'vizType':n,'feeds':e}}var t;if(C.toSingleChartType(U.clone(n))===C.toSingleChartType(U.clone(c))){t=A.directFeeding(f,n)}else{t=A.smartFeeding(f,n)}return{'vizType':n,'feeds':t}};B.suggestFeeds=function(t,a,b,c){var f,d,e;if(arguments.length===2){f=[];d=a}else if(arguments.length>=3){f=a;d=b;e=c}return{'vizType':t,'feeds':A.smartFeeding(f,t,d,e)}};B.suggestChartWithFeeds=function(a){};return B});define('sap/viz/controls/common/helpers/MapLayers',['sap/viz/controls/common/utils/Utils'],function(U){var M={};M.toJSON=function(i){return U.toJSON(i,function(i){return i})};M.fromJSON=function(j){return U.fromJSON(j,function(j){return j})};return M});define('sap/viz/controls/runtime/ModelHandler',['sap/viz/controls/common/utils/ChartTypeUtil'],function(C){var M=function(v){this.__className="sap.viz.controls.runtime.ModelHandler";this._vizModel=v;this._isMNDVisibleChanged=false;this._feedingItemsChanged=false};M.prototype._type=function(v){if(arguments.length>0){this._vizModel._type=v;return this}else{return this._vizModel._type}};M.prototype._feedingItems=function(v){if(arguments.length>0){this._vizModel._feedingItems=v;return this}else{return this._vizModel._feedingItems}};M.prototype._filterItems=function(v){if(arguments.length>0){this._vizModel._filterItems=v;return this}else{return this._vizModel._filterItems}};M.prototype.explicitFeedingItems=function(o){return this._vizModel.feedingItems()};M.prototype.deactive=function(){};M.prototype.postLoad=function(){};M.prototype.feedingItemsChanged=function(v,e){};M.prototype.isMNDVisibleChanged=function(v){};M.prototype._setIsMNDVisible=function(v){};M.prototype.vizModelChanged=function(o){};M.prototype._restorePlayerFieldHistory=function(n){var s=false;if(!C.supportAnimation(n)){var p=this._vizModel.playerField()?this._vizModel.playerField().clone():null;s=this.updatePlayerField(null);if(p){this._vizModel._playerFieldHistory=p}}else{if(!this._vizModel.playerField()){s=this.updatePlayerField(this._vizModel._playerFieldHistory)}}return s};M.prototype.propertiesChanged=function(t,a){};M.prototype.getFilterItems=function(s,i,v,f){};M.prototype.cloneFeeds=function(f){};M.prototype.clone=function(c){};M.prototype.updatePlayerField=function(v){var s=false;if(arguments.length>0){if(v){if(!this._vizModel._playerField||!this._vizModel._playerField.equal(v)){this._vizModel._playerField=v;s=true}}else{if(this._vizModel._playerField){this._vizModel._playerFieldHistory=this._vizModel._playerField=null;s=true}}}return s};return M});define('sap/viz/controls/runtime/InfoModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,u,E,a,C,A,b,c,H,F,d,M,B,e,f,g,h){var I=function(v){I.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.InfoModelHandler"};O.extend(I,h);I.prototype.feedingItemsChanged=function(v,i){this._feedingItems(v||[])};I.prototype.vizModelChanged=function(o){var i=false;var j=this._type();if(o.type){this._type(o.type)}var n=this._type();if(n!==j){this._restorePlayerFieldHistory(n)}var i=false;if(o.feedingItems){i=true;this._feedingItems(o.feedingItems)}var k=false;if(o.filterItems){this._filterItems(o.filterItems);k=true}var l={'vizTypeChanged':j!==n,'feedingItemsChanged':this._feedingItemsChanged||i,'filterChanged':k};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(l)};I.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return}var j={'vizTypeChanged':i};if(j.vizTypeChanged){this._restorePlayerFieldHistory(t)}this._vizModel.dispatchPropertiesChangedEvent(j)};I.prototype.isMNDVisibleChanged=function(v){this._isMNDVisibleChanged=true;this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;this.propertiesChanged(this._type(),false);this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null};I.prototype.getFilterItems=function(s,i,v,j){return g.getFilterItems(s,i,this._filterItems(),this._feedingItems(),v,j)};I.prototype.clone=function(k){var r=k;r._type=this._type();var l=this._feedingItems();if(l&&l.length>0){for(var i=0;i<l.length;i++){r._feedingItems[i]=l[i].clone()}}var m=this._filterItems();if(m&&m.length>0){for(var j=0;j<m.length;j++){r._filterItems[j]=m[j].clone()}}return r};return I});define('sap/viz/controls/runtime/MapModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,u,E,a,C,A,b,c,H,F,d,M,B,e,f,g,h){var k=function(v){k.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.MapModelHandler"};O.extend(k,h);k.prototype.feedingItemsChanged=function(v,n){if(n!==false){var j=[];var l=this._feedingItems();for(var i=0;i<v.length;i++){if(l[i]!==v[i]){if(l[i]&&v[i]&&d.equal(l[i],v[i])){continue}else{j.push(i)}}}this._feedingItems(v);if(j.length>0){this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;var m={'feedingItemsChanged':true,feedsChangedInfo:{items:j}};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(m)}}else{this._feedingItems(v)}};k.prototype.isMNDVisibleChanged=function(v){this._vizModel._feedingItemsHistory=null};k.prototype._setIsMNDVisible=function(v){if(this._vizModel.isMNDVisible()!==v){this._vizModel._isMNDVisible=v;this._isMNDVisibleChanged=true}};k.prototype.vizModelChanged=function(o){var j=false;var s=false;var l=this._type();if(o.type){this._type(o.type)}var n=this._type();if(n!==l){s=this._restorePlayerFieldHistory(n)}else if(o&&(o.playerField!==undefined)){s=this.updatePlayerField(o.playerField)}if(o.feedingItems){var m=this._feedingItems();if(m.length!=o.feedingItems.length){j=true}else{for(var i=0;i<m.length;i++){if(!d.equal(m[i],o.feedingItems[i])){j=true;break}}}if(j){this._vizModel._feedingItemsHistory=null;this._feedingItems(o.feedingItems);this._vizModel.extensionValues({map:{feeding:o.feedingItems}})}}var p=false;if(o.filterItems){this._filterItems(o.filterItems);p=true}var q={'vizTypeChanged':l!==n,'feedingItemsChanged':this._feedingItemsChanged||j,'filterChanged':p};if(s===true){q.sliceDimensionChanged=true}this._type(n);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(q)};k.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return}var n=v;var j={'vizTypeChanged':i||(v!==t)};this._type(n);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(j.vizTypeChanged){var s=this._restorePlayerFieldHistory(n);if(s===true){j.sliceDimensionChanged=true}}this._vizModel.dispatchPropertiesChangedEvent(j)};k.prototype.getFilterItems=function(s,i,v,j){return g.getMapFilterItems(s,i,this._filterItems(),this._feedingItems())};k.prototype.clone=function(l){var r=l;r._type=this._type();var m=this._feedingItems();if(m&&m.length>0){for(var i=0;i<m.length;i++){r._feedingItems[i]=[];for(var n=0;n<m[i].length;n++){r._feedingItems[i][n]=m[i][n].clone()}}}var o=this._filterItems();if(o&&o.length>0){for(var j=0;j<o.length;j++){r._filterItems[j]=o[j].clone()}}return r};return k});define('sap/viz/controls/runtime/VizModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,u,E,a,C,A,b,c,H,F,d,M,B,e,f,g,h){var V=function(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModelHandler"};O.extend(V,h);V.prototype.explicitFeedingItems=function(o){o=o||{};var i=this._feedingItems();var t=this._type();if(!f.isMultipleChart(t)){i=d.removeRowAndColumnFeedItems(i)}var w=o.withMND!=null?o.withMND===true:this._vizModel.isMNDVisible();if(!w){i=d.removeMND(i)}var j=d.buildEmptyFeeds(t);i=d.merge(j,i);return i};V.prototype.deactive=function(){if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=d.cloneFeeds(this._feedingItems())}var p=this._vizModel.playerField();if(p){this._vizModel._playerFieldHistory=p.clone()}};V.prototype.postLoad=function(){var i=this._feedingItems();this._vizModel._feedingItemsHistory=d.cloneFeeds(i);this._vizModel._playerFieldHistory=this._vizModel.playerField()?this._vizModel.playerField().clone():null;var t=this._type();var j=d.hasMND(i);this._vizModel._isMNDVisible=j;if(!j){var n=_(t,i,j);this._feedingItems(n.feeds)}};V.prototype.feedingItemsChanged=function(v,i){var j=this._vizModel.extensionValues();i=j.feedingPanel?j.feedingPanel.enableTrellis:i;if(i===false){v=d.removeRowAndColumnFeedItems(v)}this._setIsMNDVisible(d.hasMND(v));this._feedingItemsChanged=!d.equal(v,this._feedingItems());if(this._feedingItemsChanged){this._feedingItems(v||[]);this._vizModel._feedingItemsHistory=null;var n=d.hasRowOrColumn(this._feedingItems());var o=this._type();var p;if(n&&!f.isMultipleChart(o)){p=f.toMultiChartType(o);this._vizModel.type(p)}else if(!n&&f.isMultipleChart(o)){p=f.toSingleChartType(o);this._vizModel.type(p)}else{this.propertiesChanged(o,false)}this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null}};V.prototype.isMNDVisibleChanged=function(v){this._isMNDVisibleChanged=true;this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;this.propertiesChanged(this._type(),false);this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null};V.prototype._setIsMNDVisible=function(v){var i=(v===true);if(this._vizModel.isMNDVisible()!==i){this._vizModel._isMNDVisible=i;this._isMNDVisibleChanged=true}};V.prototype.vizModelChanged=function(o){var i=false;var s=false;if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=d.cloneFeeds(this._feedingItems())}var j=this._vizModel.isMNDVisible();var n=this._type();if(o.type){this._type(o.type)}var p=this._type();if(p!==n){s=this._restorePlayerFieldHistory(p)}else if(o&&(o.playerField!==undefined)){s=this.updatePlayerField(o.playerField)}var q;if(o.feedingItems){if(d.supportMND(p)){j=d.hasMND(o.feedingItems);this._setIsMNDVisible(j)}if(d.match(p,o.feedingItems,false)){q=_(p,o.feedingItems,j);p=q.vizType;o.feedingItems=q.feeds}var r=i=!d.equal(this._feedingItems(),o.feedingItems,{ignoreActions:true});if(r){this._vizModel._feedingItemsHistory=d.cloneFeeds(o.feedingItems);this._feedingItems(o.feedingItems)}else{i=!d.equal(this._feedingItems(),o.feedingItems);if(i){this._feedingItems(o.feedingItems)}}}var t=this._vizModel._feedingItemsHistory;j=this._vizModel.isMNDVisible();p=m(p,t,j);if(!i){var v;if(p!==n){v=B.switchFeeds(p,n,t).feeds;q=_(p,v,j);p=q.vizType;v=q.feeds}if(v){this._feedingItems(v);if(d.isEmptyFeeds(this._feedingItems())&&d.isEmptyFeeds(v)){i=false}else{i=!d.isFeedDefinitionEqual(n,p)||!d.equal(this._feedingItems(),v)}}}var w=false;if(o.filterItems){this._filterItems(o.filterItems);w=true}var x={'vizTypeChanged':n!==p,'feedingItemsChanged':this._feedingItemsChanged||i,'filterChanged':w};if(s===true){x.sliceDimensionChanged=true}this._type(p);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(x)};V.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return}var j=this._feedingItems();if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=d.cloneFeeds(j)}if(t!=="viz/number"){this._saveSubtotals(j,this._vizModel)}var n=v;var o=t;var p=this._vizModel._feedingItemsHistory;var q=this._vizModel.isMNDVisible();n=m(n,p,q);var r;if(d.match(n,p,false)){r=_(n,p,q);n=r.vizType;p=r.feeds}var s=B.switchFeeds(n,o,p).feeds;r=_(n,s,q);n=r.vizType;s=r.feeds;var w=true;if(d.isEmptyFeeds(j)&&d.isEmptyFeeds(s)){w=false}else{w=!d.isFeedDefinitionEqual(o,n)||!d.equal(j,s)}var x={'vizTypeChanged':i||(o!==n),'feedingItemsChanged':this._feedingItemsChanged||w,'isMNDVisibleChanged':this._isMNDVisibleChanged};this._type(n);this._feedingItems(s);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(x.vizTypeChanged){var y=this._restorePlayerFieldHistory(n);if(y===true){x.sliceDimensionChanged=true}}this._vizModel.dispatchPropertiesChangedEvent(x)};V.prototype._saveSubtotals=function(j,n){var o=[];var p=false;var q=false;for(var i=0;i<j.length;i++){if(j[i].type()==="calculation"){n.savedSubtotals(j[i])}if(n.savedSubtotals()!==null&&j[i].type()==="Dimension"){p=true;for(var v=0;v<j[i].values().length;v++){for(var s=0;s<n.savedSubtotals().values().length;s++){if(j[i].values()[v].id()===n.savedSubtotals().values()[s].aggregationTarget()){o.push(n.savedSubtotals().values()[s]);q=true}}}}}if((p===false||q===false)&&n.savedSubtotals()!==null){n.savedSubtotals().values([])}if(n.savedSubtotals()!==null&&o[0]){n.savedSubtotals().values(o);var r=false;for(var i=0;i<n.feedingItemsHistory().length;i++){if(n.feedingItemsHistory()[i].type()==="calculation"){var t=n.savedSubtotals();n.feedingItemsHistory()[i]=t;r=true}}if(r===false){n.feedingItemsHistory().push(n.savedSubtotals())}}};V.prototype.getFilterItems=function(s,i,v,j){return g.getFilterItems(s,i,this._filterItems(),this._feedingItems(),v,j)};V.prototype.clone=function(n){var r=n;r._type=this._type();var o=this._feedingItems();if(o&&o.length>0){for(var i=0;i<o.length;i++){r._feedingItems[i]=o[i].clone()}}var p=this._filterItems();if(p&&p.length>0){for(var j=0;j<p.length;j++){r._filterItems[j]=p[j].clone()}}return r};function k(t,i){var j=f;if(j.supportMultiChart(t)){if(d.hasRowOrColumn(i)){return j.toMultiChartType(t)}else{return j.toSingleChartType(t)}}else{return t}}function l(t){var i=f;if(i.supportMultiChart(t)){var j=i.toMultiChartType(t);if(t!==j&&!d.supportMND(t)&&d.supportMND(j)){return j}else{return t}}else{return t}}function m(t,i,j){var n=k(t,i);if(j){n=l(n)}return n}function _(t,i,j){if(j){t=l(t);if(!d.hasMND(i)){i=c.directFeeding(i,t,[A.genMND()])}}else{i=d.removeMND(i);t=k(t,i);if(!d.isEmptyFeeds(i)){if(!d.meetMinDimensions(t,i)){i=c.directFeeding(i,t,[A.genMND()])}}}if(d.countAnalyses(i,b.MEASURE)===0){i=d.removeMND(i)}t=k(t,i);return{'vizType':t,'feeds':i}}return V});define('sap/viz/controls/runtime/VizModel',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/runtime/InfoModelHandler','sap/viz/controls/runtime/MapModelHandler','sap/viz/controls/runtime/VizModelHandler'],function(O,u,E,a,C,B,b,I,M,V){var c=function(){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModel";this._type=null;this._isMNDVisible=false;this._feedingItems=[];this._feedingItemsHistory=null;this._savedSubtotals=null;this._filterItems=[];this._playerFieldHistory=null;this._playerField=null;this._extensionValues={};this._handler=this._vizModelHandler=new V(this)};O.extend(c,a);c.PropertiesChangedEvent='propertiesChangedEvent';c.VizModelResetEvent='vizModelResetEvent';c.prototype._updateHandler=function(t){var n=this._vizModelHandler;if(C.TYPE_GEO_MAP===t){if(!this._mapModelHandler){this._mapModelHandler=new M(this)}n=this._mapModelHandler}else if(b.isInfoChart(t)){if(!this._infoModelHandler){this._infoModelHandler=new I(this)}n=this._infoModelHandler}if(n!==this._handler){this._handler.deactive();this._handler=n;this._feedingItems=[]}};c.prototype.load=function(o){if(!o){return}this.reset();var t=false;var f=false;var i=false;if(o.type&&o.type!==this._type){this._type=o.type;this._updateHandler(this._type);t=true}if(o.feedingItems){this._feedingItems=o.feedingItems;f=true}else{this._feedingItems=[]}var d=this._isMNDVisible;this._handler.postLoad();i=(d!==this._isMNDVisible);if(t||f){var e={'vizTypeChanged':t,'isMNDVisibleChanged':i,'feedingItemsChanged':f,};this.dispatchPropertiesChangedEvent(e)}};c.prototype.filterItems=function(v){if(arguments.length>0){this._filterItems=v;var d={filterChanged:true};var f=new E(c.PropertiesChangedEvent,this,d);this._dispatchEvent(f);return this}else{return this._filterItems}};c.prototype.explicitFeedingItems=function(o){return this._handler.explicitFeedingItems(o)};c.prototype.feedingItems=function(v,e){if(arguments.length>0){this._handler.feedingItemsChanged(v,e);return this}else{return this._feedingItems.slice(0)}};c.prototype.savedSubtotals=function(v){if(arguments.length>0){this._savedSubtotals=v;return this}else{return this._savedSubtotals}};c.prototype.feedingItemsHistory=function(v){if(arguments.length>0){this._feedingItemsHistory=v;return this}else{return this._feedingItemsHistory}};c.prototype.type=function(v){if(arguments.length>0){if(this._type!==v){var o=this._type;this._type=v;this._updateHandler(this._type);this._handler.propertiesChanged(o,true)}return this}else{return this._type}};c.prototype.restorePlayerField=function(v){return this._handler.updatePlayerField(v)};c.prototype.playerField=function(v){if(arguments.length>0){var d;var s=this._handler.updatePlayerField(v);if(s===true){d={'sliceDimensionChanged':true};this.dispatchPropertiesChangedEvent(d)}return this}else{return this._playerField}};c.prototype.isMNDVisible=function(v){if(arguments.length>0){var d=(v===true);if(this._isMNDVisible!==d){this._isMNDVisible=d;this._handler.isMNDVisibleChanged()}return this}else{return this._isMNDVisible}};c.prototype.vizModelChanged=function(o){if(o.type){this._updateHandler(o.type)}this._handler.vizModelChanged(o)};c.prototype.updateFilterItems=function(s,i,v,f){var n=this._handler.getFilterItems(s,i,v,f);this.filterItems(n)};c.prototype.clone=function(){var r=new c();this._handler.clone(r);return r};c.prototype.extensionValues=function(e){if(arguments.length>0){var d={};if(e){if(this._extensionValues!==e){this._extensionValues=e;d={'extensionValuesChanged':true}}}var f=new E(c.PropertiesChangedEvent,this,d);this._dispatchEvent(f);return this}else{return this._extensionValues}};c.prototype.dispatchPropertiesChangedEvent=function(d){var p=new E(c.PropertiesChangedEvent,this,d);this._dispatchEvent(p)};c.prototype.reset=function(){var d={'vizModelReset':true};var v=new E(c.VizModelResetEvent,this,d);this._dispatchEvent(v)};c.prototype.dispatchEvent=function(e){this._dispatchEvent(e)};return c});define('sap/viz/controls/common/ProxyBase',[],function(){var P=function P(c){this.__className="sap.viz.controls.runtime.ProxyBase";this.__client=c};P.prototype._client=function(){return this.__client};P.prototype.updateClient=function(c){this.__client=c};return P});define('sap/viz/controls/runtime/VizProxy',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/ProxyBase','sap/viz/controls/common/events/Event'],function($,O,P,E){var V=function V(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizProxy"};O.extend(V,P);V.VizProxyEvent='VizProxy.VizProxyEvent';V.GetTitleZoneOperation='getTitleZoneOperation';V.GetTitleTextOperation='getTitleTextOperation';V.SetTitleTextOperation='setTitleTextOperation';V.GetTitleTextByFeedingOperation='getTitleTextByFeedingOperation';V.RestoreTitleTextOperation='restoreTitleTextOperation';V.IsFakeChartOperation='isFakeChartOperation';V.IsTitleCustomizedOperation='isTitleCustomizedOperation';V.GetPropertiesOperation='getPropertiesOperation';V.SetPropertiesOperation='setPropertiesOperation';V.SetDatasetOperation='SetDatasetOperation';V.GetSelectionOperation='getSelectionOperation';V.SetTitleModeOperation='setTitleModeOperation';V.GetPropertyZonesOperation='getPropertyZonesOperation';V.SetPropertyZonesOperation='setPropertyZonesOperation';V.GetDatasetOperation='GetDatasetOperation';V.QueryPropertiesOperation='queryPropertiesOperation';V.UpdatePropertiesOperation='updatePropertiesOperation';V.AddEventListenerOperation='addEventListenerOperation';V.RemoveEventListenerOperation='removeEventListenerOperation';V.SetAxisScaleOperation='setAxisScaleOperation';V.GetTypeOperation='getTypeOperation';V.GetDataPointsPosition='getDataPointsPosition';V.OnOperation='onOperation';V.OffOperation='offOperation';V.GetSizeOperation='getSizeOperation';V.SetSizeOperation='setSizeOperation';V.GetVizFeedingOperation='getVizFeedingOperation';V.prototype._model=function(){return this._client()};V.prototype._doOperation=function(o,d){d=d||{};d.operation=o;var e=new E(V.VizProxyEvent,this._model(),d);this._model().dispatchEvent(e);return e.data.result};V.prototype.getTitleZone=function(){return this._doOperation(V.GetTitleZoneOperation)};V.prototype.getTitleText=function(){return this._doOperation(V.GetTitleTextOperation)};V.prototype.setTitleText=function(t){var d={args:arguments};this._doOperation(V.SetTitleTextOperation,d)};V.prototype.getTitleTextByFeeding=function(){return this._doOperation(V.GetTitleTextByFeedingOperation)};V.prototype.restoreTitleText=function(){this._doOperation(V.RestoreTitleTextOperation)};V.prototype.SetDataset=function(d){var a={args:arguments};this._doOperation(V.SetDatasetOperation,a)};V.prototype.setTitleMode=function(m){var d={args:arguments};this._doOperation(V.SetTitleModeOperation,d)};V.prototype.isFakeChart=function(){return this._doOperation(V.IsFakeChartOperation)};V.prototype.isTitleCustomized=function(){return this._doOperation(V.IsTitleCustomizedOperation)};V.prototype.getProperties=function(){return this._doOperation(V.GetPropertiesOperation)};V.prototype.setProperties=function(n){var d={args:arguments};this._doOperation(V.SetPropertiesOperation,d)};V.prototype.getSelection=function(){return this._doOperation(V.GetSelectionOperation)};V.prototype.getType=function(){return this._doOperation(V.GetTypeOperation)};V.prototype.getPropertyZones=function(){return this._doOperation(V.GetPropertyZonesOperation)};V.prototype.setPropertyZones=function(p){var d={args:arguments};this._doOperation(V.SetPropertyZonesOperation,d)};V.prototype.queryProperties=function(o){var d={args:arguments};return this._doOperation(V.QueryPropertiesOperation,d)};V.prototype.updateProperties=function(o){var d={args:arguments};this._doOperation(V.UpdatePropertiesOperation,d)};V.prototype.getDataset=function(){return this._doOperation(V.GetDatasetOperation)};V.prototype.setAxisScale=function(a){var d={args:arguments};return this._doOperation(V.SetAxisScaleOperation,d)};V.prototype.addEventListener=function(t,l,s,p){var d={args:arguments};this._doOperation(V.AddEventListenerOperation,d)};V.prototype.removeEventListener=function(t,l,s){var d={args:arguments};this._doOperation(V.RemoveEventListenerOperation,d)};V.prototype.getDataPointsPosition=function(d){var a={args:arguments};return this._doOperation(V.GetDataPointsPosition,a)};V.prototype.on=function(e,c){this._doOperation(V.OnOperation,{'args':arguments})};V.prototype.off=function(e){this._doOperation(V.OffOperation,{'args':arguments})};V.prototype.getSize=function(){return this._doOperation(V.GetSizeOperation)};V.prototype.setSize=function(s){var d={args:arguments};this._doOperation(V.SetSizeOperation,d)};V.prototype.getVizFeeding=function(){return this._doOperation(V.GetVizFeedingOperation)};return V});define('sap/viz/controls/common/VizControlBase',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/UIControl','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/runtime/VizProxy'],function(O,E,U,R,V,a){var b=function b(d,u,p){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlBase";sap.viz.base.utils.log.Analyzer.pnrContext('sap.viz.controls performance log context');this._vizUid=null;if(p){this._parent=p;this.__vizModel=p._vizModel()}else{this.__vizModel=this._createModel()}this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel.addEventListener(V.VizModelResetEvent,this._onVizModelReset,this);this._updatingProperty=0;this.__vizProxy=new a(this.__vizModel)};O.extend(b,U);b.prototype.connect=function(v){if(this._vizUid===v){return}this._vizUid=v;var r=R.getRuntime();var m=r.getModel(v);var c=false;if(!m){r.registerModel(v,this.__vizModel)}else{if(this.__vizModel!==m){c=true;this.__vizModel.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel.removeEventListener(V.VizModelResetEvent,this._onVizModelReset,this);this.__vizModel=m;this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel.addEventListener(V.VizModelResetEvent,this._onVizModelReset,this)}r.addModelRef(v)}this._onConnect(v,c)};b.prototype._vizModel=function(){return this.__vizModel};b.prototype._vizProxy=function(){return this.__vizProxy};b.prototype._onVizModelChanged=function(e){};b.prototype._onVizModelReset=function(e){};b.prototype._createModel=function(){return new V()};b.prototype._onConnect=function(v,m){this._vizProxy().updateClient(this.__vizModel)};b.prototype._onDisconnect=function(){};b.prototype._onAfterDisconnect=function(){};b.prototype.disconnect=function(){this._removeSharedModel(true)};b.prototype._removeSharedModel=function(n){var v=this._vizUid;if(v){var m=R.getRuntime().getModel(v);if(m){if(n){this._onDisconnect()}m.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);m.removeEventListener(V.VizModelResetEvent,this._onVizModelReset,this);this.__vizModel=m.clone();this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel.addEventListener(V.VizModelResetEvent,this._onVizModelReset,this);R.getRuntime().removeModelRef(v)}if(n){this._onAfterDisconnect()}this._vizUid=null}};b.prototype.destroy=function(){this._removeSharedModel(false);b.superclass.destroy.apply(this,arguments)};b.prototype._beginUpdateProperty=function(){this._updatingProperty++};b.prototype._inUpdatingProperty=function(){return this._updatingProperty>0};b.prototype._endUpdateProperty=function(){this._updatingProperty--};b.prototype._dispatchPropertyEvent=function(e){if(!this._updatingProperty){b.superclass._dispatchEvent.apply(this,arguments)}};b.prototype._dispatchEvent=function(e){if(!e.data){e.data={}}e.data.token=this._vizUid;b.superclass._dispatchEvent.apply(this,arguments)};b.prototype.save=function(){return{}};b.prototype.load=function(v){};return b});define('sap/viz/controls/common/constants/EventTypeConst',[],function(){var E={};E.VC_CHANGE_VIZ_TYPE="vc-changeVizType";E.PRESS_FILTER_BUTTON="vc-filter";E.PRESS_EXCLUDE_BUTTON="vc-exclude";E.PRESS_DRILLDOWN_BUTTON="vc-drillDown";E.SELECT_SHOW_LEGEND="vc-showLegend";E.SELECT_SHOW_DATALABELS="vc-showDataLabels";E.SELECT_CHANGE_DIRECTION="vc-changeDirection";E.SELECT_CHANGE_STACKING="vc-changeStacking";E.SELECT_INSERT_COMMENT="vc-insertComment";E.SELECT_CHART_EDITOR="vc-chartEditor";E.SHOW_MESSAGE="vc-showMessage";E.CLEAR_MESSAGE="vc-clearMessage";E.VIZ_DEFINITION_CHANGED='vizDefinitionChanged';E.REQUEST_FILTER_VALUES='requestFilterValues';return E});define('sap/viz/controls/annotation/AnnotationConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var A={};A.instance=function(){return{}};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATION,A);return A});define('sap/viz/controls/annotation/AnnotationEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var A=function(t,a,d){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.AnnotationEvent"};O.extend(A,E);A.COMMENT_CHANGED_EVENT="commentChanged";return A});define('sap/viz/controls/annotation/views/DialogEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var D=function(t,a,d){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.DialogEvent"};O.extend(D,E);D.OK="OK";D.Cancel="Cancel";return D});define('sap/viz/controls/annotation/views/ConfirmDialog',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(O,U,C,L,D,$){var a=function(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.ConfirmDialog";this._confirmDialog$=null;this._needConfirm=true;this._visible=false;this._createChildren()};O.extend(a,U);a.prototype._createChildren=function(){var _=this;this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(C.ANNOTATION_PREFIX+'confirmdialog');var d=$(document.createElement('div'));d.addClass(C.ANNOTATION_PREFIX+'confirmdialog-header');this._confirmDialog$.append(d);var b=$(document.createElement('span'));b.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft');d.append(b);var c=$(document.createElement('span'));c.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft-label');b.append(c);var e=$(document.createElement('span'));e.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright');d.append(e);var f=$(document.createElement('a'));f.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright-close');e.append(f);f.click(function(){_.hide()});var g=$(document.createElement('div'));g.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content');this._confirmDialog$.append(g);var h=$(document.createElement('div'));h.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-up');h.appendTo(g);var i=$(document.createElement('div'));i.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-icon');i.appendTo(h);var j=$(document.createElement('div'));j.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-info');j.text(L.get("VIZ_COMMON_DELETE_COMMENT_MESSAGE"));j.appendTo(h);var k=$(document.createElement('div'));k.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-down');k.appendTo(g);this._checkBoxNeedConfirm$=$(document.createElement("input"));this._checkBoxNeedConfirm$.attr("type","checkbox");this._checkBoxNeedConfirm$.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkbox');this._checkBoxNeedConfirm$.appendTo(k);var l=$(document.createElement('div'));l.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkboxlabel');l.text(L.get("VIZ_COMMON_DONT_SHOW_MESSAGE"));l.appendTo(k);var m=$(document.createElement('div'));m.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer');this._confirmDialog$.append(m);var n=$(document.createElement('div'));n.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-buttons');m.append(n);var o=$(document.createElement('button'));o.text(L.get("VIZ_COMMON_OK"));o.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');o.addClass(C.COMMON_PREFIX+'button');n.append(o);o.click(function(){_.hide();_._needConfirm=!(_._checkBoxNeedConfirm$.prop("checked"));_._dispatchEvent(new D(D.OK,_,_._needConfirm))});var p=$(document.createElement('button'));p.text(L.get("VIZ_COMMON_CANCEL"));p.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');p.addClass(C.COMMON_PREFIX+'button');n.append(p);p.click(function(){_.hide()});this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(C.ANNOTATION_PREFIX+'block-layer')};a.prototype.show=function(p){this._visible=true;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);if(p){this.setPos(p)}};a.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};a.prototype.setPos=function(p){this._confirmDialog$.css({position:"absolute",left:p.pageX-this._confirmDialog$.width()/2,top:p.pageY-this._confirmDialog$.height()/2})};a.prototype.isVisible=function(){return this._visible};return a});define('sap/viz/controls/annotation/models/Comment',['sap/viz/controls/common/managers/LangManager'],function(L){var C=function(d,a,s){this._dimension=d;this._dimension2=a;this._series=s;this._text='';this._createTime=L.get("VIZ_ANNOTATION_COMMENT")};C.prototype.dimension=function(v){if(arguments.length>0){this._dimension=v;return this}else{return this._dimension}};C.prototype.dimension2=function(v){if(arguments.length>0){this._dimension2=v;return this}else{return this._dimension2}};C.prototype.series=function(v){if(arguments.length>0){this._series=v;return this}else{return this._series}};C.prototype.createTime=function(v){if(arguments.length>0){this._createTime=v;return this}else{return this._createTime}};C.prototype.text=function(v){if(arguments.length>0){this._text=v;return this}else{return this._text}};return C});define('sap/viz/controls/annotation/views/Comments',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/ConfirmDialog','sap/viz/controls/annotation/models/Comment'],function($,C,a,O,b,U,V,E,c,D,d,f){var F='#F1AB00';var T=12;var L=4;var M=200;var I=8;var g={width:14,height:16};var h="font-family:Arial;font-size:12px;font-weight:bold;fill:#000000;";var k="font-family:Arial;font-size:12px;font-weight:normal;fill:#000000;";var l=function(){this._commentsMap={};this._commentsPositionMap={};this._vizData=null;this._vizType=null;this._eventHandlers={};this._needConfirm=true;this._currentComment=null};O.extend(l,c);l.Event_EditComment='Event_EditComment';l.Event_RemoveComment='Event_RemoveComment';l.Event_DragComment='Event_DragComment';l.prototype._showConfirmDialog=function(){this._getConfirmDialog().show({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2})};l.prototype._getConfirmDialog=function(){if(!this._confirmDialog){this._confirmDialog=new d();this._confirmDialog.addEventListener(D.OK,this._confirmChangedHandler,this)}return this._confirmDialog};l.prototype._confirmChangedHandler=function(e){this._needConfirm=e.data;this._onRemoveComment(this._currentComment)};l.prototype.assetFolder=function(e){if(arguments.length>0){this._assetFolder=e;return this}else{return this._assetFolder}};l.prototype.setChartInfo=function(e){if(arguments.length>0){this._vizData=e.vizData;this._vizType=e.vizType;return this}else{return this._vizData}};l.prototype.feedsChanged=function(){this._commentsPositionMap={}};l.prototype._initDIV=function(){if(this._parent){this._parent.empty()}else{var e=document.createElement("DIV");this._parent=$(e);this._chartHolderDiv=$('div.'+C.PREFIX+'chart-holder')[0];this._parent.appendTo(this._chartHolderDiv).attr('id',"comments-parent");this._parent.attr('style','overflow:hidden;position:absolute;pointer-events:none;left:0px;top:0px;')}this._triangleHolder=null;this._lineHolder=null};l.prototype.redraw=function(){this._initDIV();var e=b.getVizType(this._vizType);if(!A.supportType[e]||V.hasFakeData(this._vizData)){return}for(var i in this._commentsMap){if(this._commentsMap.hasOwnProperty(i)){this._drawComment(i)}}};l.prototype.clean=function(){this._initDIV()};l.prototype._getPathInfo=function(e,j){var x=e.dii_a1;var y=e.mi;var z=j._crosstableDataset;var B=z.getAnalysisAxisByIdx(0);var G=null;if(B){G='';B=B.getDimensionLabels();for(var i=0;i<B.length;i++){G+=B[i].getValues()[x]}}else{G=z.getMeasureValuesGroupByIdx(0).getMeasureValues()[x].getId()}var H=z.getAnalysisAxisByIdx(1);var J=null;if(H){J='';H=H.getDimensionLabels();for(var n=0;n<H.length;n++){J+=H[n].getValues()[e.dii_a2]}}var K={dimensionIndex:x,seriesIndex:y,dimension:G,dimension2:J};K.series=z.getMeasureValuesGroupByIdx(e.mg).getMeasureValues()[y].getId();return K};l.prototype._findDataPoint=function(e){var n=d3.selectAll('.v-datapoint')[0];var x=e.dimension();var y=e.dimension2();var z=e.series();for(var i=0;i<n.length;i++){var B=n[i].__data__;if(B){var G;if(U.isArray(B.ctx)){G=this._getPathInfo(B.ctx[0].path,this._vizData);if(G.dimension===x&&G.dimension2===y&&G.series==z){return n[i]}}else if(b.getVizType(this._vizType)===a.TYPE_BOXPLOT){for(var j=0;j<B.length;j++){G=this._getPathInfo(B[j].ctx.path,this._vizData);if(G.dimension===x&&G.dimension2===y&&G.series==z){return n[i]}}}else if(B.ctx){G=this._getPathInfo(B.ctx.path,this._vizData);if(G.dimension===x&&G.dimension2===y&&G.series==z){return n[i]}}}}};function m(e){var i=e.__data__;if(i&&i.r&&i.midAngle){var j=i.midAngle();var x=i.r*Math.sin(j);var y=i.r-i.r*Math.cos(j);var n=$(e).parentsUntil('.v-m-plot');if(n.length>0){var z=$(n[n.length-1]).parent()[0];var B=z.getElementsByTagName('rect');var G=B[0].getAttribute('height');var H=B[0].getAttribute('width');var J=z.getBoundingClientRect();var K=J.left+H/2;var N=J.top+6+i.r;var P={width:1,height:1,top:N-i.r+y,left:K+x};return P}else{return e.getBoundingClientRect()}}else{return e.getBoundingClientRect()}}function o(e){var i=e.dimension()+"-"+e.dimension2()+"-"+e.series();i=i.replace(/[^(0-9|A-z)]/g,"_");return i}function p(e){return e+'-line'}function q(e){return e+'-triangle'}function r(e){var i=e.currentTarget.parentNode.__data;if(e.data&&i){if(e.data._needConfirm){e.data._currentComment=i;e.data._showConfirmDialog()}else{e.data._onRemoveComment(i)}}e.stopPropagation()}function s(e){var i=e.currentTarget.parentNode.__data;if(e.data&&i){e.data._onEditComment(i)}e.stopPropagation()}function t(e){var i=e.target;if(i&&i.className!=='ui-draggable'){var j=$(i).parentsUntil(e.data._parent);if(j&&j.length>0){i=j[j.length-1]}}if(e.data&&i&&i.className==='ui-draggable'){$(i).detach();$(i).appendTo(e.data._parent)}e.stopPropagation()}function u(e,i,j,n,x){var y={x:e.left,y:e.top+e.height/2};var z={x:i.left+i.width/2,y:i.top};var B=y.x-z.x;var G=y.y-z.y;var H=Math.sqrt(B*B+G*G);var J=Math.asin(G/H)*180/Math.PI;if(y.x<z.x){J=180-J}var K='rotate('+J+'deg)';var N="0 0";n.css({'transform':K,'transform-origin':N,'-webkit-transform':K,'-webkit-transform-origin':N,'-ms-transform':K,'-ms-transform-origin':N,'-moz-transform':K,'-moz-transform-origin':N,width:Math.floor(H)-L+'px',left:(z.x-j.left)+'px',top:z.y-j.top+'px'});K='rotate('+(J+90)+'deg)';N="50% 100%";x.css({'transform':K,'transform-origin':N,'-webkit-transform':K,'-webkit-transform-origin':N,'-ms-transform':K,'-ms-transform-origin':N,'-moz-transform':K,'-moz-transform-origin':N,left:(z.x-j.left-T/2)+'px',top:(z.y-j.top-T)+'px'})}function v(e,i){var j='height:0px;width:0px;margin:0px;padding:0px;';j+='border-top-width:'+e+'px;border-left-width: '+i/2+'px;border-right-width: '+i/2+'px;';j+='border-bottom-width: 0px;border-style: solid;border-color: '+F+' transparent transparent transparent;';return j}l.prototype._initCommentUI=function(i,j,n){var x=m(i);var y=this._parent[0].getBoundingClientRect();var z=0;var B=0;var G=j.attr('id');if(this._commentsPositionMap.hasOwnProperty(G)&&this._commentsPositionMap[G].hasOwnProperty(this._vizType)){z=this._commentsPositionMap[G][this._vizType].left;B=this._commentsPositionMap[G][this._vizType].top}else{z=0;B=x.top-y.top-80;var H=i.__data__;if(H&&H.r&&H.midAngle&&Math.sin(H.midAngle())<0){z=x.left-Math.max(x.width,40)-y.left-150}else{z=x.left+Math.max(x.width,40)-y.left}}var J="pointer-events:auto;";J+="padding:4px;background-color:#FFFFCC;";J+='border-radius:4px;border-width:2px; border-color:'+F+'; border-style:solid;';J+="position:absolute;left: "+z+"px; top:"+B+"px;";J+="width:"+M+"px;";j.attr('style',J);j.bind('mouseenter',function(e){var G=$(e.currentTarget).attr('id');var K=$('div#'+G+' img');K.css('visibility','');var N=$('div#'+G+' div#'+'createTime');if(N){N.css('right','68px')}});j.bind('mouseleave',function(e){var G=$(e.currentTarget).attr('id');var K=$('div#'+G+' img');K.css('visibility','hidden');var N=$('div#'+G+' div#'+'createTime');if(N){N.css('right','18px')}});j.bind('contextmenu',function(e){e.stopPropagation()});if(z+j.outerWidth()>this._parent.innerWidth()){z=this._parent.innerWidth()-j.outerWidth()}if(B+j.outerHeight()>this._parent.innerHeight()){z=this._parent.innerHeight()-j.outerHeight()}j.css({left:z+'px',top:B+'px'})};l.prototype._addCommentUI=function(e,j,n){var x=I;for(var i=0;i<n.length;i++){var y=$(document.createElement("DIV")).appendTo(j).attr('style','position:absolute;padding:'+I+'px;left:0px;right:0px;top:'+x+'px;width:'+M+'px;height:auto;');var z=this._appendItem(y,n[i]);y.css('height',z+'px');x+=z+I;y[0].__data=n[i]}x-=I;j.css('height',x+'px');var B=m(e);var G=this._parent[0].getBoundingClientRect();var H=Number(j.css("left").replace('px',''));var J=Number(j.css("top").replace('px',''));H=Math.min(Math.max(H,0),G.width-M);J=Math.min(Math.max(J,0),G.height-x);j.css({left:H,top:J});var K=j[0].getBoundingClientRect();j[0].__dataPoint=e;j[0].__parent=this._parent[0];var N=j.attr('id');var P=q(N);var Q=$('#'+P);if(Q.length===0){Q=$(document.createElement("DIV"));if(this._triangleHolder){Q.insertAfter(this._triangleHolder)}else{Q.insertBefore(j)}this._triangleHolder=Q;Q.attr('id',P).attr('style','position:absolute;'+v(T,T))}var R=p(N);var S=$('#'+R);if(S.length===0){S=$(document.createElement("DIV"));if(this._lineHolder){S.insertAfter(this._lineHolder)}else{S.insertBefore(j)}this._lineHolder=S;S.attr('id',R).attr('style','position:absolute;border-left-width:'+L+'px; border-top-width:2px;border-bottom-width:0px;border-right-width:0px;border-color:'+F+' transparent; border-style:solid;width:1px;height:0px;')}u(K,B,G,S,Q)};l.prototype._appendItem=function(e,i){var _=this;var j=null;var n=false;var x=0;var y=$(document.createElement("IMG")).appendTo(e);y.attr('src',this._assetFolder+'/edit.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*3+g.width)+'px;width:'+g.width+'px;height:'+g.height+'px;visibility:hidden;');y.bind('mousedown',this,s);var z=y[0].getBoundingClientRect();var B=$(document.createElement("IMG")).appendTo(e);B.attr('src',this._assetFolder+'/delete.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*2)+'px;width:'+g.width+'px;height:'+g.height+'px;visibility:hidden;');B.bind('mousedown',this,r);var G=B[0].getBoundingClientRect();var H=this._creatorDiv=$(document.createElement("DIV")).appendTo(e);H.attr('id','createTime');H.text(i.createTime()).attr('style','position:absolute;cursor:default;line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;left:5px;right:18px;top:0px;'+h);H.mouseover(function(N){if(H[0].scrollWidth>H[0].clientWidth){n=true;var P=setTimeout(function(){if(n){if(!j){j=$(document.createElement('div')).appendTo(e);j.attr('style','position:absolute;border-radius:4px;z-index:100;display:block;background-color:#F2F2F2;border:1px solid #7F7F7F;box-shadow:5px 5px 10px rgba(0,0,0,0.5);-webkit-box-shadow:5px 5px 10px rgba(0,0,0,0.5);-moz-box-shadow:5px 5px 10px rgba(0,0,0,0.5);');var Q=$(document.createElement('span')).appendTo(j);Q.attr('style','border-radius:4px;padding-left:4px;padding-right:4px;display:block;font-size:10px;white-space:nowrap;top:0px;overflow:hidden;');Q.text(i.createTime())}var R=$(H).offset();j.offset({'left':R.left-5,'top':R.top-10})}},500)}});H.mouseout(function(N){if(H[0].scrollWidth>H[0].clientWidth){n=false;if(j){j.remove();j=null}}});var J=H[0].getBoundingClientRect();x+=Math.max(z.height,J.height);var K=$(document.createElement("DIV"));K[0].innerHTML=i.text();K.attr('style','position:absolute;pointer-events:none;line-height:normal;word-wrap:break-word;overflow:hidden;top:'+x+'px;width:'+M+'px;'+k).appendTo(e);x+=K[0].getBoundingClientRect().height;return x};l.prototype._removeCommentUI=function(i){var e=p(i);var j=q(i);if(this._triangleHolder&&this._triangleHolder.attr('id')===j){this._triangleHolder=null}if(this._lineHolder&&this._lineHolder.attr('id')===e){this._lineHolder=null}$('div#'+i).remove();$('div#'+e).remove();$('div#'+j).remove();var n=this._parent.children();if(this._triangleHolder===null&&n.length>=3){this._triangleHolder=$(n[n.length/3-1])}if(this._lineHolder===null&&n.length>=3){this._lineHolder=$(n[n.length/3])}};function w(e){var i=$(e.target);var _=e.data;if(e.target.__dataPoint&&e.target.__parent){var j=i[0].getBoundingClientRect();var n=m(i[0].__dataPoint);var x=i[0].__parent.getBoundingClientRect();var y=i.attr('id');var z=$('#'+p(y));var B=$('#'+q(y));u(j,n,x,z,B);if(!_._commentsPositionMap.hasOwnProperty(y)){_._commentsPositionMap[y]={}}_._commentsPositionMap[y][_._vizType]={left:Number(i.css("left").replace('px','')),top:Number(i.css("top").replace('px',''))};e.stopPropagation();_._dispatchEvent(new E(l.Event_DragComment,_,_._commentsMap[y]))}}l.prototype._drawComment=function(i){var _=this;var j=this._commentsMap[i];if(!j||j.length===0){this._removeCommentUI(i);return}var n=this._findDataPoint(j[0]);if(!n){return}var x=$('div#'+i);if(x.length===0){x=$(document.createElement("DIV"));x.appendTo(this._parent).attr('id',i);this._initCommentUI(n,x)}else{x.empty()}this._addCommentUI(n,x,j);x.draggable({containment:"parent",start:function(e,y){e.target.__lastPosition={x:e.clientX,y:e.clientY}},stop:function(e,y){e.data=_;w(e)},drag:function(e,y){e.data=_;w(e)}});x.bind('click',this,t)};l.prototype._onEditComment=function(e){if(e==null){return}var i=o(e);var j=this._commentsMap[i];if(j==null){return}this._dispatchEvent(new E(l.Event_EditComment,this,e))};l.prototype._onRemoveComment=function(e){if(e==null){return}var j=o(e);var n=this._commentsMap[j];if(n==null){return}for(var i=0;i<n.length;i++){if(n[i]===e){n.splice(i,1);break}}this._drawComment(j);this._dispatchEvent(new E(l.Event_RemoveComment,this,e))};l.prototype.createComment=function(e){if(e.length===0){return}var i=e[e.length-1].ctx[0];var j=this._getPathInfo(i,this._vizData);var n=new f(j.dimension,j.dimension2,j.series);n.text('');return n};l.prototype.addComment=function(e){if(e==null){return}var i=o(e);if(this._commentsMap[i]==null){this._commentsMap[i]=[]}this._commentsMap[i].push(e);this._drawComment(i)};l.prototype.updateComment=function(e){if(e==null){return}var i=o(e);if(!this._commentsMap[i]){return}this._drawComment(i)};l.prototype.size=function(e){if(e){$('div#comments-parent').css(e);if(this._getConfirmDialog().isVisible()){this._getConfirmDialog().setPos({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2})}}};l.prototype.json2CommentsMap=function(e){for(var j in e){if(e.hasOwnProperty(j)){if(this._commentsMap[j]==null){this._commentsMap[j]=[]}var n=e[j];for(var i=0;i<n.length;i++){var x=n[i];var y=new f(x.dimension,x.dimension2,x.series);y.createTime(x.createTime);y.text(x.text);this._commentsMap[j].push(y)}}}this._needConfirm=e["needConfirm"];this._commentsPositionMap=e["commentsPositionMap"]};l.prototype.commentsMap2Json=function(){var e={};for(var j in this._commentsMap){if(this._commentsMap.hasOwnProperty(j)){var n=this._commentsMap[j];e[j]=[];for(var i=0;i<n.length;i++){var x=n[i];e[j].push({"dimension":x.dimension(),"dimension2":x.dimension2(),"series":x.series(),"createTime":x.createTime(),"text":x.text()})}}}e["needConfirm"]=this._needConfirm;e["commentsPositionMap"]=this._commentsPositionMap;return e};var A={"name":"comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","icon":{"show":"/contextmenu/annotation.png"},"supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_column":true,"viz/stacked_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_bar":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};return l});define('sap/viz/controls/annotation/views/CommentEditorView',['sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(L,O,U,a,C,D,$){var M=140;var l="";var t=false;var b=function(d){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.CommentEditorView";this._div=d;this._comment="";this._visible=false;this._oRichTextDialog=null;this._createChildren()};O.extend(b,a);b.WIDTH=497;b.HEIGHT=213;b.prototype._createChildren=function(){var _=this;this._oRichTextDialog=document.createElement('div');this._oRichTextDialog.id="divRichTextDialog";$(this._oRichTextDialog).addClass(C.ANNOTATION_PREFIX+'richtextdialog');$(document.body).append(this._oRichTextDialog);this.hide();var d=document.createElement('div');d.id="RichTextDialogHeader";$(d).addClass(C.ANNOTATION_PREFIX+'richtextdialog-header');$(this._oRichTextDialog).append(d);var c=document.createElement('span');$(c).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft');$(d).append(c);var f=document.createElement('span');f.id="RichTextDialogHeaderLabel";$(f).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft-label');$(f).text(L.get("VIZ_ANNOTATION_COMMENT"));$(c).append(f);var g=document.createElement('span');$(g).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright');$(d).append(g);var h=document.createElement('a');h.id="RichTextDialogHeaderClose";$(h).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright-close');$(g).append(h);$(h).click(function(){_.hide()});var i=document.createElement('div');i.id="RichTextDialogContent";$(i).addClass(C.ANNOTATION_PREFIX+'richtextdialog-content');$(this._oRichTextDialog).append(i);var j=document.createElement('textarea');j.id="RichTextDialogContentTextArea";$(j).addClass('mceEditor');$(i).append(j);var k=document.createElement('div');k.id="RichTextDialogFooter";$(k).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer');$(this._oRichTextDialog).append(k);var m=document.createElement('div');$(m).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer-buttons');$(k).append(m);var n=document.createElement('button');n.id="RichTextDialogOKButton";$(n).text(L.get("VIZ_COMMON_OK"));$(n).addClass(C.ANNOTATION_PREFIX+'button');$(n).addClass(C.COMMON_PREFIX+'button');$(m).append(n);$(n).click(function(){_.hide();_._comment=tinymce.activeEditor.getContent();_._dispatchEvent(new D(D.OK,_,{userData:_._userData,comment:_._comment}))});var o=document.createElement('button');o.id="RichTextDialogCancelButton";$(o).text(L.get("VIZ_COMMON_CANCEL"));$(o).addClass(C.ANNOTATION_PREFIX+'button');$(o).addClass(C.COMMON_PREFIX+'button');$(m).append(o);$(o).click(function(){_.hide()});if(!t){t=true;tinymce.init({theme:"advanced",mode:"textareas",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,forecolor,backcolor,|,justifyleft,justifycenter,justifyright,justifyfull,|,fontselect,fontsizeselect",theme_advanced_path:false,theme_advanced_font_sizes:"8px,9px,10px,11px,12px,14px,16px,18px,20px,22px,24px,26px,28px,36px,48px,72px",theme_advanced_statusbar_location:"none",editor_selector:"mceEditor",setup:function(p){p.onEvent.add(function(p,e){var q=p.getContent({format:'text'});if(q.length>M){p.setContent(l);p.selection.select(p.getBody(),true);p.selection.collapse(false)}else{l=p.getContent()}})}})}this._blockLayout=document.createElement('div');this._blockLayout.id="blockLayout";$(this._blockLayout).addClass(C.ANNOTATION_PREFIX+'block-layer')};b.prototype.show=function(o){if(o){if(o.hasOwnProperty("userData")){this._userData=o.userData}if(o.hasOwnProperty("comment")&&U.isString(o.comment)){this._comment=o.comment;l=o.comment;if(tinymce.activeEditor){tinymce.activeEditor.setContent(this._comment)}}if(o.hasOwnProperty("position")){this.setPos(o.position)}}this._visible=true;$(document.body).append(this._blockLayout);$(this._oRichTextDialog).show()};b.prototype.hide=function(){this._visible=false;$(this._blockLayout).detach();$(this._oRichTextDialog).hide()};b.prototype.setPos=function(p){$(this._oRichTextDialog).css({position:"absolute",left:p.pageX-b.WIDTH/2,top:p.pageY-b.HEIGHT/2})};b.prototype.isVisible=function(){return this._visible};return b});define('sap/viz/controls/annotation/Annotation',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotation/views/Comments','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/CommentEditorView'],function($,V,O,G,E,a,F,b,A,c,C,D,d){var f=function(e,u){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.Annotation";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_annotation_control');this._div=e;this._uiConfig=u?u:A.instance();this._popupLayer=e;this._commentEditor=null;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_annotation_control')};O.extend(f,V);f.prototype._createChildren=function(){this._comments=new C();var e=this._uiConfig.commentsAssetFolderPath;this._comments.assetFolder(e?e:G.defaultAssetsRoot()+'/controls/frame/assets');this._comments.addEventListener(C.Event_EditComment,this._editCommentHandler,this);this._comments.addEventListener(C.Event_RemoveComment,this._removeCommentHandler,this);this._comments.addEventListener(C.Event_DragComment,this._dragCommentHandler,this)};f.prototype._getCommentEditor=function(){if(!this._commentEditor){var p=this._popupLayer;if(p){this._commentEditor=new d($(p));this._commentEditor.addEventListener(D.OK,this._commentChangedHandler,this)}}return this._commentEditor};f.prototype._editCommentHandler=function(e){var g=e.data;var h=this._getCommentEditor();h.show({userData:{isNew:false,comment:g},comment:g.text(),position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}})};f.prototype._removeCommentHandler=function(e){var g=e.data;this._dispatchEvent(new a(c.COMMENT_CHANGED_EVENT,this,g))};f.prototype._dragCommentHandler=function(e){var g=e.data;this._dispatchEvent(new a(c.COMMENT_CHANGED_EVENT,this,g))};f.prototype._commentChangedHandler=function(e){var i=e.data.userData.isNew;var g=e.data.userData.comment;var t=e.data.comment;g.createTime(new Date().toLocaleString());g.text(t);if(i){this._comments.addComment(g)}else{this._comments.updateComment(g)}var h={commentChanged:true};this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h));this._dispatchEvent(new a(c.COMMENT_CHANGED_EVENT,this,g))};f.prototype.popupLayer=function(p){if(arguments.length>0){this._popupLayer=p;return this}else{return this._popupLayer}};f.prototype.validateSize=function(w,h){if(this._comments){this._comments.size({width:w,height:h})}if(this._commentEditor&&this._commentEditor.isVisible()){this._commentEditor.setPos({pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2})}};f.prototype.destroy=function(){if(this._commentEditor){this._commentEditor.removeAllEventListeners();this._commentEditor=null}if(this._popupLayer){this._popupLayer=null}$(this._div).remove()};f.prototype.addComment=function(s){var e=this._comments.createComment(s);if(e){var g=this._getCommentEditor();g.show({userData:{isNew:true,comment:e},comment:'',position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}})}};f.prototype.setChartInfo=function(v){this._comments.setChartInfo(v)};f.prototype.redraw=function(){this._comments.redraw()};f.prototype.clean=function(){this._comments.clean()};f.prototype.feedsChanged=function(){this._comments.feedsChanged()};f.prototype.save=function(){return this._comments.commentsMap2Json()};f.prototype.load=function(v){this._comments.json2CommentsMap(v)};return f});define('sap/viz/controls/annotationcontrol/AnnotationItem',[],function(){var A=function(i,t,d,s,c){this.__className="sap.viz.controls.annotationcontrol.AnnotationItem";this._id=i;this._type=t;this._dataContext=d;this._style=s;this._contents=c};A.prototype.id=function(v){if(arguments.length>0){this._id=v}else{return this._id}};A.prototype.type=function(v){if(arguments.length>0){this._type=v}else{return this._type}};A.prototype.dataContext=function(v){if(arguments.length>0){this._dataContext=v}else{return this._dataContext}};A.prototype.style=function(v){if(arguments.length>0){this._style=v}else{return this._style}};A.prototype.contents=function(v){if(arguments.length>0){this._contents=v}else{return this._contents}};return A});define('sap/viz/controls/annotationcontrol/AnnotationControlConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var A={};A.instance=function(){return{"allowDataPointValueChange":false,"visualStrategies":{"indicator":{"count":{"disabledRules":["SAME_ORIGINAL_VALUE"]}}}}};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL,A);return A});define('sap/viz/controls/annotationcontrol/AnnotationControlEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var A=function(t,a,d){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControlEvent"};O.extend(A,E);A.ANNOTATION_SELECTED_EVENT="annotationSelected";A.ANNOTATION_LAYOUTED_EVENT="annotationLayouted";return A});define('sap/viz/controls/annotationcontrol/Layouter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event'],function(O,U,E){var L=function(){this.__className="sap.viz.controls.annotationcontrol.Layouter"};return L});define('sap/viz/controls/annotationcontrol/AnnotationControl',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/annotationcontrol/AnnotationControlEvent','sap/viz/controls/annotationcontrol/AnnotationItem','sap/viz/controls/annotationcontrol/Layouter',],function($,V,O,A,a,b,L){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControl";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_AnnotationControl_control');this._div=d;this._uiConfig=u?u:A.instance();this._annotationItems=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_AnnotationControl_control')};O.extend(c,V);c.prototype._createChildren=function(){this._layouter=new L()};c.prototype.annotationItems=function(v){if(arguments.length>0){this._annotationItems=v}else{return this._annotationItems}};c.prototype.showAnnotations=function(){};c.prototype.hideAnnotations=function(){};c.prototype.invalidAnnotations=function(){return[]};c.prototype.getAnnotationPosition=function(d){if(!d||d.length===0){return[]}var e=[];for(var i=0;i<d.length;++i){e[i]=d[i].dataContext().context}return this._vizProxy().getDataPointsPosition(e)};c.prototype.save=function(){return{}};c.prototype.load=function(v){};return c});define('sap/viz/controls/chart/ChartConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{'enableTrellis':true,'enableMorphing':true,"useBuiltInPropertyZoneInteraction":false,"useDefaultChartSizeForTrellis":false,"defaultLabelFormatString":[['u']],"defaultProperties":{"title":{"visible":true},"tooltip":{"visible":true},"dataLabel":{"visible":false},"plotArea":{"animation":{"dataLoading":false,"dataUpdating":false,"resizing":false}},"legend":{"visible":true}},"specificProperties":{"bar":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}},"background":{"border":{"left":{"visible":false},"right":{"visible":false},"top":{"visible":false},"bottom":{"visible":false}}}},"column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"stacked_bar":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}}},"stacked_column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"dual_bar":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"xAxis2":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}}},"dual_column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}},"3d_column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}},"zAxis":{"title":{"visible":true}}},"line":{"plotArea":{"marker":{"shape":"circle","size":6,"visible":true}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"area":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"combination":{"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"dual_line":{"plotArea":{"marker":{"shape":"circle","size":6,"visible":true}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}},"dual_combination":{"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}},"pie":{},"donut":{},"pie_with_depth":{},"geobubble":{"plotArea":{"showNegativeValues":false},"sizeLegend":{"visible":true},"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"choropleth":{"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"geopie":{"sizeLegend":{"visible":true},"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"scatter":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"bubble":{"plotArea":{"showNegativeValues":false},"sizeLegend":{"visible":true},"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"scatter_matrix":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"heatmap":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}}},"treemap":{},"number":{},"boxplot":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"network":{},"radar":{"plotArea":{"marker":{"size":6,},"valueAxis":{"title":{"visible":true}},"polarAxis":{"title":{"visible":true}}}},"tagcloud":{},"tree":{},"waterfall":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},}}};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART,C);return C});define('sap/viz/controls/chart/ChartPreHandler',['sap/viz/controls/common/utils/FakeDataUtils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager'],function(F,I,A,a,b,c,d,L){var C=function(e){this._useInfoChart=e?e.useInfoChart===true:false};C._toInfoChartOptions=function(o,u){if(I.isInfoChart(o.type)){if(o.feeds&&o.data){var r=o.data.data();C._updateFlatTableDataset(o.feeds,r);o.data=new sap.viz.api.data.FlatTableDataset(r)}return o}if(!u){return o}var i=I.getInfoType(o.type);if(i){var e={};for(var p in o){if(o.hasOwnProperty(p)){e[p]=o[p]}}e.type=i;if(o.data){var f=o.data;var g=o.feeds;if(g){var h=JSON.parse(JSON.stringify(f.data()));C._updateCrossTabDataSet(o.type,g,h);f=new sap.viz.api.data.CrosstableDataset();f.data(h)}e.data=I.buildInfoDataset(f)}e.properties=I.buildInfoProperties(o.type,o.properties);return e}else{return o}};C._updateFlatTableDataset=function(f,r){if(!f||f.length===0){return}if(!r||!r.metadata||!r.metadata.fields||r.metadata.fields.length===0){return}var n={};for(var i=0;i<f.length;i++){var v=f[i].values();if(!v||v.length===0){continue}for(var e=0;e<v.length;e++){var g=v[e];if(g.type()===a.MND){continue}else if(g.type()===a.HIERARCHY){var h=g.hierarchyLevels();for(var k=0;k<h.length;k++){var l=h[k];if(n.hasOwnProperty(l.name())){return}n[l.name()]=l.analysis().id();if(l.selected()){break}}}else{if(n.hasOwnProperty(g.name())){return}n[g.name()]=g.id()}}}var j=r.metadata.fields;for(var m=0;m<j.length;m++){var o=j[m];if(o.name===o.id&&n.hasOwnProperty(o.name)){o.id=n[o.name]}}};C._updateCrossTabDataSet=function(v,f,r){if(!r){return}var e=F.buildFakeData(v,f,JSON.parse(JSON.stringify(r)));var g=e.feeding;if(!g||g.length===0){return}for(var i=0;i<g.length;i++){var h=g[i];var j=d.getFeed(f,h.feedId);var k=h.binding;if(!j||!k||k.length===0){continue}var l=j.values();if(!l||l.length===0){continue}var m=null;for(var n=0;n<k.length;n++){var o=k[n];var p=o.index;if(!o||!r[o.type]){continue}m=r[o.type][p-1];if(m&&m.data){m=m.data;break}}if(!m){continue}C._updateDataID(m,l)}};C._updateDataID=function(e,f){var g=0;for(var i=0;i<f.length;i++){var v=f[i];if(v.type()===a.MND){continue}else if(v.type()===a.HIERARCHY){var h=v.hierarchyLevels();for(var k=0;k<h.length;k++){var l=h[k];if(e[g]&&e[g].name===l.name()){e[g].id=l.id();g++}if(l.selected()){break}}}else{if(e[g]&&e[g].name===v.name()){e[g].id=v.id();g++}}}};C.prototype.preCreateViz=function(o){o=C._toInfoChartOptions(o,this._useInfoChart);if(o.properties){o.properties.title=o.properties.title||{};o.properties.title.text=o.properties.title.text||L.get('IDS_DEFAULTCHARTTITLE')}return o};C.prototype.preVizUpdate=function(o){o=C._toInfoChartOptions(o,this._useInfoChart);return o};C._toInfoFeeding=function(t,f){var n=null;var e=false;if(d.hasMND(f)||(d.countAnalyses(f,a.MEASURE)===0)){n=f}else{var v=I.getVizType(t);n=b.directFeeding(f,v,[A.genMND()]);e=true}return I.buildInfoFeeding(n,e)};C.prototype.preLoadChart=function(e){var t=e.type;var f=c.fromJSON(e["feedingItems"]);if(I.isInfoChart(t)){if(e.vizInstance&&e.vizInstance.data&&e.vizInstance.data.val){C._updateFlatTableDataset(f,e.vizInstance.data.val)}return e}if(!this._useInfoChart){return e}var i=I.getInfoType(t);if(!i){return e}e.type=i;if(e.vizInstance){e.vizInstance.type=i;e.vizInstance.properties=I.buildInfoProperties(t,e.vizInstance.properties);var r=e.vizInstance.data;if(r&&r.val&&r.type==="Crosstable"){C._updateCrossTabDataSet(t,f,r.val);var g=new sap.viz.api.data.CrosstableDataset();g.data(r.val);var h=I.buildInfoDataset(g);r.type="FlatTable";r.val=h.data()}e.vizInstance.feeding=C._toInfoFeeding(i,f)}return e};return C});define('sap/viz/controls/chart/ChartProxy',['jquery','sap/viz/controls/common/constants/ChartConst'],function($,C){var a=function a(c){this.__className="sap.viz.controls.chart.ChartProxy";this._chart=c;this._enabled=true};a.prototype.pauseRender=function(){this._enabled=false};a.prototype.resumeRender=function(){if(this._enabled){return}this._enabled=true;var c=this._chart._chartView();var o=c._options;if(this._chart.vizType()==C.TYPE_GEO_MAP){if(c._chart){c.doUpdate.apply(c,[c._chart,{data:o.data,feeding:o.feeding,properties:o.properties,css:o.css}]);c.doProperties.apply(c,[o.properties])}return}else if(c._chart&&c._chart.type==this._chart.vizType()){c._chart['update'].apply(c._chart,[{data:o.data,feeding:o.feeding,properties:o.properties,css:o.css}])}else{c._chart=sap.viz.api.core.createViz({type:this._chart.vizType(),data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:c._chartLayer$.get(0)});c._postVizProcess(o)}c._updateChartSize(true)};a.prototype.execute=function(f){if(!this._enabled){return}var c=this._chart._chartView();if(f.indexOf('map_')==0){return c[f.slice(4)].apply(c,Array.prototype.slice.call(arguments,1))}else if(f=='sap.viz.api.core.createViz'){return sap.viz.api.core.createViz(Array.prototype.slice.call(arguments,1)[0])}else{if(c._chart){return c._chart[f].apply(c._chart,Array.prototype.slice.call(arguments,1))}}};a.prototype.get=function(f,d){var c=this._chart._chartView();if(!this._enabled&&d!==undefined){return d}else{if(f=='type'){return c._chart[f]}else{return c._chart?this.execute(f):d}}};a.prototype.set=function(f,v){this.execute(f,v)};return a});define('sap/viz/controls/common/constants/MapProviderConst',[],function(){var M={};M.ESRI="ESRI";M.CVOM="CVOM";M.NAVTEQ="NAVTEQ";return M});define('sap/viz/controls/chart/views/AxisSizeAdjustHelper',[],function(){var M="v-m-main";var a=function(b,m,o){if(!v.isAxis(m)||!b){return null}var f=b.feedingZone();var c;f.forEach(function(e){if(e.name===m){c=e.bound[0]}});var d=b._usrOptions.container.querySelector("."+M).querySelector(".v-bound").getBoundingClientRect();var g,h;if(v.isXAxis(m)){g=d.height;h=c[0][1]-c[2][1]}else{g=d.width;h=c[0][0]-c[2][0]}g=Math.abs(g);h=Math.abs(h);if(g!==0){o=parseFloat(o);if(!isNaN(o)){h+=o}var p={};p[m]={maxSizeRatio:Math.max(0,h/g)};return p}return null};var v={xAxisCandidates:["xAxis","xAxis2"],yAxisCandidates:["yAxis","yAxis2"],isXAxis:function(k){return this.xAxisCandidates.indexOf(k)>-1},isYAxis:function(k){return this.yAxisCandidates.indexOf(k)>-1},isAxis:function(k){return this.isXAxis(k)||this.isYAxis(k)}};return a});define('sap/viz/controls/chart/views/AxisSplitter',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,O,V,C,E,a){var A=function(c,p,b){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.AxisSplitter";this._container=c;this._propertiesProvider=p;this._propertyZoneProvider=b;this._createChildren()};O.extend(A,a);A.AxisSplitChanged="AxisSplitChanged";A.prototype._createChildren=function(){this._div$=$(document.createElement("DIV"));this._resizeHelper$=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-resizehelper');this._mask$=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-resizehelper-mask');this._axis$=this._createAxis();this._axis2$=this._createAxis();this._div$.append(this._axis$).append(this._axis2$);this._div$.appendTo(this._container)};A.prototype._updateResizeHelperBound=function(b){var w=b[1][0]-b[0][0];var h=b[2][1]-b[0][1];this._resizeHelper$.css({left:b[0][0],top:b[0][1],width:w,height:h});this._resizeHelper$.appendTo(this._container)};A.prototype._resizeHelper=function(o,i){var p=this._resizeHelper$.position();if(i){this._resizeHelper$.css({top:p.top+o,height:this._resizeHelper$.height()-o})}else{this._resizeHelper$.css({width:this._resizeHelper$.width()+o})}};A.prototype._createAxis=function(){var b=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-axis');var i=false;var s,c;var _=this;var m=function(e){var o=i?(e.clientY-c):(e.clientX-c);var p=b.position();if(i){o=Math.max(-p.top,o);o=Math.min(b.data("bottom")-p.top,o);var t=p.top+o;b.css({top:t})}else{o=Math.max(-(p.left-b.data("left")),o);o=Math.min($(_._container).width()-p.left-6,o);var l=p.left+o;b.css({left:l})}c+=o;_._resizeHelper$.css("cursor",b.css("cursor"));_._resizeHelper(o,i);e.stopPropagation()};var d=function(e){_._mask$.unbind("mousemove",m);_._mask$.unbind("mouseup",d);_._mask$.unbind("mouseout",d);_._mask$.detach();_._resizeHelper$.detach();var f=i?e.clientY:e.clientX;var g=b.data("axis").name;var o=s-f;o=i?o:-o;_._axisMoved(g,o)};b.mousedown(function(e){_._mask$.css("cursor",b.css("cursor"));_._mask$.appendTo(document.body);i=b.data("isHorizontal");s=c=i?e.clientY:e.clientX;_._updateResizeHelperBound(b.data("axis").bound[0]);_._mask$.mousemove(m);_._mask$.mouseup(d);_._mask$.mouseout(d)});return b};A.prototype._axisMoved=function(b,o){var d={axisName:b,offset:o};this._dispatchEvent(new E(A.AxisSplitChanged,this,d))};A.prototype._getAxis=function(){var z=this._propertyZoneProvider();var r=[];if(!z||z.length==0){return r}for(var i=0;i<z.length;++i){for(var n=0;n<this._categoryAxis.length;++n){if(z[i].name===this._categoryAxis[n]){r.push(z[i])}}}return r};A.prototype._layoutAxis=function(b,c){var i=true;if(c.name==="yAxis"||c.name==="yAxis2"){i=false}b.data("isHorizontal",i);b.data("axis",c);if(i){var w=c.bound[0][1][0]-c.bound[0][0][0];b.data("bottom",c.bound[0][2][1]);b.css({left:c.bound[0][0][0],top:c.bound[0][1][1],width:w,height:6,"margin-top":-3,"margin-left":0,cursor:"n-resize"})}else{var h=c.bound[0][2][1]-c.bound[0][0][1];b.data("left",c.bound[0][0][0]);b.css({left:c.bound[0][1][0],top:c.bound[0][0][1],height:h,width:6,"margin-top":0,"margin-left":-3,cursor:"e-resize"})}};A.prototype._layout=function(){var b=this._getAxis();if(!b||b.length===0){return}this._layoutAxis(this._axis$,b[0]);if(b[1]){this._axis2$.css({'visibility':""});this._layoutAxis(this._axis2$,b[1])}else{this._axis2$.css({'visibility':"hidden"})}};A.prototype.reset=function(){this._div$.css({'visibility':'hidden'})};A.prototype.init=function(t){this._categoryAxis=V.getCategoryAxis(t);if(!this._categoryAxis||this._categoryAxis.length==0){this.reset();return}this._layout();this._div$.css({'visibility':"visible"})};A.prototype.deactive=function(){this._div$.css({'display':"none"})};A.prototype.active=function(){this._div$.css({'display':"block"})};return A});define('sap/viz/controls/chart/views/ChartEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ChartEvent"};O.extend(C,E);C.CHANGED_SELECTED_DATA="changeSelectedData";C.TRIGGER_CVOM_EVENT="triggerCVOMEvent";C.CHART_CHANGING="ChartChanging";C.CHART_CHANGED="ChartChanged";C.CVOM_INITIALIZED="CVOMChartInitialized";C.CLICK_FILTER_BUTTON="clickFilterButton";C.CLICK_EXCLUDE_BUTTON="clickExcludeButton";C.CLICK_DRILLDOWN_BUTTON="clickDrillDownButton";C.CHANGE_FEEDING="changeFeeding";C.ANALYSIS_DROPPED="analysisDropped";C.TITLE_CHANGED="TitleChanged";C.VIZTYPE_CHANGED="vizTypeChanged";C.VIZ_VIEW_CHANGED='vizViewChanged';C.SELECT_PROPERTY_ZONE="selectPropertyZone";C.PROPERTY_ZONES_CHANGED='propertyZonesChanged';C.ESRI_CUSTOMIZED_SERVICE_CHANGED='esriCustomizedServiceChanged';C.CONTEXT_MENU_TRIGGERED='contextMenuTriggered';C.USER_INTERACTION_COMPLETE='userInteractionComplete';C.VIZ_PROPERTIES_CHANGED='vizPropertiesChanged';return C});define('sap/viz/controls/chart/views/DataPointFinder',['jquery','sap/viz/controls/common/utils/Utils'],function($,U){var D={};D.findDataPointsPosition=function(d){var r=[];if(!d||d.length===0){return r}for(var i=0;i<d.length;i++){var a=D._findDataPointUI(d[i]);if(a){r[i]=a.getBoundingClientRect()}}return r};D._findDataPointUI=function(d){var a=d3.selectAll('.v-datapoint')[0];for(var i=0;i<a.length;i++){var b=a[i].__data__;if(!b){continue}var c;if(U.isArray(b.ctx)){c=b.ctx[0]}else{c=b.ctx}if(c.path==d.ctx[0]){return a[i]}}return null};return D});define('sap/viz/controls/common/helpers/Rectangle',[],function(){var R=function(l,t,w,h){this._left=l;this._top=t;this._width=w;this._height=h};R.parseDOM=function(d){var o=d.offset();return new R(o.left,o.top,d.outerWidth(),d.outerHeight())};R.prototype.left=function(v){if(arguments.length>0){this._left=v}else{return this._left}};R.prototype.top=function(v){if(arguments.length>0){this._top=v}else{return this._top}};R.prototype.right=function(v){if(arguments.length>0){this.left(v-this.width())}else{return this.left()+this.width()}};R.prototype.bottom=function(v){if(arguments.length>0){this.top(v-this.height())}else{return this.top()+this.height()}};R.prototype.width=function(){return this._width};R.prototype.height=function(){return this._height};R.prototype.hCenter=function(){return this.left()+this.width()/2};R.prototype.vCenter=function(){return this.top()+this.height()/2};R.prototype.hContains=function(t){return this.left()<=t.left()&&this.right()>=t.right()};R.prototype.vContains=function(t){return this.top()<=t.top()&&this.bottom()>=t.bottom()};R.prototype.contains=function(t){return this.hContains(t)&&this.vContains(t)};R.toJSON=function(i){return{'left':i.left(),'top':i.top(),'width':i.width(),'height':i.height()}};return R});define('sap/viz/controls/chart/views/DropZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/helpers/Rectangle'],function($,C,F,O,u,E,a,b,c,D,d,A,R){var f=function(t,z,g){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._feedValidator=g;this._enterDrop=false;this._dragActionArray=[];var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s);var h=this;this._dom.droppable({accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true},this),activate:function(e,i){h.enterDrop.apply(h,[e,i])},deactivate:function(e,i){u.defer(function(){h.exitDrop.apply(h,[e,i])})}})};O.extend(f,a);f.DROP_ITEM_EVENT='DROP_ITEM_EVENT';var _=8;f.prototype._match=function(z,e){var t=e.type();if(t){t=t.toLowerCase()}var g=e.dataType();if(g){g=g.toLowerCase()}var h=z.feedDef;var j=h[0].id===F.geoFeeds.id?c.GEOGRAPHY:h[0].type;if(h.length===1&&F.feedCompatible(j,t,g)){return true}for(var i=0;i<h.length;i++){j=h[i].id===F.geoFeeds.id?c.GEOGRAPHY:h[i].type;if(F.feedCompatible(j,t,g)&&h[i].id!==F.MultiplierFeedingName){return true}}return false};f.prototype._onDragOver=function(e,g){if(!this._enterDrop){return}var z=e.target.__zone;var h=e.target.__areaIndex;var t=D.instance().getAnalysisToken(g.helper);if(!z){t.currentAction(d.DENY);return}this._hightlight(z,h);if(this._acceptable(z,t.analysisObject)){t.dropTarget(e.target);t.currentAction(d.ACCEPT)}else{t.currentAction(d.DENY)}for(var i in this._dragActionArray){if(this._dragActionArray[i].zoneName===z.name){this._dragActionArray.splice(i,1);break}}this._dragActionArray.push({"zoneName":z.name,"action":t.currentAction()})};f.prototype._acceptable=function(z,e){var m=this._match(z,e);if(!m){return false}var g=false;var h=z.feedDef;for(var i=0;i<h.length;i++){if(h[i].id!=="r_subtotals"){g=g||this._feedValidator(h[i],e,z.name)}}return m&&g};f.prototype._onDragOut=function(e,g){if(!this._enterDrop){return}var z=e.target.__zone;var h=e.target.__areaIndex;if(z){this._unHightlight(z,h)}var t=D.instance().getAnalysisToken(g.helper);if(t.currentAction()===d.ACCEPT&&t.dropTarget()===e.target){t.currentAction(d.DENY);t.dropTarget(null)}for(var i in this._dragActionArray){if(this._dragActionArray[i].zoneName===z.name){this._dragActionArray.splice(i,1);break}}var l=this._dragActionArray.length;if(l>0){t.currentAction(this._dragActionArray[l-1].action)}};f.prototype._onDragDrop=function(e,g){var z=e.target.__zone;var t=D.instance().getAnalysisToken(g.helper);if(!z||!t){return}var l=this._dragActionArray.length;if(l>0){var h=this._dragActionArray[l-1];if(h.zoneName!==z.name){return}}var i=R.parseDOM($(this._targetDiv));var p=new R(e.pageX,e.pageY,0,0);if(!i.contains(p)){return}var j=t.analysisObject;if(this._acceptable(z,j)){t.currentAction(d.ACCEPT);this._dispatchEvent(new E(f.DROP_ITEM_EVENT,this,{'zone':z,'analysisObject':j}))}else{t.currentAction(d.DENY)}t.dropTarget(this._dom)};f.prototype._isTriggerAllowed=function(e){var g=e.hasClass(D.DRAGGABLE_CLASS_ANALYSIS);g=g&&!e.hasClass(C.FEEDINGSHELF_PREFIX+'card');return g};f.prototype._createDiv=function(p,g,t,r){var h=$(document.createElement("DIV"));var l=g[0][0],i=g[0][1],w=g[2][0]-g[0][0],j=g[2][1]-g[0][1];var s="visibility:hidden;left:"+l+"px;top:"+i+"px;width:"+w+"px;height:"+j+"px;";var k=this;h.attr('style',s).droppable({tolerance:'pointer',accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true},this),drop:function(e,q){k._onDragDrop.apply(k,[e,q])},over:function(e,q){k._onDragOver.apply(k,[e,q])},out:function(e,q){k._onDragOut.apply(k,[e,q])}});h.addClass(C.CHART_PREFIX+'drop-zone').appendTo(p);if(t&&t.length>0){s="position:absolute;left:0px;top: 0px;";var m=$(document.createElement("DIV")).attr('style',s).text(t).appendTo(h);var n=m[0].getBoundingClientRect();var o=null;if(r){o="translate("+(w-n.width)/2+"px,"+((n.width-n.height)/2+_)+"px) rotate(-90deg);"}else{o="translate("+_+"px, "+(j-n.height)/2+"px);"}s+="transform: "+o;s+="-webkit-transform: "+o;s+="-ms-transform: "+o;s+="-moz-transform: "+o;m.attr('style',s)}return h};f.prototype.enterDrop=function(e,g){var t=D.instance().getAnalysisToken(g.helper);if(!t){return}if(this._enterDrop){return}this._enterDrop=true;this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();if(!z){return}this._dragActionArray=[];for(var i=0;i<z.length;i++){var h=z[i].bound;for(var n=0;n<h.length;n++){var j=this._createDiv(this._dom[0],h[n],z[i].text,z[i].rotate);j[0].__zone=z[i];j[0].__areaIndex=n}}};f.prototype.exitDrop=function(){if(!this._enterDrop){return}this._dom.empty();this._dom.css('visibility','hidden');this._enterDrop=false};f.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"})}};f.prototype._getDom=function(z,e){var g=this._dom.children();for(var i=0;i<g.length;i++){if(g[i].__zone===z&&g[i].__areaIndex===e){return g[i]}}return null};f.prototype._hightlight=function(z,e){var g=this._getDom(z,e);if(g){$(g).css('visibility','')}};f.prototype._unHightlight=function(z,e){var g=this._getDom(z,e);if(g){$(g).css('visibility','hidden')}};return f});define('sap/viz/controls/chart/views/EditAxisView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/LangManager',],function($,O,V,C,U,a,b,E,L){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.EditAxisView";this._type=null;this._properties=null;this._createChildren()};O.extend(c,U);c.AxisScaleChanged="AxisScaleChanged";c.prototype._createChildren=function(){var _=this;this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(b.CHART_PREFIX+'editaxis');this._axisContainer=[];this._axisContainer[0]=this._createAxisUI("primaryAxis");this._confirmDialog$.append(this._axisContainer[0]);this._axisContainer[1]=this._createAxisUI("secondaryAxis");this._confirmDialog$.append(this._axisContainer[1]);var d=$(document.createElement('div'));d.addClass(b.CHART_PREFIX+'editaxis-footer');this._confirmDialog$.append(d);var e=$(document.createElement('div'));e.addClass(b.CHART_PREFIX+'editaxis-footer-buttons');d.append(e);var f=$(document.createElement('button'));f.text(L.get("VIZ_COMMON_OK"));f.addClass(b.CHART_PREFIX+'editaxis-footer-button');f.addClass(b.COMMON_PREFIX+'button');e.append(f);f.click(function(){_.hide();_._applyChange()});var g=$(document.createElement('button'));g.text(L.get("VIZ_COMMON_CANCEL"));g.addClass(b.CHART_PREFIX+'editaxis-footer-button');g.addClass(b.COMMON_PREFIX+'button');e.append(g);g.click(function(){_.hide()});this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(b.CHART_PREFIX+'block-layer')};c.prototype._createAxisUI=function(d){var _=this;var e=$(document.createElement('div')).addClass(b.CHART_PREFIX+'editaxis-axiscontainer');var f=$(document.createElement('div')).appendTo(e).addClass(b.CHART_PREFIX+'editaxis-axisname');$(document.createElement('span')).appendTo(f).attr("id","axisName").text("Axis");var s=$(document.createElement('div')).appendTo(e).addClass(b.CHART_PREFIX+'editaxis-separator');var g=$(document.createElement('div')).appendTo(e);g.append('<input type="radio" id="autoRange" value="false" name="'+d+'"></input>');g.find("#autoRange").change(function(){_._updateFixedRangeInput(h.find("#fixedRange")[0],i)});$(document.createElement('span')).appendTo(g).text(L.get("VIZ_CHART_AUTO_RANGE"));var h=$(document.createElement('div')).appendTo(e);h.append('<input type="radio" id="fixedRange" value="true" name="'+d+'"></input>');h.find("#fixedRange").change(function(){_._updateFixedRangeInput(h.find("#fixedRange")[0],i)});$(document.createElement('span')).appendTo(h).text(L.get("VIZ_CHART_FIXED_RANGE"));var i=$(document.createElement('div')).appendTo(e).addClass(b.CHART_PREFIX+'editaxis-inputs');i.append('<input type="number" id="minValue" onkeypress="return (/[\\d.-]/.test(String.fromCharCode(event.keyCode)))" style="ime-mode:Disabled" class="'+(b.CHART_PREFIX+"editaxis-inputvalue")+'"></input>');$(document.createElement('span')).appendTo(i).text(" - ");i.append('<input type="number" id="maxValue" onkeypress="return (/[\\d.-]/.test(String.fromCharCode(event.keyCode)))" style="ime-mode:Disabled" class="'+(b.CHART_PREFIX+"editaxis-inputvalue")+'"></input>');return e};c.prototype._updateFixedRangeInput=function(f,i){var d=f.checked?false:true;i.find("input").attr("disabled",d)};c.prototype._propertiesChanged=function(p){for(var i=0;i<this._valueAxis.length;++i){var d=this._valueAxis[i];var e=p[d];var f=this._properties[d];if(e.scale.fixedRange!==f.scale.fixedRange){return true}if(e.scale.fixedRange){if(e.scale.minValue!==f.scale.minValue||e.scale.maxValue!==f.scale.maxValue){return true}}}return false};c.prototype._applyChange=function(){var p={};for(var i=0;i<this._valueAxis.length;++i){var d=this._valueAxis[i];p[d]={scale:{fixedRange:false}};var e=this._axisContainer[i];if(!e){continue}if(e.find("#fixedRange")[0].checked){p[d].scale.fixedRange=true;p[d].scale.minValue=Number(e.find("#minValue").val());p[d].scale.maxValue=Number(e.find("#maxValue").val())}}if(this._propertiesChanged(p)){if(C.isInfoChart(this._type)){p=this._convertToInfoChartValueAxis(p)}this._dispatchEvent(new E(c.AxisScaleChanged,this,p))}};c.prototype._convertToInfoChartValueAxis=function(p){var n={'plotArea':{}};var m=function(d){return{'fixedRange':p[d].scale.fixedRange,'minValue':p[d].scale.minValue,'maxValue':p[d].scale.maxValue}};if(p.hasOwnProperty('valueAxis')){n.plotArea['primaryScale']=m('valueAxis')}if(p.hasOwnProperty('valueAxis2')){n.plotArea['secondaryScale']=m('valueAxis2')}return n};c.prototype._getAxisName=function(t,d){if(C.isInfoChart(t)){return this._getInfoChartAxisName(t,d)}var v=V.getValueAxis(t);var e=v?v.length:1;if(e===1||t===a.TYPE_SCATTER||t===a.TYPE_BUBBLE){if(d===a.AXIS_XAXIS){return L.get("VIZ_CHART_XAXIS_RANGE")}else if(d===a.AXIS_YAXIS){return L.get("VIZ_CHART_YAXIS_RANGE")}}else{if(d===a.AXIS_XAXIS){return L.get("VIZ_CHART_XAXIS1_RANGE")}else if(d===a.AXIS_YAXIS){return L.get("VIZ_CHART_YAXIS1_RANGE")}}if(d===a.AXIS_XAXIS2){return L.get("VIZ_CHART_XAXIS2_RANGE")}else if(d===a.AXIS_YAXIS2){return L.get("VIZ_CHART_YAXIS2_RANGE")}return""};c.prototype._getInfoChartAxisName=function(t,d){if(t===a.TYPE_INFO_BAR||t===a.TYPE_INFO_HORIZONTAL_LINE){return L.get("VIZ_CHART_XAXIS_RANGE")}else if(t===a.TYPE_INFO_COLUMN||t===a.TYPE_INFO_LINE){return L.get("VIZ_CHART_YAXIS_RANGE")}};c.prototype._getInfoChartValueAxis=function(p){this._valueAxis=[];var d=p['plotArea'];var m=function(f){f['minValue']=f['minValue']?f['minValue']:0;return{fixedRange:f['fixedRange'],minValue:f['fixedRange']?f['minValue']:f['autoMinValue'],maxValue:f['fixedRange']?f['maxValue']:f['autoMaxValue']}};if(p.hasOwnProperty('valueAxis')){this._valueAxis.push('valueAxis');var e=d['primaryScale'];p['valueAxis'].scale=m(e)}if(p.hasOwnProperty('valueAxis2')){this._valueAxis.push('valueAxis2');var s=d['secondaryScale'];p['valueAxis2'].scale=m(s)}};c.prototype._updateUI=function(t,p,d){this._type=t;if(d){this._valueAxis=[d]}else if(C.isInfoChart(t)){this._getInfoChartValueAxis(p)}else{this._valueAxis=V.getValueAxis(t)}this._properties=p;var v=this._valueAxis;if(!v||v.length===0){return}for(var i=0;i<v.length;++i){var d=v[i];var e=p[d];var f=this._axisContainer[i];if(!f){continue}f.css({"display":"block"});f.find("#axisName").text(this._getAxisName(t,d));if(e.scale.fixedRange){f.find("#fixedRange")[0].checked=true}else{f.find("#autoRange")[0].checked=true}f.find("#minValue").val(e.scale.minValue);f.find("#maxValue").val(e.scale.maxValue);this._updateFixedRangeInput(f.find("#fixedRange")[0],f.find("."+b.CHART_PREFIX+'editaxis-inputs'))}for(var n=v.length;n<this._axisContainer.length;n++){this._axisContainer[n].css({"display":"none"})}};c.prototype.show=function(t,p,d){this._visible=true;var l=this._dom$.offset().left+this._dom$.width()/2;var e=this._dom$.offset().top+this._dom$.height()/2;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);this._confirmDialog$.css({position:"absolute",left:l-this._confirmDialog$.width()/2,top:e-this._confirmDialog$.height()/2});this._updateUI(t,p,d)};c.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};return c});define('sap/viz/controls/chart/morph/constant/MorphConst',[],function(){var M={};M.SHAPE_DATA="data";M.SHAPE_GLOBAL_TRANSLATE_X="translateX";M.SHAPE_GLOBAL_TRANSLATE_Y="translateY";M.MORPHER_DISABLE_COLOR="MORPHER_DISABLE_COLOR";M.MORPHER_DISABLE_LINE="MORPHER_DISABLE_LINE";M.MORPHER_DISABLE_PATH="MORPHER_DISABLE_PATH";M.MORPHER_DISABLE_RECT="MORPHER_DISABLE_RECT";M.MORPHER_DISABLE_TEXT="MORPHER_DISABLE_TEXT";M.MORPHER_DISABLE_TRANSFORM="MORPHER_DISABLE_TRANSFORM";M.CHART_TYPE_COLUMN="viz/column";M.CHART_TYPE_STACKED_COLUMN="viz/stacked_column";M.CHART_TYPE_100_STACKED_COLUMN="viz/100_stacked_column";M.CHART_TYPE_DUAL_COLUMN="viz/dual_column";M.CHART_TYPE_3D_COLUMN="viz/3d_column";M.CHART_TYPE_BAR="viz/bar";M.CHART_TYPE_STACKED_BAR="viz/stacked_bar";M.CHART_TYPE_100_STACKED_BAR="viz/100_stacked_bar";M.CHART_TYPE_DUAL_BAR="viz/dual_bar";M.CHART_TYPE_3D_BAR="viz/3d_bar";M.CHART_TYPE_LINE="viz/line";M.CHART_TYPE_HORIZONTAL_LINE="viz/horizontal_line";M.CHART_TYPE_DUAL_LINE="viz/dual_line";M.CHART_TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";M.CHART_TYPE_AREA="viz/area";M.CHART_TYPE_HORIZONTAL_AREA="viz/horizontal_area";M.CHART_TYPE_100_AREA="viz/100_area";M.CHART_TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";M.CHART_TYPE_COMBINATION="viz/combination";M.CHART_TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";M.CHART_TYPE_DUAL_COMBINATION="viz/dual_combination";M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";M.CHART_TYPE_BOXPLOT="viz/boxplot";M.CHART_TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";M.CHART_TYPE_WATERFALL="viz/waterfall";M.CHART_TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";M.CHART_TYPE_PIE="viz/pie";M.CHART_TYPE_DONUT="viz/donut";M.CHART_TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";M.CHART_TYPE_SCATTER="viz/scatter";M.CHART_TYPE_BUBBLE="viz/bubble";M.CHART_TYPE_SCATTER_MATRIX="viz/scatter_matrix";M.CHART_TYPE_GEO_BUBBLE="viz/geobubble";M.CHART_TYPE_GEO_CHOROPLETH="viz/choropleth";M.CHART_TYPE_GEO_PIE="viz/geopie";M.CHART_TYPE_HEATMAP="viz/heatmap";M.CHART_TYPE_TREEMAP="viz/treemap";M.CHART_TYPE_TABLE="viz/ext/table";M.CHART_TYPE_CROSSTAB="viz/ext/crosstab";M.CHART_TYPE_RADAR="viz/radar";M.CHART_TYPE_TAG_CLOUD="viz/tagcloud";var _={};var m=function(t,h){_[t]=h};m(M.CHART_TYPE_COLUMN,M.CHART_TYPE_BAR);m(M.CHART_TYPE_STACKED_COLUMN,M.CHART_TYPE_STACKED_BAR);m(M.CHART_TYPE_100_STACKED_COLUMN,M.CHART_TYPE_100_STACKED_BAR);m(M.CHART_TYPE_DUAL_COLUMN,M.CHART_TYPE_DUAL_BAR);m(M.CHART_TYPE_3D_COLUMN,M.CHART_TYPE_3D_BAR);m(M.CHART_TYPE_LINE,M.CHART_TYPE_HORIZONTAL_LINE);m(M.CHART_TYPE_DUAL_LINE,M.CHART_TYPE_DUAL_HORIZONTAL_LINE);m(M.CHART_TYPE_AREA,M.CHART_TYPE_HORIZONTAL_AREA);m(M.CHART_TYPE_100_AREA,M.CHART_TYPE_100_HORIZONTAL_AREA);m(M.CHART_TYPE_COMBINATION,M.CHART_TYPE_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_DUAL_COMBINATION,M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_BOXPLOT,M.CHART_TYPE_HORIZONTAL_BOXPLOT);m(M.CHART_TYPE_WATERFALL,M.CHART_TYPE_HORIZONTAL_WATERFALL);M.IS_V_H_MAP=function(t,a){if(_[t]&&_[t]===a){return true}if(_[a]&&_[a]===t){return true}return false};return M});define('sap/viz/controls/chart/morph/utils/Utils',[],function(){var u={};var _=0;u.genUID=function(){if(!_){_=0}return"mgen_"+(_++)};var c={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};u.type=function(o){return!o?String(o):c[Object.prototype.toString.call(o)]||"object"};u.isFunction=function(o){return u.type(o)==="function"};u.isBoolean=function(o){return u.type(o)==="boolean"};u.isString=function(o){return u.type(o)==="string"};u.isArray=function(o){return u.type(o)==="array"};u.isNumber=function(o){return u.type(o)==="number"};u.isRegExp=function(o){return u.type(o)==="regexp"};u.sortArrayOn=function(d,p,e){if(u.isArray(d)&&u.isString(p)){d.sort(function(a,b){return e?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p])})}};u.noop=function(){};return u});define('sap/viz/controls/chart/morph/utils/SVGShapeMetadata',[],function(){var S={};var a="__vizmp__";S.set=function(s,n,v){if(!s[a]){s[a]={}}s[a][n]=v};S.get=function(s,n){if(s&&s[a]!==null&&s[a]!==undefined){return s[a][n]}return undefined};S.clone=function(n,o){n[a]=o[a];return n};return S});define('sap/viz/controls/chart/morph/vo/VizShape',[],function(){var V=function(f,t,d){this.from=f;this.to=t;this.display=d};return V});define('sap/viz/controls/chart/morph/vo/VizShapesHolder',[],function(){var V=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[]};V.prototype.empty=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[]};V.prototype.allByOrder=function(){return[].concat(this.backgrounds,this.xAxis2Labels,this.xAxisLabels,this.yAxis2Labels,this.yAxisLabels,this.plotLines,this.plotShapes)};V.prototype.toShapesBySvgType=function(){var a={};var b=[];a["all"]=b;var c=this.allByOrder();for(var i=0;i<c.length;i++){var v=c[i];if(v.to){var t=v.to.localName;var d=a[t];if(!d){a[t]=d=[]}d.push(v);b.push(v)}}return a};return V});define('sap/viz/controls/chart/morph/viz/MpShapesCapturer',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder'],function(M,S,V,a){var b={};b.getShapes=function(v){var d=new a();var g=d3.select(v).select(".v-m-root");var h=d3.select(v).select(".v-m-main");var r=g.node();var m=h.node();if(r&&m&&r.offsetHeight>0&&r.offsetWidth>0&&r.getScreenCTM!==undefined&&m.getScreenCTM!==undefined){var j=p(g);var k=r.getScreenCTM();d.plotShapes=c(h,".v-m-plot .v-morphable-datapoint",k,j);d.plotLines=c(h,".v-m-plot .v-morphable-line, "+".v-m-plot .v-morphable-areabg",k,j);d.xAxisLabels=c(h,".v-m-xAxis .v-morphable-label",k);d.xAxis2Labels=c(h,".v-m-xAxis2 .v-morphable-label",k);d.yAxisLabels=c(h,".v-m-yAxis .v-morphable-label",k);d.yAxis2Labels=c(h,".v-m-yAxis2 .v-morphable-label",k);d.backgrounds=c(g,".v-m-background .v-morphable-background",k);for(var i=0;i<d.backgrounds.length;i++){var l=d.backgrounds[i];S.set(l.to,M.MORPHER_DISABLE_RECT,true)}}return d};var c=function(g,s,o,v){var h=g.selectAll(s);var j=[];h.each(function(d,i){if(this.localName==="path"&&String(this.getAttribute("class")).indexOf("v-geo-choropleth-feature")>=0){return}var k=this.cloneNode(true);S.set(k,M.SHAPE_DATA,this.__data__);f(k,this,v);e(this,o,k);j.push(new V(null,k,null))});return j};var p=function(v){var g={};var h=false;var d=v.selectAll("defs");d.each(function(){var j=this;if(j.firstChild){var k=j.childNodes;for(var i=0;i<k.length;i++){var l=k[i];if(l){var m="";var s=[];var n="#000000";if(l.localName==="linearGradient"){m=l.getAttribute("id");s=l.childNodes;if(s.length===2){n=s[1].getAttribute("stop-color")}else if(s.length===4){n=s[3].getAttribute("stop-color")}else{n=s[s.length-1].getAttribute("stop-color")}g[m]=n;h=true}else if(l.localName==="radialGradient"){m=l.getAttribute("id");s=l.childNodes;if(s.length===3){n=s[1].getAttribute("stop-color")}else if(s.length===4){n=s[3].getAttribute("stop-color")}else{n=s[s.length-1].getAttribute("stop-color")}g[m]=n;h=true}}}}});if(h){g["__hasGradientColor"]=true}return g};var e=function(o,d,n){var g=o.getScreenCTM();var l=g.e-d.e;var t=g.f-d.f;n.setAttribute("transform","translate("+l+","+t+")");S.set(n,M.SHAPE_GLOBAL_TRANSLATE_X,l);S.set(n,M.SHAPE_GLOBAL_TRANSLATE_Y,t);return n};var f=function(s,o,v){if(s.localName==="path"&&s.getAttribute("class")&&s.getAttribute("class").indexOf("v-morphable-line")>=0){s.setAttribute("fill-opacity",0)}if(s.localName==="path"&&s.getAttribute("class")&&s.getAttribute("class").indexOf("v-morphable-datapoint")>=0&&s.getAttribute("visibility")==="hidden"){s.setAttribute("visibility","");s.setAttribute("d","M0,0L0,0Z")}if(o.localName==="rect"&&o.getAttribute("opacity")==="0"&&o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.getAttribute("class")&&o.parentNode.parentNode.getAttribute("class").indexOf("v-heatmap")>=0){s.setAttribute("opacity",1)}if(v&&v["__hasGradientColor"]===true&&o.getAttribute("fill")&&o.getAttribute("fill").indexOf("url(#")===0){var g=o.getAttribute("fill");g=g.substring(5,g.length-1);var d=v[g];d=d?d:"#000000";s.setAttribute("fill",d)}};return b});define('sap/viz/controls/chart/morph/utils/SVGShapeReplacer',['sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(S){var a={};var b="http://www.w3.org/2000/svg";var c=["x","y","width","height","rx","ry","x1","x2","y1","y2"];var g=function(s,d){var r=parseFloat(s.getAttribute(d));return isNaN(r)?0:r};a.replace=function(s,n,d,k){if(s&&n){var e=document.createElementNS(b,n);if(k){var o=s.attributes;for(var i=0;i<o.length;i++){var f=o[i];if(c.indexOf(f.localName)===-1){e.setAttribute(f.localName,f.value)}}}for(var h in d){if(d.hasOwnProperty(h)){e.setAttribute(h,d[h])}}S.clone(e,s);if(s.parentNode){s.parentNode.replaceChild(e,s)}return e}return null};a.replaceToPath=function(s){if(s){var p=null;switch(s.localName){case"rect":var x=g(s,"x");var y=g(s,"y");var w=g(s,"width");var h=g(s,"height");var r=g(s,"rx");var d=g(s,"ry");p="M"+x+","+y+"L"+(w+x)+","+y+"L"+(w+x)+","+(h+y)+"L"+x+","+(h+y)+"L"+x+","+y+"Z";break;case"line":var e=g(s,"x1");var f=g(s,"y1");var i=g(s,"x2");var j=g(s,"y2");p="M"+e+","+f+"L"+i+","+j;break;default:}if(p){var k={d:p};return a.replace(s,"path",k,true)}}return null};return a});define('sap/viz/controls/chart/morph/viz/MpShapesMapper',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/SVGShapeReplacer','sap/viz/controls/chart/morph/vo/VizShape'],function(M,u,S,a,V){var b={};b.map=function(n,f,g,h){m(n.plotShapes,f.plotShapes,c);m(n.plotLines,f.plotLines,c);if(M.IS_V_H_MAP(g,h)){m(n.xAxisLabels,f.yAxisLabels,c);m(n.xAxis2Labels,f.yAxis2Labels,c);m(n.yAxisLabels,f.xAxisLabels,c);m(n.yAxis2Labels,f.xAxis2Labels,c)}else{m(n.xAxisLabels,f.xAxisLabels,c);m(n.xAxis2Labels,f.xAxis2Labels,c);m(n.yAxisLabels,f.yAxisLabels,c);m(n.yAxis2Labels,f.yAxis2Labels,c)}m(n.backgrounds,f.backgrounds,e);return n};var c=function(f,t){if(t&&f&&S.get(t,M.SHAPE_DATA)&&S.get(f,M.SHAPE_DATA)&&S.get(f,M.SHAPE_DATA).ctx){var g=S.get(t,M.SHAPE_DATA).ctx;var h=S.get(f,M.SHAPE_DATA).ctx;if(u.isArray(g)){g=g[0]}if(u.isArray(h)){h=h[0]}if(g&&h){return d(g,h)}}if(t&&f&&u.isArray(S.get(t,M.SHAPE_DATA))&&u.isArray(S.get(f,M.SHAPE_DATA))){var j=S.get(t,M.SHAPE_DATA);var k=S.get(f,M.SHAPE_DATA);if(j.length==k.length&&j.length>0){for(var i=0;i<j.length;i++){if(!j[i]||!k[i]||d(j[i].ctx,k[i].ctx)===false){return false}}return true}}if(t&&f&&t.localName==="g"&&f.localName==="g"&&t.firstChild.localName==="text"&&f.firstChild.localName==="text"&&t.firstChild.textContent==f.firstChild.textContent){return true}return false};var d=function(f,g){if(!f&&!g){return true}if(!f||!g||f.type!==g.type||(!f.path||!g.path)||(f.path.dii_a1!=g.path.dii_a1)||(f.path.dii_a2!=g.path.dii_a2)||(f.path.mg!=g.path.mg)||(f.path.mi!=g.path.mi)){return false}return true};var e=function(f,t){if(t&&f&&t.localName==f.localName&&t.getAttribute("class")==f.getAttribute("class")){return true}};var m=function(n,f,g,h){var k=[];for(var i=0;i<n.length;i++){var l=n[i];for(var j=0;j<f.length;j++){var o=f[j];if(h||k.indexOf(o)===-1){if(g(l.to,o.display)){var p=r(l.to,o.display);l.to=p.newShape;l.from=p.currentShape;k.push(o);break}}}}};var r=function(n,f){var g={newShape:n,currentShape:f};var h;if(n.localName==="path"&&f.localName!=="path"){h=a.replaceToPath(f);if(h){g.currentShape=h}}if(n.localName!=="path"&&f.localName==="path"){h=a.replaceToPath(n);if(h){g.newShape=h}}return g};return b});define('sap/viz/controls/chart/morph/utils/Cache',[],function(){var C={};var r=function(a,b){for(var i=0,c=a.length;i<c;i++){if(a[i]===b){return a.push(a.splice(i,1)[0])}}};C.func=function(f,s,p){function n(){var a=Array.prototype.slice.call(arguments,0),b=a.join("\u2400"),c=n.cache=n.cache||{},d=n.count=n.count||[];if(c.hasOwnProperty(b)){r(d,b);return p?p(c[b]):c[b]}d.length>=1e3&&delete c[d.shift()];d.push(b);c[b]=f.apply(s,a);return p?p(c[b]):c[b]}return n};return C});define('sap/viz/controls/chart/morph/utils/ColorUtil',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache'],function(u,C){var a={};var _=null;a.parse=function(c){if(!_){_=C.func(RGBColorStatic.parse)}return _(c)};a.numberToHexString=function(c){var r=((c&0xff0000)>>16).toString(16),g=((c&0x00ff00)>>8).toString(16),b=(c&0x0000ff).toString(16);var h="#"+((r.length===1)?"0"+r:r)+((g.length===1)?"0"+g:g)+((b.length===1)?"0"+b:b);return h};a.hexStringToNumber=function(h){if(!h){return 0}if(h.charAt(0)==='#'){h=h.substr(1)}var r=parseInt(h.substr(0,2),16),g=parseInt(h.substr(2,2),16),b=parseInt(h.substr(4,2),16);var c=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return c};a.numberToRGB=function(c){var r=(c&0xff0000)>>16,g=(c&0x00ff00)>>8,b=c&0x0000ff;return'rgb('+r+','+g+','+b+')'};a.numberToRGBA=function(c,d){var r=(c&0xff0000)>>16,g=(c&0x00ff00)>>8,b=c&0x0000ff;if(d===undefined||d<=0||d>1){d=1}return'rgba('+r+','+g+','+b+','+d+')'};a.RGBToNumber=function(r,g,b){var h=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return h};a.getColorMix=function(c,b,p){return a.getPercentageOfColor(c,1-p)+a.getPercentageOfColor(b,p)};a.getPercentageOfColor=function(b,p){p=Math.min(1,Math.max(0,p));var r=(b&0xff0000)>>16;var g=(b&0x00ff00)>>8;var c=b&0x0000ff;return(r*p)<<16|(g*p)<<8|(c*p)};a.adjustBrightness=function(c,d){var r=Math.min(((c>>16)&0xFF)+d,255);r=Math.max(r,0);var g=Math.min(((c>>8)&0xFF)+d,255);g=Math.max(g,0);var b=Math.min((c&0xFF)+d,255);b=Math.max(b,0);return(r<<16)|(g<<8)|b};a.adjustBrightness2=function(c,d){var r=NaN,g=NaN,b=NaN;if(d==0){return c}else if(d>0){d/=100;r=((c>>16)&0xFF);g=((c>>8)&0xFF);b=(c&0xFF);r+=((0xFF-r)*d);g+=((0xFF-g)*d);b+=((0xFF-b)*d);r=Math.min(r,255);g=Math.min(g,255);b=Math.min(b,255)}else{d=(100+d)/100;r=((c>>16)&0xFF)*d;g=((c>>8)&0xFF)*d;b=(c&0xFF)*d}return(r<<16)|(g<<8)|b};a.rgbMultiply=function(c,b){var r=(c>>16)&0xFF,g=(c>>8)&0xFF,d=c&0xFF;var e=(b>>16)&0xFF,f=(b>>8)&0xFF,h=b&0xFF;return((r*e/255)<<16)|((g*f/255)<<8)|(d*h/255)};return a});define('sap/viz/controls/chart/morph/morphers/ColorMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/ColorUtil'],function(u,C){var a={};var g=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?1:r};a.getPercentage=function(f,t,p){p=p>100?100:p<0?0:p;var b=C.parse(f);var c=C.parse(t);if(b.length===0&&c.length===0){return""}if(b.length===0&&c.length===3){return"rgb("+c[0]+","+c[1]+","+c[2]+")"}if(b.length===3&&c.length===0){return""}return"rgb("+Math.round(b[0]+(c[0]-b[0])*p/100)+","+Math.round(b[1]+(c[1]-b[1])*p/100)+","+Math.round(b[2]+(c[2]-b[2])*p/100)+")"};a.svg=function(f,t,d,p){if(d&&t){var b=f?f.getAttribute("stroke"):"";var c=t.getAttribute("stroke");var e=f?f.getAttribute("fill"):"";var h=t.getAttribute("fill");if(b===c){d.setAttribute("stroke",c)}else{d.setAttribute("stroke",a.getPercentage(b,c,p))}var i="";if(e===h){i=h;d.setAttribute("fill",i)}else{i=a.getPercentage(e,h,p);d.setAttribute("fill",i)}var j;var k;if(f){if(i===""){d.setAttribute("fill-opacity",0)}else{var l=g(f,"fill-opacity");j=g(t,"fill-opacity");if(l!=j){d.setAttribute("fill-opacity",l+(j-l)*p/100)}}var m=g(f,"stroke-opacity");k=g(t,"stroke-opacity");if(m!=k){d.setAttribute("stroke-opacity",m+(k-m)*p/100)}}else{if(t.getAttribute("fill-opacity")!==""){if(i===""){j=0}else{j=g(t,"fill-opacity")}d.setAttribute("fill-opacity",0+(j-0)*p/100)}else{d.setAttribute("fill-opacity","")}if(t.getAttribute("stroke-opacity")!==""){k=g(t,"stroke-opacity");d.setAttribute("stroke-opacity",0+(k-0)*p/100)}else{d.setAttribute("stroke-opacity","")}}}};return a});define('sap/viz/controls/chart/morph/morphers/RectMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(M,S){var R={};R.NO_DEFAULT_DIRECTION=0;R.DEFAULT_DIRECTION_TO_NORTH=1;R.DEFAULT_DIRECTION_TO_SOUTH=2;R.DEFAULT_DIRECTION_TO_EAST=4;R.DEFAULT_DIRECTION_TO_WEST=8;R.getPercentageRect=function(f,t,p){return{w:f.w+(t.w-f.w)*p/100,h:f.h+(t.h-f.h)*p/100,x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,r:f.r+(t.r-f.r)*p/100}};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r};R.svg=function(f,t,d,p,b){if(d&&t&&t.localName==="rect"){var c;var e;var h;var i;var j;var k;if(S.get(t,M.MORPHER_DISABLE_RECT)===true){c=a(t,"x");e=a(t,"rx");h=a(t,"y");i=a(t,"ry");j=a(t,"width");k=a(t,"height");var l=a(d,"x");var m=a(d,"rx");var n=a(d,"y");var o=a(d,"ry");var q=a(d,"width");var r=a(d,"height");if(c!==l){d.setAttribute("x",c)}if(e!==m){d.setAttribute("rx",e)}if(h!==n){d.setAttribute("y",h)}if(i!==o){d.setAttribute("ry",i)}if(j!==q){d.setAttribute("width",j)}if(k!==r){d.setAttribute("height",k)}}else if(f&&f.localName==="rect"){var s=a(f,"x");c=a(t,"x");var u=a(f,"rx");e=a(t,"rx");var v=a(f,"y");h=a(t,"y");var w=a(f,"ry");i=a(t,"ry");var x=a(f,"width");j=a(t,"width");var y=a(f,"height");k=a(t,"height");var z=(x>=1&&y>=1);var A=(j>=1&&k>=1);if(!z&&!A){p=100}d.setAttribute("x",s+(c-s)*p/100);d.setAttribute("y",v+(h-v)*p/100);d.setAttribute("rx",u+(e-u)*p/100);d.setAttribute("ry",w+(i-w)*p/100);d.setAttribute("width",x+(j-x)*p/100);d.setAttribute("height",y+(k-y)*p/100)}else if(!f){c=a(t,"x");e=a(t,"rx");h=a(t,"y");i=a(t,"ry");j=a(t,"width");k=a(t,"height");if(b==null||b<0){b=R.DEFAULT_DIRECTION_TO_NORTH|R.DEFAULT_DIRECTION_TO_WEST}if((b&R.DEFAULT_DIRECTION_TO_NORTH)&&(b&R.DEFAULT_DIRECTION_TO_SOUTH)){d.setAttribute("y",h+(k-0)*(100-p)/100/2);d.setAttribute("height",0+(k-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_NORTH){d.setAttribute("y",h+(k-0)*(100-p)/100);d.setAttribute("height",0+(k-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_SOUTH){d.setAttribute("y",h);d.setAttribute("height",0+(k-0)*p/100)}else{d.setAttribute("y",h);d.setAttribute("height",k)}if((b&R.DEFAULT_DIRECTION_TO_EAST)&&(b&R.DEFAULT_DIRECTION_TO_WEST)){d.setAttribute("x",c+(j-0)*(100-p)/100/2);d.setAttribute("width",0+(j-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_EAST){d.setAttribute("x",c+(j-0)*(100-p)/100);d.setAttribute("width",0+(j-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_WEST){d.setAttribute("x",c);d.setAttribute("width",0+(j-0)*p/100)}else{d.setAttribute("x",c);d.setAttribute("width",j)}}}};return R});define('sap/viz/controls/chart/morph/morphers/LineMorpher',[],function(){var L={};L.getPercentageLine=function(f,t,p){return{x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,x2:f.x2+(t.x2-f.x2)*p/100,y2:f.y2+(t.y2-f.y2)*p/100}};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r};L.svg=function(f,t,d,p){if(d&&t&&t.localName==="line"){var b;var c;var e;var h;if(f&&f.localName==="rect"){var i=a(f,"x1");b=a(t,"x1");var j=a(f,"x2");c=a(t,"x2");var k=a(f,"y1");e=a(t,"y1");var l=a(f,"y2");h=a(t,"y2");d.setAttribute("x1",i+(b-i)*p/100);d.setAttribute("y1",k+(e-k)*p/100);d.setAttribute("x2",j+(c-j)*p/100);d.setAttribute("y2",l+(h-l)*p/100)}else if(!f){b=a(t,"x1");c=a(t,"x2");e=a(t,"y1");h=a(t,"y2");d.setAttribute("x1",b);d.setAttribute("y1",e);d.setAttribute("x2",0+(c-0)*p/100);d.setAttribute("y2",0+(h-0)*p/100)}}};return L});define('sap/viz/controls/chart/morph/morphers/PathMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(u,C,M,S){var e="concat",f="apply",g="hasOwnProperty",s="split",l=String.prototype.toLowerCase,m=String.prototype.toUpperCase,n=parseFloat,o=parseInt,q=Math,v=q.max,w=q.min,A=q.abs,B=q.pow,P=q.PI,D="number",E="string",F="array",G="toString";var H=/,?([achlmqrstvxz]),?/gi,I=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,J=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;var _=function(i){return i?i.join(",").replace(H,"$1"):this.join(",").replace(H,"$1")};var K=function(c,z){var d=[];for(var i=0,a=c.length;a-2*!z>i;i+=2){var p=[{x:+c[i-2],y:+c[i-1]},{x:+c[i],y:+c[i+1]},{x:+c[i+2],y:+c[i+3]},{x:+c[i+4],y:+c[i+5]}];if(z){if(!i){p[0]={x:+c[a-2],y:+c[a-1]}}else if(a-4===i){p[3]={x:+c[0],y:+c[1]}}else if(a-2===i){p[2]={x:+c[0],y:+c[1]};p[3]={x:+c[2],y:+c[3]}}}else{if(a-4===i){p[3]=p[2]}else if(!i){p[0]={x:+c[i],y:+c[i+1]}}}d.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y])}return d};var L=function(p){if(!p){return null}var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},h=[];if(!h.length){String(p).replace(I,function(a,b,c){var i=[],j=b.toLowerCase();c.replace(J,function(a,b){b&&i.push(+b)});if(j==="m"&&i.length>2){h.push([b][e](i.splice(0,2)));j="l";b=b==="m"?"l":"L"}if(j==="r"){h.push([b][e](i))}else{while(i.length>=d[j]){h.push([b][e](i.splice(0,d[j])));if(!d[j]){break}}}})}h.toString=_;return h};var N=function(p){if(!u.isArray(p)||!u.isArray(p&&p[0])){p=L(p)}if(!p||!p.length){return[["M",0,0]]}var a=[],x=0,y=0,b=0,c=0,d=0;if(p[0][0]==="M"){x=+p[0][1];y=+p[0][2];b=x;c=y;d++;a[0]=["M",x,y]}var h=p.length===3&&p[0][0]==="M"&&p[1][0].toUpperCase()==="R"&&p[2][0].toUpperCase()==="Z";for(var r,t,i=d,z=p.length;i<z;i++){a.push(r=[]);t=p[i];if(t[0]!=m.call(t[0])){r[0]=m.call(t[0]);switch(r[0]){case"A":r[1]=t[1];r[2]=t[2];r[3]=t[3];r[4]=t[4];r[5]=t[5];r[6]=+(t[6]+x);r[7]=+(t[7]+y);break;case"V":r[1]=+t[1]+y;break;case"H":r[1]=+t[1]+x;break;case"R":var X=[x,y][e](t.slice(1));for(var j=2,Y=X.length;j<Y;j++){X[j]=+X[j]+x;X[++j]=+X[j]+y}a.pop();a=a[e](K(X,h));break;case"M":b=+t[1]+x;c=+t[2]+y;break;default:for(j=1,Y=t.length;j<Y;j++){r[j]=+t[j]+((j%2)?x:y)}}}else if(t[0]==="R"){X=[x,y][e](t.slice(1));a.pop();a=a[e](K(X,h));r=["R"][e](t.slice(-2))}else{for(var k=0,Z=t.length;k<Z;k++){r[k]=t[k]}}switch(r[0]){case"Z":x=b;y=c;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":b=r[r.length-2];c=r[r.length-1];break;default:x=r[r.length-2];y=r[r.length-1]}}a.toString=_;return a};var O=function(x,y,a,b){return[x,y,a,b,a,b]};var Q=function(x,y,a,b,c,d){var h=1/3,i=2/3;return[h*x+i*a,h*y+i*b,h*c+i*a,h*d+i*b,c,d]};var R=function(a,b,r,c,d,j,p,z,Z,$){var a1=P*120/180,b1=P/180*(+d||0),d1=[],xy,g1=C.func(function(x,y,b1){var X=x*q.cos(b1)-y*q.sin(b1),Y=x*q.sin(b1)+y*q.cos(b1);return{x:X,y:Y}});if(!$){xy=g1(a,b,-b1);a=xy.x;b=xy.y;xy=g1(z,Z,-b1);z=xy.x;Z=xy.y;var h1=q.cos(P/180*d),i1=q.sin(P/180*d),x=(a-z)/2,y=(b-Z)/2;var h=(x*x)/(r*r)+(y*y)/(c*c);if(h>1){h=q.sqrt(h);r=h*r;c=h*c}var j1=r*r,k1=c*c,k=(j==p?-1:1)*q.sqrt(A((j1*k1-j1*y*y-k1*x*x)/(j1*y*y+k1*x*x))),cx=k*r*y/c+(a+z)/2,cy=k*-c*x/r+(b+Z)/2,f1=q.asin(((b-cy)/c).toFixed(9)),f2=q.asin(((Z-cy)/c).toFixed(9));f1=a<cx?P-f1:f1;f2=z<cx?P-f2:f2;f1<0&&(f1=P*2+f1);f2<0&&(f2=P*2+f2);if(p&&f1>f2){f1=f1-P*2}if(!p&&f2>f1){f2=f2-P*2}}else{f1=$[0];f2=$[1];cx=$[2];cy=$[3]}var df=f2-f1;if(A(df)>a1){var q1=f2,r1=z,t1=Z;f2=f1+a1*(p&&f2>f1?1:-1);z=cx+r*q.cos(f2);Z=cy+c*q.sin(f2);d1=R(z,Z,r,c,d,0,p,r1,t1,[f2,q1,cx,cy])}df=f2-f1;var c1=q.cos(f1),s1=q.sin(f1),c2=q.cos(f2),s2=q.sin(f2),t=q.tan(df/4),hx=4/3*r*t,hy=4/3*c*t,m1=[a,b],m2=[a+hx*s1,b-hy*c1],m3=[z+hx*s2,Z-hy*c2],m4=[z,Z];m2[0]=2*m1[0]-m2[0];m2[1]=2*m1[1]-m2[1];if($){return[m2,m3,m4][e](d1)}else{d1=[m2,m3,m4][e](d1).join()[s](",");var E1=[];for(var i=0,ii=d1.length;i<ii;i++){E1[i]=i%2?g1(d1[i-1],d1[i],b1).y:g1(d1[i],d1[i+1],b1).x}return E1}};var T=function(a,b){var p=N(a),c=b&&N(b),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},k=function(a,d){var Z,$;if(!a){return["C",d.x,d.y,d.x,d.y,d.x,d.y]}!(a[0]in{T:1,Q:1})&&(d.qx=d.qy=null);switch(a[0]){case"M":d.X=a[1];d.Y=a[2];break;case"A":a=["C"][e](R[f](0,[d.x,d.y][e](a.slice(1))));break;case"S":Z=d.x+(d.x-(d.bx||d.x));$=d.y+(d.y-(d.by||d.y));a=["C",Z,$][e](a.slice(1));break;case"T":d.qx=d.x+(d.x-(d.qx||d.x));d.qy=d.y+(d.y-(d.qy||d.y));a=["C"][e](Q(d.x,d.y,d.qx,d.qy,a[1],a[2]));break;case"Q":d.qx=a[1];d.qy=a[2];a=["C"][e](Q(d.x,d.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][e](O(d.x,d.y,a[1],a[2]));break;case"H":a=["C"][e](O(d.x,d.y,a[1],d.y));break;case"V":a=["C"][e](O(d.x,d.y,d.x,a[1]));break;case"Z":a=["C"][e](O(d.x,d.y,d.X,d.Y));break}return a},r=function(d,i){if(d[i].length>7){d[i].shift();var Z=d[i];while(Z.length){d.splice(i++,0,["C"][e](Z.splice(0,6)))}d.splice(i,1);x=v(p.length,c&&c.length||0)}},t=function(d,b,Z,$,i){if(d&&b&&d[i][0]==="M"&&b[i][0]!=="M"){b.splice(i,0,["M",$.x,$.y]);Z.bx=0;Z.by=0;Z.x=d[i][1];Z.y=d[i][2];x=v(p.length,c&&c.length||0)}};for(var i=0,x=v(p.length,c&&c.length||0);i<x;i++){p[i]=k(p[i],h);r(p,i);c&&(c[i]=k(c[i],j));c&&r(c,i);t(p,c,h,j,i);t(c,p,j,h,i);var y=p[i],z=c&&c[i],X=y.length,Y=c&&z.length;h.x=y[X-2];h.y=y[X-1];h.bx=n(y[X-4])||h.x;h.by=n(y[X-3])||h.y;j.bx=c&&(n(z[Y-4])||j.x);j.by=c&&(n(z[Y-3])||j.y);j.x=c&&z[Y-2];j.y=c&&z[Y-1]}return c?[p,c]:p};var U=null;var V=function(p,a){if(!U){U=C.func(T)}return U(p,a)};var W={};W.getPercentagePath=function(a,t,p){if(!a||!t){return""}var c=V(String(a),String(t));var b=c[0];var d=c[1];var h=[];for(var i=0,k=b.length;i<k;i++){h[i]=[b[i][0]];for(var j=1,r=b[i].length;j<r;j++){h[i][j]=b[i][j]+(d[i][j]-b[i][j])*p/100}}return _(h)};W.svg=function(a,t,d,p){if(d&&t&&t.localName=="path"&&(!a||a.localName=="path")){var b=t.getAttribute("d");if(b&&b.length>1){var c;if(S.get(t,M.MORPHER_DISABLE_PATH)===true){c=d.getAttribute("d");if(b!==c){d.setAttribute("d",b)}}else{var h="";if(a){h=a.getAttribute("d")}if(!h){var i=b.match(I);if(i.length>0){h=i[0]}else{h="M0,0"}}c=W.getPercentagePath(h,b,p);d.setAttribute("d",c)}}}};return W});define('sap/viz/controls/chart/morph/utils/TransformParser',[],function(){var T={};var t=function(s){return s.replace(/^\s*/,"").replace(/\s*$/,"")};T.parse=function(a){var r=[];var b=[];var s=[];if(a){var c;if(a.indexOf("rotate(")>=0){var d=a.substring(a.indexOf("rotate("));d=d.substring("rotate(".length,d.indexOf(")"));d=t(d);var e=[];if(d.indexOf(",")>0){e=d.split(",")}else{e=d.split(" ")}for(var i=0;i<e.length&&r.length<3;i++){c=t(e[i]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0}r.push(c)}}if(r.length<3){r[1]=0;r[2]=0}}if(a.indexOf("translate(")>=0){var f=a.substring(a.indexOf("translate("));f=f.substring("translate(".length,f.indexOf(")"));f=t(f);var g=[];if(f.indexOf(",")>0){g=f.split(",")}else{g=f.split(" ")}for(var j=0;j<g.length&&b.length<2;j++){c=t(g[j]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0}b.push(c)}}if(b.length<2){b[1]=0}}if(a.indexOf("scale(")>=0){var h=a.substring(a.indexOf("scale("));h=h.substring("scale(".length,h.indexOf(")"));h=t(h);var l=[];if(h.indexOf(",")>0){l=h.split(",")}else{l=h.split(" ")}for(var k=0;k<l.length&&s.length<2;k++){c=t(l[k]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0}s.push(c)}}if(s.length<2){s[1]=0}}}return{rotate:r.length>0?r:null,translate:b.length>0?b:null,scale:s.length>0?s:null}};return T});define('sap/viz/controls/chart/morph/morphers/TransformMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/TransformParser'],function(M,S,T){var a={};a.applyTransform=function(f,b,t,c,p){var x=f+(t-f)*p/100;var y=b+(c-b)*p/100;return"translate("+x+","+y+")"};a.svg=function(f,t,d,p,u){if(d&&t){var c="";if(f){var b=T.parse(f.getAttribute("transform"));var e=T.parse(t.getAttribute("transform"));if(u){if(b.translate||e.translate){if(!b.translate){b.translate=[0,0]}if(!e.translate){e.translate=[0,0]}c+=(c?" ":"")+"translate("+(b.translate[0]+(e.translate[0]-b.translate[0])*p/100)+","+(b.translate[1]+(e.translate[1]-b.translate[1])*p/100)+")"}}else{var g=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var h=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var i=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var j=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var k=g+(i-g)*p/100;var l=h+(j-h)*p/100;c+=(c?" ":"")+"translate("+k+","+l+")"}if(b.rotate||e.rotate){if(!b.rotate){b.rotate=[0,0,0]}if(!e.rotate){e.rotate=[0,0,0]}c+=(c?" ":"")+"rotate("+(b.rotate[0]+(e.rotate[0]-b.rotate[0])*p/100)+","+(b.rotate[1]+(e.rotate[1]-b.rotate[1])*p/100)+","+(b.rotate[2]+(e.rotate[2]-b.rotate[2])*p/100)+")"}if(b.scale||e.scale){if(!b.scale){b.scale=[0,0]}if(!e.scale){e.scale=[0,0]}c+=(c?" ":"")+"scale("+(b.scale[0]+(e.scale[0]-b.scale[0])*p/100)+","+(b.scale[1]+(e.scale[1]-b.scale[1])*p/100)+")"}d.setAttribute("transform",c)}}};return a});define('sap/viz/controls/chart/morph/morphers/TextMorpher',['sap/viz/controls/chart/morph/morphers/TransformMorpher'],function(T){var a={};var g=function(s,d){var e=parseInt(s.getAttribute(d),10);return isNaN(e)?0:e};var b=function(s,d){var e=parseFloat(s.getAttribute(d));return isNaN(e)?0:e};var r=/(\d+)(in|cm|mm|pt|pc|em|ex|px)/i;var c=function(f,t,p){var d=r.exec(f);if(!d){d=[f,f,""]}var e=parseInt(d[1],10);var h=d[2];var i=r.exec(t);if(!i){i=[t,t,""]}var j=parseInt(i[1],10);var k=i[2];var l=e;switch(h){case"pt":l=l*1.33;break;case"px":l=l;break;default:l=l}switch(k){case"pt":l=l/1.33;break;case"px":l=l;break;default:l=l}return String(Math.round(l+(j-l)*p/100))+k};a.svg=function(f,t,d,p){if(d&&t.localName==="g"&&t.firstChild&&t.firstChild.localName==="text"){if(f&&f.localName==="g"&&f.firstChild&&f.firstChild.localName==="text"){var e=b(f.firstChild,"x");var h=b(t.firstChild,"x");var i=b(f.firstChild,"y");var j=b(t.firstChild,"y");d.firstChild.setAttribute("x",e+(h-e)*p/100);d.firstChild.setAttribute("y",i+(j-i)*p/100);var k=f.getAttribute("font-size");var l=t.getAttribute("font-size");if(k&&l&&k!=l){var m=c(k,l,p);d.setAttribute("font-size",m)}T.svg(f.firstChild,t.firstChild,d.firstChild,p,true)}else if(!f){d.setAttribute("opacity",p/100)}}};return a});define('sap/viz/controls/chart/morph/VizMorpher',['jquery','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder','sap/viz/controls/chart/morph/viz/MpShapesCapturer','sap/viz/controls/chart/morph/viz/MpShapesMapper','sap/viz/controls/chart/morph/morphers/ColorMorpher','sap/viz/controls/chart/morph/morphers/RectMorpher','sap/viz/controls/chart/morph/morphers/LineMorpher','sap/viz/controls/chart/morph/morphers/PathMorpher','sap/viz/controls/chart/morph/morphers/TextMorpher','sap/viz/controls/chart/morph/morphers/TransformMorpher'],function($,M,u,S,V,a,b,c,C,R,L,P,T,d){var e=function(v,i){this._vizDiv=v;this._morphDiv=i;this._currentVizType="";this._currentVizShapesHolder=new a();this._tween=null};e.prototype.resetMorphSvg=function(){var v=g(this._vizDiv);var i=v.width();var j=v.height();var k=g(this._morphDiv);k.empty();var l=g(document.createElement("DIV"));l.css("overflow","hidden").appendTo(k).width(i).height(j);var n=v.find("svg");if(n.length>0){l.attr("class","vc-morph-svg-host "+n.parent().attr("class"))}return d3.select(l.get(0)).append("svg").attr("width",i).attr("height",j).node()};e.prototype.getCurrentVizType=function(){return this._currentVizType};e.prototype.isPlaying=function(){return(this._tween!==null)};e.prototype.showMorphing=function(i,v){var j=g(this._morphDiv);var k=g(this._vizDiv);if(i){j.css("display","")}else{j.css("display","none")}if(v){k.css("visibility","visible")}else{k.css("visibility","hidden")}};e.prototype.morphVizType=function(n,i,j){i=u.isNumber(i)?i:1000;n=u.isString(n)?n:this.getCurrentVizType();var v=g(this._vizDiv);var k=g(this._morphDiv);if(this._tween){this._tween.stop(true,false);this._tween=null;v.css("visibility","visible");k.css("display","none")}var l=b.getShapes(v.get(0));var o=f(l);var s=(o&&i>0);if(o){c.map(l,this._currentVizShapesHolder,n,this._currentVizType);var q=l.allByOrder();var r=this.resetMorphSvg();if(s){v.css("visibility","hidden");k.css("display","");p(r,q,0);var t=this;this._startMorphShapes(q,i,function(){v.css("visibility","visible");k.css("display","none");if(t._tween){t._tween.stop(true,false)}t._tween=null;if(u.isFunction(j)){j.call(null)}})}else{p(r,q,100);this._tween=null;v.css("visibility","visible");k.css("display","none");if(u.isFunction(j)){j.call(null)}}}else{l.empty();this.resetMorphSvg();this._tween=null;v.css("visibility","visible");k.css("display","none");if(u.isFunction(j)){j.call(null)}}this._currentVizType=n;this._currentVizShapesHolder=l};var f=function(n){var t=n.toShapesBySvgType();if(t["all"].length>n.backgrounds.length){if(t["path"]&&t["path"].length>200){return false}if(t["rect"]&&t["rect"].length>300){return false}if(t["all"].length>400){return false}return true}return false};e.prototype._startMorphShapes=function(v,i,j){this._tween=$({percentage:1});this._tween.animate({percentage:100},{duration:i,easing:"swing",step:function(){var k=this.percentage;m(v,k)},complete:function(){j()}})};var g=function(i){if(u.isString(i)){if(i.indexOf("#")!==0){return $("#"+i)}}return $(i)};var p=function(s,v,j){j=j?j:0;for(var i=0;i<v.length;i++){var k=v[i];var l=k.from;var t=k.to;if(t){var n=k.display=t.cloneNode(true);S.clone(n,t);if(j!==100){h(l,t,n,j)}s.appendChild(n)}}};var m=function(v,j){for(var i=0;i<v.length;i++){var k=v[i];var l=k.from;var t=k.to;var n=k.display;h(l,t,n,j)}};var h=function(i,t,j,k){R.svg(i,t,j,k);L.svg(i,t,j,k);P.svg(i,t,j,k);C.svg(i,t,j,k);T.svg(i,t,j,k);d.svg(i,t,j,k)};e.prototype.testDrawShapes=function(n,i){var v=g(this._vizDiv);var j=g(this._morphDiv);var k=b.getShapes(v.get(0));c.map(k,this._currentVizShapesHolder,n,this._currentVizType);var l=k.allByOrder();var o=this.resetMorphSvg();p(o,l,i);this._currentVizType=n;this._currentVizShapesHolder=k};return e});define('sap/viz/controls/chart/views/PropertyZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,C,O,E,a){var P=function(t,z){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._selectedZone$=null;var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s)};O.extend(P,a);P.SELECT_ZONE='SELECT_ZONE_EVENT';P.prototype._createZones=function(){this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();for(var i=0;i<z.length;i++){var b=z[i].bound;for(var n=0;n<b.length;n++){this._createZone(this._dom[0],b[n],z[i].name)}}};P.prototype._createZone=function(p,b,z){var d=$(document.createElement("DIV"));var l=b[0][0],t=b[0][1],w=b[2][0]-b[0][0],h=b[2][1]-b[0][1];var s="left:"+l+"px;top:"+t+"px;width:"+w+"px;height:"+h+"px;";d.attr('style',s).addClass(C.CHART_PREFIX+'property-zone').appendTo(p);d.get(0).__name=z;d.click($.proxy(this._selectZone,this))};P.prototype._selectZone=function(e){var c=$(e.target);if(this._selectedZone$!==c){if(this._selectedZone$){this._selectedZone$.removeClass(C.CHART_PREFIX+'property-zone-selected')}this._selectedZone$=c;this._selectedZone$.addClass(C.CHART_PREFIX+'property-zone-selected');var b={'propertyZoneName':this._selectedZone$.get(0).__name};this._dispatchEvent(new E(P.SELECT_ZONE,this,b))}};P.prototype.updateZone=function(e){if(e){this._createZones();this._dom.css('visibility','')}else{this._dom.css('visibility','hidden')}};P.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"})}};return P});define("sap/viz/controls/LanguageLoader",[],function(){sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_COMMON_BAR_TEXT:"Bar Chart",VIZ_COMMON_COLUMN_TEXT:"Column Chart",VIZ_COMMON_STACKED_BAR_TEXT:"Stacked Bar Chart",VIZ_COMMON_STACKED_COLUMN_TEXT:"Stacked Column Chart",VIZ_COMMON_DUAL_BAR_TEXT:"Bar Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COLUMN_TEXT:"Column Chart With 2 Y-Axes",VIZ_COMMON_3D_BAR_TEXT:"3D Bar Chart",VIZ_COMMON_3D_COLUMN_TEXT:"3D Column Chart",VIZ_COMMON_LINE_TEXT:"Line Chart",VIZ_COMMON_AREA_TEXT:"Area Chart",VIZ_COMMON_COMBINATION_TEXT:"Combined Column Line Chart",VIZ_COMMON_DUAL_LINE_TEXT:"Line Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COMBINATION_TEXT:"Combined Column Line Chart With 2 Y-Axes",VIZ_COMMON_PIE_TEXT:"Pie Chart",VIZ_COMMON_DONUT_TEXT:"Donut Chart",VIZ_COMMON_PIE_WITH_DEPTH_TEXT:"Pie With Variable Slice Depth",VIZ_COMMON_GEOBUBBLE_TEXT:"Geographic Bubble Chart",VIZ_COMMON_CHOROPLETH_TEXT:"Geo Choropleth Chart",VIZ_COMMON_GEOPIE_TEXT:"Geo Pie Chart",VIZ_COMMON_GEOMAP_TEXT:"Geo Map",VIZ_COMMON_SCATTER_TEXT:"Scatter Plot",VIZ_COMMON_BUBBLE_TEXT:"Bubble Chart",VIZ_COMMON_SCATTER_MATRIX_TEXT:"Scatter Matrix Chart",VIZ_COMMON_TREEMAP_TEXT:"Tree Map",VIZ_COMMON_HEATMAP_TEXT:"Heat Map",VIZ_COMMON_TABLE_TEXT:"Table",VIZ_COMMON_CROSSTAB_TEXT:"Crosstab",VIZ_COMMON_RADAR_TEXT:"Radar Chart",VIZ_COMMON_BOXPLOT_TEXT:"Box Plot",VIZ_COMMON_WATERFALL_TEXT:"Waterfall Chart",VIZ_COMMON_TAGCLOUD_TEXT:"Tag Cloud",VIZ_COMMON_MEASURES:"MEASURES",VIZ_COMMON_DIMENSIONS:"DIMENSIONS",VIZ_COMMON_SUBTOTALS:"SUBTOTALS",VIZ_COMMON_ANIMATION:"Animation",VIZ_COMMON_TRELLIS:"TRELLIS",VIZ_COMMON_XAXIS:"X Axis",VIZ_COMMON_YAXIS:"Y Axis",VIZ_COMMON_PRIMARY_YAXIS:"Y Axis1",VIZ_COMMON_SECONDARY_YAXIS:"Y Axis2",VIZ_COMMON_PRIMARY_XAXIS:"X Axis1",VIZ_COMMON_SECONDARY_XAXIS:"X Axis2",VIZ_COMMON_PIE_SECTORS:"Pie Sectors",VIZ_COMMON_PIE_DEPTH:"Pie Depth",VIZ_COMMON_FEATUREVALUES:"Value",VIZ_COMMON_BUBBLE_WIDTH:"Bubble Width",VIZ_COMMON_BUBBLE_HEIGHT:"Bubble Height",VIZ_COMMON_RECTANGLECOLOR:"Area Color",VIZ_COMMON_RECTANGLEWEIGHT:"Area Weight",VIZ_COMMON_REGIONCOLOR:"Legend Color",VIZ_COMMON_GEO_FEATURES:"Geography",VIZ_COMMON_GEO_COLOR:"Color",VIZ_COMMON_FEATUREANALYSIS:"Overlay Data",VIZ_COMMON_REGIONSHAPE:"Legend Shape",VIZ_COMMON_AREANAME:"Area Name",VIZ_COMMON_SECONDARY_AREANAME:"Area Name2",VIZ_COMMON_RADAR_AXES:"Radar Branches",VIZ_COMMON_TAGWEIGHT:"Word Weight",VIZ_COMMON_TAGFAMILY:"Word Color",VIZ_COMMON_TAGNAME:"Word",VIZ_COMMON_COLUMNS:"Columns",VIZ_COMMON_ROWS:"Rows",VIZ_COMMON_TABLE_DIMENSION:"Rows Axis",VIZ_COMMON_TABLE_MEASURE:"Primary Values",VIZ_COMMON_TABLE_ROWS_SUBTOTALS:"Rows Subtotals",VIZ_COMMON_TABLE_COLUMNS_AXIS:"Columns Axis",VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS:"Columns Subtotals",VIZ_COMMON_LEGEND:"Legend",VIZ_COMMON_DIMENSION_LIMITATION_WARN:"You have reached the maximum number of dimension feeds for this visualization.",VIZ_COMMON_CHANGE_CALCULATION:"Change Calculation",VIZ_COMMON_SUM:"Sum",VIZ_COMMON_AVERAGE:"Average",VIZ_COMMON_MIN:"Min",VIZ_COMMON_MAX:"Max",VIZ_COMMON_COUNT_DISTINCT:"Count-Distinct",VIZ_COMMON_COUNT_ALL:"Count-All",VIZ_COMMON_NONE:"None",VIZ_COMMON_SUM_SHORT:"(Sum)",VIZ_COMMON_AVERAGE_SHORT:"(Avg)",VIZ_COMMON_MIN_SHORT:"(Min)",VIZ_COMMON_MAX_SHORT:"(Max)",VIZ_COMMON_COUNT_DISTINCT_SHORT:"(Cnt-Dis)",VIZ_COMMON_COUNT_ALL_SHORT:"(Cnt-All)",VIZ_COMMON_NONE_SHORT:"(None)",VIZ_COMMON_TOTAL_OF:"Total of",VIZ_COMMON_SUM_OF:"Sum of",VIZ_COMMON_AVERAGE_OF:"Average of",VIZ_COMMON_COUNT_OF:"Count of",VIZ_COMMON_MIN_OF:"Minimum of",VIZ_COMMON_MAX_OF:"Maximum of",VIZ_COMMON_EDIT:"Edit",VIZ_COMMON_DELETE:"Delete",VIZ_COMMON_DELETE_COMMENT_MESSAGE:"Are you sure to delete the comment?",VIZ_COMMON_DONT_SHOW_MESSAGE:"Don't show this again",VIZ_COMMON_OK:"OK",VIZ_COMMON_CANCEL:"Cancel",VIZ_COMMON_BETWEEN:"BETWEEN",VIZ_COMMON_SEARCH:"Search",VIZ_COMMON_FAKE_DIMENSION:"Dimension",VIZ_COMMON_FAKE_MEASURE:"Measure",VIZ_COMMON_SERIALIZATION_FAILED:"Serialization error",VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE:"Invalid serialization package",VIZ_COMMON_DEPENDENCY_ERROR:"Please include {0} when use {1}.",VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG:"Please include {0} when use {1} with {2}.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_ANNOTATION_COMMENT:"Comment",}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CHART_INCOMPLETE_DESCRIPTION:"Please add more measures or dimensions.",VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION:"Please add more geography dimensions.",VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION:"Please add more measures.",VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION:"Please add more dimensions.",VIZ_CHART_CREATE_CHART_FAILED:"Failed to create chart:",VIZ_CHART_UPDATE_CHART_FAILED:"Failed to update chart:",VIZ_CHART_UPDATE_DATA_FAILED:"Failed to update chart data:",VIZ_CHART_UPDATE_FEEDING_FAILED:"Failed to update chart feeding:",VIZ_CHART_UPDATE_CSS_FAILED:"Failed to update chart css:",VIZ_CHART_UPDATE_PROPERTIES_FAILED:"Failed to update chart properties:",VIZ_CHART_ADD_EVENT_FAILED:"Failed to add chart event callback:",VIZ_CHART_REMOVE_EVENT_FAILED:"Failed to remove chart event callback:",VIZ_CHART_SELECTION_FAILED:"Failed to get/set chart selection:",VIZ_CHART_FEEDINGZONE_FAILED:"Failed to get chart feedingzone:",VIZ_CHART_DESCRIPTION_FAILED:"Failed to get/set chart description:",VIZ_CHART_TRIGGER_ACTION_FAILED:"Failed to trigger chart action:",VIZ_CHART_SERIALIZE_FAILED:"Failed to serialize chart:",VIZ_CHART_VIZINSTANCE_NOT_CREATED:"VizInstance is not created.",VIZ_CHART_INVALID_VIZ_TYPE:"Cannot display this chart: {0}.",VIZ_CHART_TRELLIS_DISABLED_WARN:"The trellis is disabled in either Viz Frame or Feeding Panel.",VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER:"No data matches your filter(s)",VIZ_CHART_NEGATIVE_VALUES_WARN:"Negative values are not shown in this Bubble chart",VIZ_CHART_NEGATIVE_VALUES_INFO:"To display negative values, click the Settings button and select Show Negative Values from the contextual menu.",VIZ_CHART_TITLE_TEXT_JOIN_BY:"{0} by {1}",VIZ_CHART_TITLE_TEXT_JOIN_AND:"and",VIZ_CHART_TITLE_CONTEXT_MENU_EDIT:"Rename",VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE:"Restore Default Title",VIZ_CONTROLS_API_PARAMETER_ERROR:"API parameter error.",VIZ_CHART_EXPORTSVG_FAILED:"Failed to export to svg string.",VIZ_CHART_SET_AXIS_RANGE:"Set axis range",VIZ_CHART_AXIS_ZOOM:"Zoom",VIZ_CHART_XAXIS_RANGE:"X Axis Range",VIZ_CHART_XAXIS1_RANGE:"X Axis1 Range",VIZ_CHART_XAXIS2_RANGE:"X Axis2 Range",VIZ_CHART_YAXIS_RANGE:"Y Axis Range",VIZ_CHART_YAXIS1_RANGE:"Y Axis1 Range",VIZ_CHART_YAXIS2_RANGE:"Y Axis2 Range",VIZ_CHART_AUTO_RANGE:"Automatic",VIZ_CHART_FIXED_RANGE:"Fixed",VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE:"Import Esri Custom Service",VIZ_CHART_NEXT:"Next",VIZ_CHART_SELECT_DATASET:"Select data set",VIZ_CHART_SET_COLOR_LAYER:"Set color to feature layer",VIZ_CHART_RESET:"Reset",VIZ_CHART_SEGMENTED:"Segmented",VIZ_CHART_GRADIENT:"Gradient",VIZ_CHART_BACK:"Back",VIZ_CHART_CONFIRM:"Confirm",VIZ_CHART_ESRI_MAP_LOADING:"Loading Esri Map",VIZ_CHART_ESRI_MAP_LOG_ON:"Logging in to Esri now",VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL:"Esri Authentication Fail",VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE:"An unknown error has occurred while accessing ESRI online services. Check your internet connection",VIZ_CHART_START:"Start",VIZ_CHART_END:"End",VIZ_CHART_NO_ESRI_SERVICE:"No feature service found under your account.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CONTEXTMENU_SHOW_LEGEND:"Show Legend",VIZ_CONTEXTMENU_SHOW_DATALABELS:"Show Data Labels",VIZ_CONTEXTMENU_NORMAL_STACKING:"Normal Stacking",VIZ_CONTEXTMENU_FULL_STACKING:"100% Stacking",VIZ_CONTEXTMENU_HORIZONTAL:"Horizontal",VIZ_CONTEXTMENU_VERTICAL:"Vertical",VIZ_CONTEXTMENU_INSERT_COMMENT:"Insert Comment...",VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR:"Choose Legend Item Colors...",VIZ_CONTEXTMENU_MENU_CHART_EDITOR:"Chart Editor...",VIZ_CONTEXTMENU_SHOW_MND:"Use Measures as a Dimension",VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP:"Creates a new dimension with all the measures in the chart. The values are spread on a single axis, or separate charts for a trellis chart.",VIZ_CONTEXTMENU_NO_MENU_ITEMS:"No available items",VIZ_CONTEXTMENU_SHOW_TITLE:"Show Title",VIZ_CONTEXTMENU_SET_AXIS_SCALE:"Set Axis Scale",VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES:"Show Negative Values",VIZ_CONTEXTMENU_CREATE_SUBTOTALS:"Create Subtotals",VIZ_CONTEXTMENU_SHOW_BEFORE_ROWS:"Show Subtotals Below Rows",VIZ_CONTEXTMENU_SHOW_ABOVE_ROWS:"Show Subtotals Above Rows",VIZ_CONTEXTMENU_CALCULATE_ROWS_TOTALS_FIRST:"Calculate Rows Totals First",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CUSTOMBUTTON_SETTINGS:"Settings",VIZ_CUSTOMBUTTON_MAXIMIZE:"Maximize",VIZ_CUSTOMBUTTON_RESTORE_DOWN:"Restore Down",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FRAME_FILTERMENU_FILTER:"Filter",VIZ_FRAME_FILTERMENU_EXCLUDE:"Exclude",VIZ_FRAME_FILTERBAR_DESCRIPTION:"Select fields from the Data Set to filter.",VIZ_FRAME_CHART_EDITOR:"Chart Editor",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FILTERBAR_DESCRIPTION:"Add filters.",VIZ_FILTERBAR_GLOBAL_FILTER:"Global Filter:",VIZ_FILTERBAR_ITEMS_EXCLUDED:"items excluded",VIZ_FILTERBAR_ITEMS_INCLUDED:"items included",}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});sap.viz.extapi.env.Language.register({id:'dev',value:{}})});define("sap/viz/controls/TemplateLoader",[],function(){(function(){var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var e={dataLoading:false,dataUpdating:false,resizing:false};var m={color:a,gridline:{color:a},enableLabelSelection:false};var g={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var f={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var h={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},zAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var j={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},zAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var k={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var l={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var n={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:e,tooltipVisble:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var o={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:e},rowAxis:m,columnAxis:m,background:b,interaction:i};var p={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},tooltipVisble:false,animation:e},rowAxis:m,columnAxis:m,background:b,interaction:i};var q={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},animation:e},rowAxis:m,columnAxis:m,background:b,interaction:i};var r={xAxis:{color:a,label:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},sizeLegend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var s={xAxis:{color:a,label:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var t={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:e},multiLayout:{plotTitle:{visible:false},},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var u={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var v={plotArea:{animation:e},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var w={plotArea:{animation:e},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var x={plotArea:{animation:e},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var y={plotArea:{animation:e},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var z={plotArea:{animation:e},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var A={plotArea:{animation:e},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var B={title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{polarAxis:{title:{visible:false}},valueAxis:{visible:true,},animation:e},rowAxis:m,columnAxis:m,background:b,interaction:i};var C={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var D={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var E={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var F={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var G={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var H={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:e},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var I={plotArea:{animation:e,draggable:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var J={plotArea:{animation:e,clickAble:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",name:"Incomplete Ghost",version:"4.0.0",properties:{'viz/bar':f,'viz/image_bar':f,'viz/multi_bar':f,'viz/dual_bar':f,'viz/multi_dual_bar':f,'viz/column':g,'viz/multi_column':g,'viz/dual_column':g,'viz/multi_dual_column':g,'viz/stacked_bar':k,'viz/multi_stacked_bar':k,'viz/dual_stacked_bar':k,'viz/multi_dual_stacked_bar':k,'viz/100_stacked_bar':k,'viz/multi_100_stacked_bar':k,'viz/100_dual_stacked_bar':k,'viz/multi_100_dual_stacked_bar':k,'viz/stacked_column':l,'viz/multi_stacked_column':l,'viz/dual_stacked_column':l,'viz/multi_dual_stacked_column':l,'viz/100_stacked_column':l,'viz/multi_100_stacked_column':l,'viz/100_dual_stacked_column':l,'viz/multi_100_dual_stacked_column':l,'riv/cbar':g,'viz/stacked_column':l,'viz/multi_stacked_column':l,'viz/3d_bar':h,'viz/3d_column':j,'viz/combination':q,'viz/horizontal_combination':p,'viz/dual_combination':q,'viz/dual_horizontal_combination':p,'viz/boxplot':C,'viz/horizontal_boxplot':D,'viz/waterfall':E,'viz/horizontal_waterfall':F,'viz/stacked_waterfall':E,'viz/horizontal_stacked_waterfall':F,'viz/line':o,'viz/multi_line':o,'viz/dual_line':o,'viz/multi_dual_line':o,'viz/horizontal_line':n,'viz/multi_horizontal_line':n,'viz/dual_horizontal_line':n,'viz/multi_dual_horizontal_line':n,'viz/area':o,'viz/multi_area':o,'viz/100_area':o,'viz/multi_100_area':o,'viz/horizontal_area':n,'viz/multi_horizontal_area':n,'viz/100_horizontal_area':n,'viz/multi_100_horizontal_area':n,'viz/pie':x,'viz/multi_pie':x,'viz/donut':y,'viz/multi_donut':y,'viz/pie_with_depth':z,'viz/donut_with_depth':A,'viz/bubble':r,'viz/multi_bubble':r,'viz/scatter':s,'viz/multi_scatter':s,'viz/scatter_matrix':t,'viz/radar':B,'viz/multi_radar':B,'viz/tagcloud':w,'viz/heatmap':u,'viz/treemap':v,'viz/mekko':G,'viz/100_mekko':G,'viz/horizontal_mekko':H,'viz/100_horizontal_mekko':H,'viz/network':I,'viz/tree':J,'viz/number':{plotArea:{valuePoint:{label:{fontColor:'#000000'}}}}}})})();(function(){var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false};var e={dataLoading:false,dataUpdating:false};var m={color:a,gridline:{color:a},label:{visible:false}};var g={plotArea:{animation:e},title:{visible:false},legend:{visible:false},sizeLegend:{visible:false},background:b,interaction:i,rowAxis:m,columnAxis:m,geoController:{disableInteraction:true}};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/geobubble':g,'viz/geopie':g,'viz/choropleth':g,'viz/multi_geobubble':g,'viz/multi_choropleth':g}})})();var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var c={title:{visible:false},legend:{visible:false},background:b,interaction:i};var d={title:{visible:false},legend:{visible:false},background:b};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/ext/pa/funnel":c,"viz/ext/pa/pc":d},css:"		.v-m-main .v-background-body{fill:;}		 svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}		.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}	    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}	   .axistext{fill: #333333; cursor : move;}	",});var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var c={title:{visible:false},legend:{visible:false},background:b,interaction:i};var d={title:{visible:false},legend:{visible:false},background:b};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/ext/pa/funnel":c,"viz/ext/pa/pc":d},css:"		.v-m-main .v-background-body{fill:;}		 svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}		.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}	    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}	   .axistext{fill: #333333; cursor : move;}	",})});define('sap/viz/controls/chart/views/WarningView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/LangManager',],function($,O,V,U,C,a,E,L){var N=function(d,u){N.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.NegativeValuesView";this._createChildren()};O.extend(N,U);N.prototype._createChildren=function(){this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(a.CHART_PREFIX+'warning');this._container$=$(document.createElement('div'));$(document.createElement('div')).appendTo(this._container$).addClass(a.CHART_PREFIX+'warning-separator');var t=$(document.createElement('div')).appendTo(this._container$).addClass(a.CHART_PREFIX+'warning-title');var w=$(document.createElement('div')).appendTo(t);w.addClass(a.CHART_PREFIX+'warning-title-icon');var b=$(document.createElement('span')).appendTo(t).text(L.get("VIZ_CHART_NEGATIVE_VALUES_WARN"));b.addClass(a.CHART_PREFIX+'warning-title-text');var i=$(document.createElement('div')).appendTo(this._container$).addClass(a.CHART_PREFIX+'warning-info');var c=$(document.createElement('span')).appendTo(i).text(L.get("VIZ_CHART_NEGATIVE_VALUES_INFO"));c.addClass(a.CHART_PREFIX+'warning-info-text');var d=$(document.createElement('div')).appendTo(this._container$);d.addClass(a.CHART_PREFIX+'warning-delete-icon');d.addClass(a.COMMON_PREFIX+'UVBSharedSprite');d.click($.proxy(function(e){this.hide()},this));this._confirmDialog$.append(this._container$);this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(a.CHART_PREFIX+'block-layer')};N.prototype.show=function(t,p,b){this._visible=true;var l=this._dom$.offset().left+this._dom$.width()/2;var c=this._dom$.offset().top+this._dom$.height()/2;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);this._confirmDialog$.css({position:"absolute",left:l-this._confirmDialog$.width()/2,top:c-this._confirmDialog$.height()/2});this._container$.css({"display":"block"})};N.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};return N});define('sap/viz/controls/chart/views/View',['jquery','sap/viz/controls/LanguageLoader','sap/viz/controls/TemplateLoader','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/views/WarningView','sap/viz/controls/chart/ChartConfig','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalyticalType'],function($,L,T,G,C,M,F,b,c,O,u,d,D,f,V,g,U,h,k,W,l,I,m,A){var n=function(a,e,i,j,q,r){n.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.View";this._div=a;this._chartHolder$=null;this._chartLayer$=null;this._descriptionLayer$=null;this._loadingIcon$=null;this._chartModelProvider=j;this._helper=r;this._options=e;this._cssCache=null;this._libFolderPath=i;var s=sap.viz.api.env.Resource.path("sap.viz.geo.geographicInfo.localStorage.resourcePath");this._geoResourcePath=s?s:this._libFolderPath+"/sap.viz.geo/geocharts/resources/data/geo/";this._enableTrellis=true;this._enableMorphing=true;this._enablePropertyZone=false;this._hasChartInstance=false;this._size={width:n.DEFAULT_VIZ_WIDTH,height:n.DEFAULT_VIZ_HEIGHT};this._padding=24;this._chart=null;this._chartProxy=q;this._onEventMap={};this._isFeedsValid=false;this._templateId=n.TEMPLATE_DEFAULT;this._mouseDownHandler=$.proxy(function(t){if(document.activeElement&&document.activeElement.tagName&&document.activeElement.tagName.toLowerCase()!="body"&&!$.contains(this._dom$[0],document.activeElement)&&$.contains(this._dom$.parent()[0],t.target)){document.activeElement.blur()}},this);$(document).on('mousedown',this._mouseDownHandler);this._changeTemplateFunc=$.proxy(this.changeTemplate,this);sap.viz.extapi.env.Template.addListener(this._changeTemplateFunc)};O.extend(n,U);n.DEFAULT_VIZ_WIDTH=380;n.DEFAULT_VIZ_HEIGHT=280;n.TEMPLATE_DEFAULT="default";n.TEMPLATE_INCOMPLETE="incomplete_ghost";n.TEMPLATE_EMPTY="empty_ghost";n.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._createDescriptionLayer();this._createLoadingIcon();this._createWarningDialog()};n.prototype._createChartHolder=function(){this._chartHolder$=$(document.createElement('div')).addClass([g.PREFIX+'chart-holder',g.COMMON_PREFIX+'scrollable'].join(' '));this._chartHolder$.appendTo($(this._div));this._chartHolder$.css({position:'relative'})};n.prototype._createChartLayer=function(){this._chartLayer$=$(document.createElement('div')).addClass(g.PREFIX+'chart-layer');this._chartLayer$.appendTo(this._chartHolder$);this._chartLayer$.css({position:'absolute'})};n.prototype._createDescriptionLayer=function(){this._descriptionLayer$=$(document.createElement('div')).addClass(g.PREFIX+"chart-description");this._descriptionLayer$.css({position:'absolute',});this._descriptionLayer$.appendTo(this._chartHolder$)};n.prototype._createLoadingIcon=function(){this._loadingIcon$=$(document.createElement('div')).addClass(g.CHART_PREFIX+"loading-icon");this._loadingIcon$.appendTo(this._chartHolder$);this._loadingIcon$.css({width:this._chartHolder$.width()+"px",height:this._chartHolder$.height()+"px"})};n.prototype._createWarningDialog=function(){this._warningView=new W(this._chartHolder$.get(0),null)};n.prototype._showWarningDialog=function(){this._warningView.show()};n.prototype._createDropZone=function(){var a=this._chartLayer$;this._dropZone=new k(a.get(0),$.proxy(this._getFeedingZone,this),$.proxy(this._dropZoneFeedValidator,this));this._dropZone.addEventListener(k.DROP_ITEM_EVENT,this._dropItemHandler,this)};n.prototype._getFeedingZone=function(){if(!this._chart){return[]}try{return this._chartProxy.get('feedingZone',[])}catch(e){return[]}};n.prototype._dropZoneFeedValidator=function(a,e,z){var i=this._chartModelProvider().explicitFeedingItems();var j=a.id===b.MultiplierFeedingName;if(j){var t=this._chartModelProvider().type();if(!d.isMultipleChart(t)&&d.supportMultiChart(t)){var q=d.toMultiChartType(t);var r=b.getManifestFeedsMap(q);var s=b.supportMultiChart(i,r);if(!s){return false}}}return b.canAddFeed(i,a,e,z)};n.prototype._dropItemHandler=function(e){this._dispatchEvent(new h(h.ANALYSIS_DROPPED,this,e.data))};n.DISPATCH_PROPERTY_EVENT='dispatchPropertyEvent';n.prototype.modelChanged=function(a,e){};n.prototype._getMinSize=function(){return this._size};n.prototype._setChartSize=function(w,a){if(this._chart){this._chartProxy.set('size',{width:w,height:a})}};n.prototype._updateChartSize=function(a){var e=this._getMinSize();var w=e.width;var i=e.height;var j={width:this._size.width+"px",height:this._size.height+"px",'overflow-x':e['overflow-x']||'','overflow-y':e['overflow-y']||''};if(a){this._setChartSize(w,i)}this._chartLayer$.css({width:w+"px",height:i+"px",visibility:"visible",display:''});this._chartHolder$.css(j);return e};n.prototype.updateDescription=function(a){this._destroyChartInstance();this._updateDescription(a,true)};n.prototype._updateDescription=function(a,i){if(arguments.length<=0){var v=this._options.type;var e=this._options.feeding;if(!this._enableTrellis&&d.isMultipleChart(v)){a=c.get('VIZ_CHART_TRELLIS_DISABLED_WARN')}else if(!this._isFeedsValid){a=p(v,e,this._chartModelProvider().feedingItems())}}if(a){if(this._descriptionLayer$){this._descriptionLayer$.show();this._descriptionLayer$.text(a)}this._showDescription()}else{if(this._descriptionLayer$){this._descriptionLayer$.hide();this._descriptionLayer$.text("")}this._chartHolder$.css({'opacity':""})}this.hideLoadingIcon()};function o(a,e,t,q){for(var i=0;i<e.length;i++){if(e[i].type()===t){for(var j=0;j<a.length;j++){if(e[i].id()===a[j].id){if((e[i].id()!=="geoFeatures"&&!q)||(e[i].id()==="geoFeatures"&&q)){if(!a[j].minStackedDims){if(e[i].values().length<a[j].min){return false}}else{if(e[i].values().length<a[j].minStackedDims){return false}}}}}}}return true};function p(t,a,e){var j=c.get("VIZ_CHART_INCOMPLETE_DESCRIPTION");var q=b.getVizFeeds(t);var r=true;var s=true;var i;for(i=0;i<q.length;i++){if(!s&&!r){break}if(s&&q[i].type===F.DIMENSION){s=false;continue}if(r&&q[i].type===F.MEASURE){r=false}}if(r){j=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");return j}if(s){j=c.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION");return j}if(!a){return j}var v=o(q,e,F.MEASURE,false);var w=o(q,e,F.DIMENSION,false);var x=o(q,e,F.DIMENSION,true);if(x){if(!v&&w){j=c.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION")}if(v&&!w){j=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION")}}else{if(v&&w){j=c.get("VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION")}if(v&&!w){j=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION")}}return j};n.prototype._showDescription=function(){this._chartHolder$.css({'opacity':".3"});if(this._descriptionLayer$){this._descriptionLayer$.css({width:this._size.width+"px",height:this._size.height/2+50+"px",color:"black",'font-size':"28px",'text-align':"center",'top':this._size.height/2-50+"px",'word-wrap':"break-word"})}};n.prototype._destroyChartInstance=function(){if(this._chart){this._offEvent();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:destroy_cvom_chart_instance');this._chart.destroy();this._chart=null;this._hasChartInstance=false;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:destroy_cvom_chart_instance')}};n.prototype._updateDescriptionByOptions=function(a){if(d.isEmptyData(a.type,a.data)){var e=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(e);a.data=I.getDataset(a.type);this._chartLayer$.css('opacity','0')}else{this._updateDescription();this._updateChartSize(false);this._chartLayer$.css('opacity','')}};n.prototype._createChartInstance=function(){};n.prototype.getTemplateId=function(a){if(arguments.length>0){return this._templateId}else{return sap.viz.api.env.Template.get()}};n.prototype._getTemplateId=function(a){var t=sap.viz.api.env.Template.get();if(t!==n.TEMPLATE_INCOMPLETE&&t!==n.TEMPLATE_EMPTY){this._templateId=t}this._isFeedsValid=!V.hasFakeData(a);t=this._isFeedsValid?this._templateId:n.TEMPLATE_INCOMPLETE;return t};n.prototype.showLoadingIcon=function(){};n.prototype.hideLoadingIcon=function(){this._loadingIcon$.css({display:""})};n.prototype.hasChartInstance=function(){return this._hasChartInstance};n.prototype.exportable=function(){return false};n.prototype.size=function(s){if(arguments.length>0){this._size={width:s.width,height:s.height};this._updateChartSize(true);var a=this._descriptionLayer$;if(a!==null&&a.size()>0){a.css({width:this._size.width+"px",height:this._size.height/2+50+"px",'top':this._size.height/2-50+"px"})}this._loadingIcon$.css({width:this._size.width+"px",height:this._size.height+"px"});return this}return{width:this._size.width,height:this._size.height}};n.prototype.changeTemplate=function(){var t=sap.viz.api.env.Template.get();if(t!==n.TEMPLATE_INCOMPLETE&&t!==n.TEMPLATE_EMPTY&&t!==this._templateId){var a=this._getTemplateId(this._options.data);if(a===t){this._requestMorphing=true;this._createChartInstance();this._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this))}}};n.prototype.create=function(a){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');if(a){this._options=a;this._requestMorphing=true;var t=this._getTemplateId(a.data);this.__templateId=t;var _=this;sap.viz.api.env.Template.set(t,function(){if(_.__templateId===t){_._createChartInstance()}});this._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this))}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create')};n.prototype.destroy=function(){$(document).off('mousedown',this._mouseDownHandler);this.removeAllEventListeners();this._onEventMap={};if(this._chart){this._chart.destroy();this._chart=null}$(this._div).empty();sap.viz.extapi.env.Template.removeListener(this._changeTemplateFunc)};n.prototype.data=function(a){var e;try{if(arguments.length>0){this._options.data=a;if(this._chart){if(d.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new h(h.CHART_CHANGING,this));this._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));e=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(e);this._requestMorphing=false;this._options.data=I.getDataset(this._options.type);this._chartLayer$.css('opacity','0')}else{this._updateDescription();this._chartLayer$.css('opacity','')}this._chartProxy.set('data',this._options.data);return this}else{e=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(e);throw e}}else{return this._chartProxy.get('data',this._options.data)}}catch(i){e=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+i;this._updateDescription(e);throw e}};n.prototype.feeding=function(a){if(arguments.length>0){this._options.feeding=a;return this}else{return this._options.feeding}};n.prototype.css=function(a){if(arguments.length>0){this._options.css=a;return this}else{return this._options.css}};n.prototype.getValidProperties=function(a,e){return V.getValidProperties(a,e)};n.prototype.properties=function(a){if(arguments.length>0){this._options.properties=a;return this}else{return this._options.properties}};n.prototype.update=function(a,e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');if(!a){return}if(!e){this._requestMorphing=true}if(a.css){this._updateCssCacheByNewCss(a.css);this._options.css=a.css}if(a.feeding){this._options.feeding=a.feeding}if(a.data){this._options.data=a.data}if(a.properties){this._options.properties=a.properties}var i;try{if(this._chart){var s=false;if(a.properties&&a.properties.plotArea&&a.properties.plotArea.showNegativeValues===true){s=true}if(!s&&this._options.type&&D.hasNegativeMeasureValue(a.data,this._options.type)){this._showWarningDialog()}this._updateDescription();if(d.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new h(h.CHART_CHANGING,this));this._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));i=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(i);this._requestMorphing=false;a.data=I.getDataset(this._options.type);a.feeding=null;this._chartLayer$.css('opacity','0')}else{this._chartLayer$.css('opacity','')}this._updateChartSize(true);this._chartProxy.execute('update',a);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');return this}else{i=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(i);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');throw i}}catch(j){i=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+j;this._updateDescription(i);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');throw i}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update')};n.prototype.on=function(e,a){try{if(this._chart){if(arguments.length>0){this._chart.on(e,a)}}this._onEventMap[e]=a;return this}catch(i){throw c.get('VIZ_CHART_ADD_EVENT_FAILED')+i}};n.prototype.off=function(e){try{if(this._chart){if(arguments.length>0){this._chart.off(e)}}delete this._onEventMap[e];return this}catch(a){throw c.get('VIZ_CHART_REMOVE_EVENT_FAILED')+a}};n.prototype.selection=function(a,e){try{if(this._chart){if(this._options.type===C.TYPE_TREE||this._options.type===C.TYPE_TABLE||this._options.type===C.TYPE_CROSSTAB){return null}if(arguments.length>=2){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');this._chart.selection(a,e);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');return this}else if(arguments.length===1){if(u.isArray(arguments[0])){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');this._chart.selection(arguments[0]);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');return this}else{return this._chart.selection(arguments[0])}}else{return this._chart.selection()}}else{if(arguments.length>=2){throw c.get('VIZ_CHART_SELECTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}else if(arguments.length===1){if(u.isArray(arguments[0])){throw c.get('VIZ_CHART_SELECTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}else{return null}}else{return null}}}catch(i){throw c.get('VIZ_CHART_SELECTION_FAILED')+i}};n.prototype.feedingZone=function(){return[]};n.prototype.description=function(a){try{if(arguments.length>0){if(this._chart){this._chart.description(a);return this}else{throw c.get('VIZ_CHART_DESCRIPTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{if(this._chart){return this._chart.description()}else{return null}}}catch(e){throw c.get('VIZ_CHART_DESCRIPTION_FAILED')+e}};n.prototype.action=function(a,e){try{if(this._chart){if(arguments.length>0){return this._chartProxy.execute('action',a,e)}}else{throw c.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(i){throw c.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+i}};n.prototype.exportViz=function(a){if(this._chart){var r=this._chartProxy.execute('toJSON',a);if(r){r.properties=this._options.properties;this._updateCssOfOptions();r.css=this._options.css}return r}else{throw c.get('VIZ_CHART_SERIALIZE_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};n.prototype.loadViz=function(v){this.create(v)};n.prototype.enableTrellis=function(v){if(arguments.length>0){this._enableTrellis=(v!==false);return this}else{return this._enableTrellis}};n.prototype.enableMorphing=function(v){if(arguments.length>0){this._enableMorphing=(v!==false);return this}else{return this._enableMorphing}};n.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true)}return this}else{return this._enablePropertyZone}};n.prototype.getTitleByFeeding=function(){var a="";var e=[];var q=[];var r=this._chartModelProvider().feedingItems();for(var i=0;i<r.length;i++){var s=r[i];if(s._id===F.ROW_SUBTOTALS||s._id===F.COLUMNS_SUBTOTALS){continue}var v=s.values();var t=(s.type()===F.MEASURE)?e:q;for(var j=0;j<v.length;j++){var w=v[j];if(w.id()===A.MND){continue}var x=w.selectedHierarchyLevel();var y=x?x.name():w.name();t.push(y)}}var z=n._getNames(e);var B=n._getNames(q);if(z!==""&&B!==""){a=u.substitute(c.get('VIZ_CHART_TITLE_TEXT_JOIN_BY'),z,B)}else if(z!==""){a=z}else if(B!==""){a=B}if(a==""){a=" "}return a};n._getNames=function(a){var r="";for(var i=0;i<a.length;i++){var e=a[i];r+=e;if(i+2===a.length){r+=" "+c.get('VIZ_CHART_TITLE_TEXT_JOIN_AND')+" "}else if(i+2<a.length){r+=", "}}return r};n.prototype.resetProperties=function(a,v){return a};n.prototype.copyData=function(t,a){return u.clone(a)};n.prototype.buildFeedings=function(t,a,e){return null};n.prototype.supportUpdate=function(t){return true};n.prototype.setPropertyZones=function(a){};n.prototype.FeedsToJSON=function(a){return m.toJSON(a)};n.prototype.save=function(){};n.prototype.load=function(j,v){};n.prototype.FeedsFromJSON=function(v){var a=m.fromJSON(v);return a};n.prototype.exportToSVGString=function(a){if(this._chart){return this._chartProxy.execute('exportToSVGString',a)}else{throw c.get('VIZ_CHART_EXPORTSVG_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};n.prototype.supportExportToSVG=function(){if(this._chart){return this._chartProxy.execute('supportExportToSVG')}else{throw c.get('VIZ_CHART_EXPORTSVG_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};n.prototype.getPropertyZones=function(){return[]};n.prototype.getZoneName=function(a){};n.prototype.setAxisScale=function(a){};n.prototype.getDataPointsPosition=function(a){return[]};n.prototype.updateProperties=function(a){};n.prototype._updateCssCache=function(s,a,e){if(!this._cssCache){this._updateCssCacheByOptions()}this._cssCache=this._cssCache||{};this._cssCache[s]=this._cssCache[s]||{};this._cssCache[s][a]=e};n.prototype._updateCssCacheByOptions=function(){if(this._options&&this._options.css){this._updateCssCacheByCssString(this._options.css)}};n.prototype._updateCssCacheByNewCss=function(a){if(!this._cssCache){this._updateCssCacheByOptions()}this._updateCssCacheByCssString(a)};n.prototype._updateCssCacheByCssString=function(a){if(!a){return}this._cssCache=this._cssCache||{};var e=a.split('}');var i,j,q,r=[],s,t,v,P,w,x,y;for(i=0;i<e.length;i++){q=e[i];r=q.split('{');if(r.length===2){s=r[0].trim();t=r[1];v=t.split(';');this._cssCache[s]=this._cssCache[s]||{};for(j=0;j<v.length;j++){P=v[j];w=P.split(':');if(w.length===2){x=w[0].trim();y=w[1];this._cssCache[s][x]=y}}}}};n.prototype._updateCssOfOptions=function(){if(!this._cssCache){return}var a="",s,e,v;for(s in this._cssCache){if(this._cssCache.hasOwnProperty(s)){a+=' '+s+'{';for(e in this._cssCache[s]){if(this._cssCache[s].hasOwnProperty(e)){a+=e+':'+this._cssCache[s][e]+';'}}a+='}'}}if(a!==""){this._options.css=this._options.css?this._options.css+a:a}};n.prototype.cssProperty=function(s,a,e){if(this._chart){if(arguments.length>2){this._updateCssCache(s,a,e);return this._chart.cssProperty(s,a,e)}else if(arguments.length===2){return this._chart.cssProperty(s,a)}}return this};n.prototype.selectedPropertyZone=function(a){if(this._chart){if(arguments.length>0){return this._chartProxy.set('selectedPropertyZone',a)}else{return this._chartProxy.get('selectedPropertyZone')}}return this};n.prototype.onEventMap=function(a){if(arguments.length>0){this._onEventMap=a;return this}else{return this._onEventMap}};n.prototype._postVizProcess=function(a){if(!!this._chart.on){Object.keys(this._onEventMap).forEach($.proxy(function(e){var i=this._onEventMap[e];this._chart.on(e,i)},this))}};n.prototype._offEvent=function(){if(!!this._chart.off){Object.keys(this._onEventMap).forEach($.proxy(function(a){var e=this._onEventMap[a];this._chart.off(a,e)},this))}};n.prototype._getCssProperties=function(a,e){var r=null;for(var i=0;i<e.length;++i){var v=this._chart.cssProperty(a,e[i]);if(v!=null){r=r||{};r[e[i]]=v}}return r};n.prototype.queryProperties=function(a){if(!a||!a.css){return this.properties()}var e=a.css.properties;var s=a.css.selector;var r=null;if(u.isArray(s)){for(var i=0;i<s.length;++i){r=this._getCssProperties(s[i],e);if(r){break}}}else{r=this._getCssProperties(s,e)}return r};n.prototype.updateProperties=function(e){if(!e){return}if(e.css&&e.css.selector){var j;var s=e.css.selector;var v=e.css.value;var a=v.split('font-size');if(a.length===2){a[1]=a[1].replace(/;/,'!important;');v=a.join('font-size')}if(u.isArray(s)){j="";for(var i=0;i<s.length;++i){j+=s[i]+v}}else{j=s+v}this._helper.vizCss(j)}else if(e.hasOwnProperty("properties")){if(e.hasOwnProperty("disableDispatchInteractionCompleteEvent")&&e.disableDispatchInteractionCompleteEvent){this._helper.vizProperties(e.properties)}else{this._helper.propertiesWithEvents(e.properties)}}};return n});define('sap/viz/controls/common/property/VizPropertyZone',['sap/viz/controls/common/utils/Utils'],function(U){var V=function(t,c,e,m){this._type=t;this._context=c;this._extraContext=e;this._measureNames=m;if(U.isArray(m)){this._dimensionContext=this._filterDimensionContext(m.concat('_id'))}};V.CHART_AREA='CHART_AREA';V.CHART_TITLE='CHART_TITLE';V.PLOT_AREA='PLOT_AREA';V.GRID_LINE='GRID_LINE';V.LEGEND='LEGEND';V.X_AXIS='X_AXIS';V.X_AXIS_TITLE='X_AXIS_TITLE';V.Y_AXIS='Y_AXIS';V.Y_AXIS_TITLE='Y_AXIS_TITLE';V.DATA_POINT='DATA_POINT';V.DATA_LABEL='DATA_LABEL';V.LINE='LINE';V.prototype.type=function(v){if(arguments.length>0){this._type=v;return this}else{return this._type}};V.prototype.context=function(v){if(arguments.length>0){this._context=v;if(U.isArray(this._measureNames)){this._dimensionContext=this._filterDimensionContext(this._measureNames.concat('_id'))}return this}else{return this._context}};V.prototype.getDimensionContext=function(){if(this._selectAllData){return undefined}if(this._seriesData){for(var i in this._seriesData){if(this._seriesData.hasOwnProperty(i)){return this._seriesData}}return undefined}return this._dimensionContext};V.prototype._filterDimensionContext=function(a){var r;for(var k in this._context){if(!r){r={}}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break}}if(!b){continue}r[k]=this._context[k]}return r};V.prototype.extraContext=function(v){if(arguments.length>0){this._extraContext=v;return this}else{return this._extraContext}};V.prototype.stackContext=function(v){if(arguments.length>0){this._stackContext=v;return this}else{return this._stackContext}};V.prototype.seriesContext=function(s){if(arguments.length>0){this._seriesData=s;return this}else{return this._seriesData}};V.prototype.selectAllData=function(s){if(arguments.length>0){this._selectAllData=s;return this}else{return this._selectAllData}};return V});define('sap/viz/controls/chart/views/ChartView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/AxisSizeAdjustHelper','sap/viz/controls/chart/views/AxisSplitter','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DataPointFinder','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/views/EditAxisView','sap/viz/controls/chart/morph/VizMorpher','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/PropertyZone','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/property/VizPropertyZone'],function($,G,C,M,F,a,L,O,u,b,D,T,V,c,A,d,f,g,h,E,l,m,P,o,I,p,q){var r=function(e,i,j,k){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.ChartView";this._morphingLayer$=null;this._supportMorphing=true;this._requestMorphing=false;this._vizMorpher=null;i=i||{};this._enablePropertyZone=false;this._useBuiltInPropertyZoneInteraction=i.useBuiltInPropertyZoneInteraction;this._useDefaultChartSizeForTrellis=i.useDefaultChartSizeForTrellis;this._createChildren()};O.extend(r,o);var S=["legend","sizeLegend"];r.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._editAxisView=new E(this._chartHolder$.get(0),null);this._editAxisView.addEventListener(E.AxisScaleChanged,this._axisScalerChangedHandler,this);this._axisSplitter=new d(this._chartHolder$.get(0),$.proxy(this.properties,this),$.proxy(this._getPropertyZone,this));this._axisSplitter.addEventListener(d.AxisSplitChanged,this._axisSplitChangedHandler,this);this._morphingLayer$=$(document.createElement('div')).addClass(c.PREFIX+'morphing-layer');this._morphingLayer$.appendTo(this._chartHolder$);this._morphingLayer$.css({position:'absolute'});this._createDescriptionLayer();this._createLoadingIcon();this._createWarningDialog();this._createDropZone();var i=this._chartLayer$;this._propertyZone=new P(i.get(0),$.proxy(this._getPropertyZone,this));this._propertyZone.addEventListener(P.SELECT_ZONE,$.proxy(function(e){this._dispatchEvent(new f(f.SELECT_PROPERTY_ZONE,this,e.data))},this));this._uxScaleIndex=null};r.prototype.getZoneName=function(e){if(!e||!this._chart){return null}var z=this._getZoneName(e);if(z){if(V.isValueAxis(this._options.type,z)){return z}else{for(var i=0;i<S.length;i++){if(S[i]===z){return z}}}}return null};r.prototype._getZoneName=function(e){var z=this._getPropertyZone();for(var i=0;i<z.length;i++){var j=z[i].bound;var k=z[i].name;for(var n=0;n<j.length;n++){if(j[n][0][0]<e.x&&j[n][1][0]>e.x&&j[n][1][1]<e.y&&j[n][2][1]>e.y){return k}}}return null};r.prototype.setAxisScale=function(e){if(this._chart){var t=this._options.type;this._editAxisView.show(t,this._chartProxy.get('properties',this._options.properties),e)}};r.prototype._axisScalerChangedHandler=function(e){if(!this._chart){return}this._helper.propertiesWithEvents(e.data)};r.prototype._axisSplitChangedHandler=function(e){var i=A(this._chart,e.data.axisName,e.data.offset);if(i){this._helper.propertiesWithEvents(i)}};r.prototype._titleText=function(v){try{if(this._chart){if(!this.properties().title){return this}if(arguments.length>0){if(v!=this.properties().title.text)this._dispatchEvent(new f(f.TITLE_CHANGED,this,{text:v}));return this}else{var t=this.properties().title.text;return t}}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(e){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+e}};r._ZoneMap={xAxis:{text:"VIZ_COMMON_XAXIS"},xAxis2:{text:"VIZ_COMMON_XAXIS"},yAxis:{text:"VIZ_COMMON_YAXIS",rotate:true},yAxis2:{text:"VIZ_COMMON_YAXIS",rotate:true}};r._ZoneMap[a.trillisFeeds.column.id]={text:"VIZ_COMMON_COLUMNS"};r._ZoneMap[a.trillisFeeds.row.id]={text:"VIZ_COMMON_ROWS",rotate:true};r.prototype._isEmptyZone=function(z){if(!z||!z.bound){return true}var e=z.bound[0];if(!e){return true}var w=e[2][0]-e[0][0];var i=e[2][1]-e[0][1];if(w<1||i<1){return true}return false};r.prototype._updateTextInfo=function(z){if(!z){return}for(var n=0;n<z.length;n++){var i=r._ZoneMap[z[n].name];if(i){z[n].text=L.get(i.text);z[n].rotate=i.rotate}}};r.prototype.getTitleZone=function(){if(!this._chart){return[]}var t=this._options.type;var z;try{z=this._chartProxy.get('propertyZone',[])}catch(e){return[]}var j=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){j=z[i].bound[0];break}}return j};r.prototype._getFeedingZone=function(){if(!this._chart){return[]}var t=this._options.type;var z;try{z=this._chartProxy.get('feedingZone',[])}catch(e){return[]}if(!b.supportMultiChart(t)){this._updateTextInfo(z);return z}var j=b.isMultipleChart(t);var k=null;var n=null;if(j){for(var i=z.length-1;i>=0;i--){var v=z[i].name;if(v===a.MultiplierFeedingName){k={name:a.ColumnsFeedingName,bound:[z[i].bound[0]],feedDef:z[i].feedDef};n={name:a.RowsFeedingName,bound:[z[i].bound[1]],feedDef:z[i].feedDef};z.splice(i,1)}else if(v!=="mainPlot"&&v!=="legend"){if(T.providerName(t)===T.MULTIPLE){z.splice(i,1)}}}}if(!this._enableTrellis){this._updateTextInfo(z);return z}if(this._isEmptyZone(k)){k=null}if(this._isEmptyZone(n)){n=null}var w=this._padding;var x={"id":a.MultiplierFeedingName,"name":"ChartView Multiplier","type":F.DIMENSION,"min":1,"max":1,"aaIndex":1,"acceptMND":0};var y;if(!k){y=[[[w,0],[this._size.width-w,0],[this._size.width-w,w],[0,w]]];k={"name":a.ColumnsFeedingName,"feedDef":[x],"bound":y}}if(!n){y=[[[0,w],[w,w],[w,this._size.height-w],[0,this._size.height-w]]];n={"name":a.RowsFeedingName,"feedDef":[x],"bound":y}}z.push(k,n);this._updateTextInfo(z);return z};r.prototype._updateMorphingSnapshot=function(){if(this._canMorphing()&&this._hasChartInstance&&this._vizMorpher&&!this._vizMorpher.isPlaying()){this._vizMorpher.morphVizType(null,-1)}};r.prototype._setDefaultValue=function(t,e,j,v){var k=e.split('.');var n=t;for(var i=0;i<k.length;i++){n[k[i]]=n[k[i]]||{};n=n[k[i]]}if(!n.hasOwnProperty(j)){n[j]=v}};r.prototype._applyDefaultProperties=function(e){e=e||{};e.properties=e.properties||{};this._setDefaultValue(e.properties,'background.border.left','visible',false);this._setDefaultValue(e.properties,'background.border.top','visible',false);this._setDefaultValue(e.properties,'background.border.right','visible',false);this._setDefaultValue(e.properties,'background.border.bottom','visible',false);return e};function s(e,k,t){if(k==null||k.length==0){return 1}var v=[];var w=1;var x=0;var y=false;for(var n=0;n<k.length;n++){if(k[n].type()===p.HIERARCHY){var z=k[n].hierarchyLevels();for(var j=0;j<z.length;j++){if(z[j].selected()){break}x++}}else if(k[n].type()===p.MND){y=true;continue}if(x<e.length){var B=e[x].values;v[n]={};var H=0;for(var i=0;i<B.length;i++){if(!v[n].hasOwnProperty(B[i])){v[n][B[i]]=true;H++}}w*=H;x++}}if(y){w*=t}return w};r.prototype._getRowColumn=function(e,n){var t={row:1,column:1};if(!e||e.length===0){return t}var v=e[0].data;if(!v||v.length===0){return t}var w=0;var x=null;var y=null;var z=this._chartModelProvider().feedingItems();for(var i=0;i<z.length;i++){if(z[i].id()===a.RowsFeedingName){x=z[i].values();for(var j=0;j<x.length;j++){if(x[j].type()===p.HIERARCHY){var B=x[j].hierarchyLevels();for(var k=0;k<B.length;k++){w++;if(B[k].selected()){break}}}else if(x[j].type()!==p.MND){w++}}}else if(z[i].id()===a.ColumnsFeedingName){y=z[i].values()}}t.row=s(v.slice(0,w),x,n);t.column=s(v.slice(w),y,n);return t};r.prototype._getMinSize=function(){var w=this._size.width;var e=this._size.height;var j=this._options;var k={width:w,height:e};if(!this._useDefaultChartSizeForTrellis&&b.isMultipleChart(j.type)&&T.providerName(j.type)===T.MULTIPLE){if(!j.data||!j.data.data()){return k}var n=j.data.data().measureValuesGroup;var t=0;for(var i=0;i<n.length;i++){t+=n[i].data.length}var v=this._getRowColumn(j.data.data().analysisAxis,t);var x=v.column*200;var y=v.row*200;if(w<x){w=x;k['overflow-x']='auto'}if(e<y){e=y;k['overflow-y']='auto'}}k.width=w;k.height=e;return k};r.prototype._updateChartSize=function(e){var i=r.superclass._updateChartSize.apply(this,arguments);var w=i.width;var j=i.height;this._morphingLayer$.css({width:w+"px",height:j+"px",display:'none'});this._updateUXScale();return i};r.prototype.updateDescription=function(e){r.superclass.updateDescription.apply(this,arguments);if(this._vizMorpher){this._vizMorpher.showMorphing(false,true)}};r.prototype._destroyChartInstance=function(){r.superclass._destroyChartInstance.apply(this,arguments);this._axisSplitter.reset()};r.prototype._createChartInstance=function(){this._hasChartInstance=false;var e=this._options;e=this._applyDefaultProperties(e);if(this._useBuiltInPropertyZoneInteraction===true){e.properties=e.properties||{};e.properties.interaction=e.properties.interaction||{};e.properties.interaction.selectability=e.properties.interaction.selectability||{};e.properties.interaction.selectability.plotLassoSelection=false;e.properties.interaction.selectability.mode="none";e.properties.tooltip=e.properties.tooltip||{};e.properties.tooltip.visible=false}var i=this._chartLayer$;var j=this._morphingLayer$;var k=this._descriptionLayer$;var n=this._chartHolder$;var v=e.type;if(v===C.TYPE_TREE||v===C.TYPE_NETWORK||v===C.TYPE_FUNNEL||v===C.TYPE_PC||b.supportAnimation(v)){this._supportMorphing=false}else if(!b.isBuildInType(v)){this._supportMorphing=false}else{this._supportMorphing=true}if(b.isEmptyData(v,e.data)){this._requestMorphing=false}if(this._canMorphing()&&!this._vizMorpher){this._vizMorpher=new l(i.get(0),j.get(0))}this._updateMorphingSnapshot();this._destroyChartInstance();if(e.data===null||e.data===undefined){if(this._canMorphing()&&this._vizMorpher){this._vizMorpher.morphVizType(null,-1)}return}var t=false;if(e.properties&&e.properties.plotArea&&e.properties.plotArea.showNegativeValues===true){t=true}if(!t&&D.hasNegativeMeasureValue(e.data,v)){this._showWarningDialog()}if(!e.properties){e.properties={}}if(this._canMorphing()===true){if(!e.properties.plotArea){e.properties.plotArea={}}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={}}e.properties.plotArea.animation.dataLoading=false;e.properties.plotArea.animation.dataUpdating=false;e.properties.plotArea.animation.resizing=false}try{if(!this._enableTrellis&&b.isMultipleChart(v)){this._propertyZone.updateZone(false);return}if(b.supportAnimation(v)){if(!e.properties.plotArea){e.properties.plotArea={}}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={}}e.properties.plotArea.animation.dataLoading=e.properties.plotArea.animation.dataLoading===false?false:true;e.properties.plotArea.animation.dataUpdating=e.properties.plotArea.animation.dataUpdating===false?false:true;e.properties.plotArea.animation.resizing=e.properties.plotArea.animation.resizing===false?false:true;if(!e.properties.geoContainer){e.properties.geoContainer={}}}this._dispatchEvent(new f(f.CHART_CHANGING,this,v));this._updateDescriptionByOptions(e);var w=e.properties;var x=this._mergeUXScale(w,e.css);this._chart=this._chartProxy.execute('sap.viz.api.core.createViz',{type:v,data:e.data,feeding:e.feeding,properties:x?x.properties:w,css:x?x.css:e.css,events:e.events,container:i.get(0)});if(this._chart){this._postVizProcess(e)}}catch(y){var z=L.get('VIZ_CHART_CREATE_CHART_FAILED')+y;this._propertyZone.updateZone(false);if(!a.getVizFeeds(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(z)}i.html("");this._chart=null;this._hasChartInstance=false;throw z}};r.prototype._postVizProcess=function(e){r.superclass._postVizProcess.apply(this,arguments);var t=$.proxy(function(j,k){this._dispatchEvent(new f(f.TRIGGER_CVOM_EVENT,this,{type:j,data:k}))},this);if(this._canMorphing()&&this._vizMorpher&&this._requestMorphing){this._vizMorpher.showMorphing(true,false)}this._chart.on("lassoStart.chartview",$.proxy(function(){this._axisSplitter.deactive()},this));this._chart.on("lassoEnd.chartview",$.proxy(function(){this._axisSplitter.active()},this));this._chart.on("initialized.chartview",$.proxy(function(j){if(this._canMorphing()&&this._requestMorphing&&this._hasChartInstance&&this._vizMorpher){this._requestMorphing=false;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:morphing');this._vizMorpher.morphVizType(e.type,800,function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:morphing')})}if(this._isFeedsValid){this._axisSplitter.init(e.type)}var k=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(k);t("initialized",j)},this));var i=this;this._chart.on("selectData.chartview",function(j){if(i._options.type!==C.TYPE_NETWORK){i._dispatchEvent(new f(f.CHANGED_SELECTED_DATA,this));t("selectData",j)}});this._chart.on("deselectData.chartview",function(j){if(i._options.type!==C.TYPE_NETWORK&&i._options.type!==C.TYPE_TREE){i._dispatchEvent(new f(f.CHANGED_SELECTED_DATA,this));t("deselectData",j)}});this._chart.on("showTooltip.chartview",function(j){t("showTooltip",j)});this._chart.on("hideTooltip.chartview",function(j){t("hideTooltip",j)});this._chart.on('contextualData.chartview',$.proxy(function(j){this._dispatchEvent(new f(f.CONTEXT_MENU_TRIGGERED,this,j))},this));this._hasChartInstance=true;this._dispatchEvent(new f(f.CHART_CHANGED,this,this._chart))};r.prototype.getTemplateId=function(e){var i=e||this.data();if(V.hasFakeData(i)){return o.TEMPLATE_INCOMPLETE}else{return this._templateId}};r.prototype.size=function(e){if(arguments.length>0){r.superclass.size.apply(this,arguments);if(this._dropZone){this._dropZone.size(this._size)}this._propertyZone.size(this._size);setTimeout($.proxy(this._updateMorphingSnapshot,this),500);return this}else{return r.superclass.size.apply(this,arguments)}};r.prototype.data=function(e,i){if(arguments.length>0){if(!i){this._requestMorphing=true}}return r.superclass.data.apply(this,arguments)};r.prototype.feeding=function(e,i){try{if(this._chart){if(arguments.length>0){if(!i){this._requestMorphing=true}this._options.feeding=e;this._chartProxy.set('feeding',e);return this}else{return this._chartProxy.get('feeding',this._options.feeding)}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(j){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+j}};r.prototype.css=function(e,i){try{if(arguments.length>0){if(!i){this._requestMorphing=true}this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chartProxy.set('css',e);return this}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('css',this._options.css)}}catch(j){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+j}};r.prototype.properties=function(e,i){try{if(arguments.length>0){if(!i){this._requestMorphing=true}this._options.properties=e;if(this._chart){this._chartProxy.set('properties',e);return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('properties',this._options.properties)}}catch(j){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+j}};r.prototype.update=function(e,i){if(!i){this._requestMorphing=true}return r.superclass.update.apply(this,arguments)};r.prototype.feedingZone=function(){try{if(this._chart){return this._chartProxy.get('feedingZone',[])}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(e){throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+e}};r.prototype._canMorphing=function(){return this._enableMorphing&&this._supportMorphing};r.prototype._getPropertyZone=function(){if(!this._chart){return[]}var z;try{z=this._chartProxy.get('propertyZone',[])}catch(e){return[]}return z};r.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true);var e=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(e)}return this}else{return this._enablePropertyZone}};r.prototype._getCategoryAxisScale=function(t){var e=null;var j=V.getCategoryAxis(t);if(j){e=[];for(var i=0;i<j.length;i++){e.push(j[i]+".maxSizeRatio")}}return e};r.prototype.resetProperties=function(e,v){if(this._options&&this._options.type){var t=this._options.type;V.convertValueAxisScale(e,t,v);var i=this._getCategoryAxisScale(t);if(i&&i.length>0){V.removeProperties(e,i)}}return e};r.prototype.copyData=function(t,e){var i=new sap.viz.api.data.CrosstableDataset();i.data(u.clone(e.data()));i.info(u.clone(e.info('additionalData')));return i};r.prototype.buildFeedings=function(t,e,i){var j=null;if(!e||b.isEmptyData(t,e)){return j}if(!V.hasFakeData(e)&&!b.isEmptyData(t,e)&&!a.isEmptyFeeds(i)){j=a.buildFeedings(t,i,e)}else{j=a.buildFeedingsWithFakeData(t,i,e);j=a.buildMNDFeedings(j,t)}return j};r.prototype.getDataPointsPosition=function(e){return g.findDataPointsPosition(e)};r.prototype.getPropertyZones=function(){return[new q(q.CHART_AREA)]};var _={'padding':['24px','16px','9px','2px'],'font_size_1':['16px','15px','14px','13px'],'font_size_2':['14px','13px','12px','11px'],'font_size_3':['13px','12px','11px','10px'],'font_size_4':['12px','11px','10px','9px'],};r.prototype._updateUXScale=function(){if(this._chart){var e=this._mergeUXScale(undefined,undefined,this._options.css);if(e){this._chartProxy.execute('update',e)}}};r.prototype._mergeUXScale=function(e,j,k){var n;var t=this.size();var w=t.width,v=t.height;var x=0;if(w<160||v<160){x=3}else if(w<260||v<260){x=2}else if(w<360||v<360){x=1}if(this._uxScaleIndex!==x){var i=this._uxScaleIndex=x;n={};n.properties=$.extend({},e,{'general':{'layout':{'padding':parseInt(_.padding[i])}}});k=(j||'')+(k||'');var y=function(B,H,J){var K;var N=k.lastIndexOf(B);if(N!==-1){var Q=k.substring(k.indexOf('{'),k.indexOf('}')+1);N=Q.lastIndexOf(H);if(N!==-1){var R=Q.indexOf(';',N);if(R===-1){R=Q.indexOf('}',N)}Q=Q.substring(N,R)}var U=Q.split(':');if(U&&U.length>1){return U[1].trim()}}};var z=function(B,H,J,K){if(u.isString(B)){B=[B]}var N=false;B.forEach(function(Q){if(N){return}var R=y(Q,H);if(R&&R!==J){N=true}});if(!N){return B[0]+'{'+H+':'+J+(K?'!important':'')+';}'}else{return''}};n.css=(j||'')+z(['.v-m-root .v-m-title .v-title','.viz-title-label.v-title'],'font-size',_.font_size_1[i],false)+z(['.v-m-root .v-m-main .v-m-yAxis .v-title','.viz-axis-title.v-title'],'font-size',_.font_size_2[i],false)+z(['.v-m-root .v-m-main .v-m-xAxis .v-title','.viz-axis-title.v-title'],'font-size',_.font_size_2[i],false)+z('.v-m-tooltip .v-body-dimension-value','font-size',_.font_size_3[i],true)+z('.v-m-tooltip .v-body-measure-value','font-size',_.font_size_3[i],true)+z('.v-m-tooltip .v-body-dimension-label','font-size',_.font_size_4[i],true)+z('.v-m-tooltip .v-body-measure-label','font-size',_.font_size_4[i],true)+z('.v-m-tooltip .v-footer-label','font-size',_.font_size_4[i],true)+z(['.v-m-root .v-m-main .v-m-yAxis .v-label','.viz-axis-label.v-label'],'font-size',_.font_size_4[i],false)+z(['.v-m-root .v-m-main .v-m-xAxis .v-label','.viz-axis-label.v-label'],'font-size',_.font_size_4[i],false)+z(['.v-m-root .v-m-main .v-m-datalabel .v-datalabel','.v-datalabel'],'font-size',_.font_size_4[i],false)+z(['.v-m-root .v-m-legends .v-m-legend .v-label','font-size','.viz-legend-valueLabel.v-label'],_.font_size_4[i],false)}return n};return r});define('sap/viz/controls/chart/adapters/InteractionAdapter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/chart/views/ChartEvent'],function(O,u,E,V,C){var I=function(h){I.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.adapters.InteractionAdapter';this._helper=h;var s=true;this._helper.vizOn('selectPropertyZone',$.proxy(function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:interaction_select');s=true;this._selectPropertyZoneHandler(e)},this));this._helper.vizOn('deselectPropertyZone',$.proxy(function(e){s=false;u.defer($.proxy(function(){if(!s){this._selectPropertyZoneHandler(e)}},this))},this));this._propertyZones=null};O.extend(I,E);var _={'dataPoint':V.DATA_POINT,'title':V.CHART_TITLE,'plotArea':V.PLOT_AREA,'legend':V.LEGEND,'axis.x':V.X_AXIS,'axisTitle.x':V.X_AXIS_TITLE,'axis.y':V.Y_AXIS,'axisTitle.y':V.Y_AXIS_TITLE,'chart':V.CHART_AREA,'dataLabel':V.DATA_LABEL,'dataLine':V.LINE,'gridline':V.GRID_LINE};var a=u.invert(_);I.prototype._getPropertyZones=function(){var s=this._helper.selectedPropertyZone();if(!s){return[]}var t=s.type;if(t==='axisItem'){t='axis'}var p=null;var f=t+(s.subType?'.'+s.subType:'');if(_[f]){p=_[f]}else{}var z=[];var m=this._helper.vizData().measures();if(s.data&&s.data.length>0){s.data.forEach(function(c,i){var b=new V(p,c,s.extraData?s.extraData[i]:undefined,m);var d=s.stackData?s.stackData[i]:null;if(d){b.stackContext(d)}var e=s.seriesData?s.seriesData:null;if(e){b.seriesContext(e)}if(s.selectAllData){b.selectAllData(s.selectAllData)}z.push(b)})}else{z.push(new V(p))}return z};I.prototype._selectPropertyZoneHandler=function(e){this._propertyZones=this._getPropertyZones();u.defer(function(){this._dispatchEvent(new C(C.PROPERTY_ZONES_CHANGED,this,{'propertyZones':this._propertyZones}))}.bind(this))};I.prototype.propertyZones=function(v){if(arguments.length>0){this._propertyZones=v;var t=null;v=v||[];v.forEach(function(b){var c=a[b.type()];if(!c){return}t=t||{};t.data=t.data||[];var d=c.split('.');t.type=d[0];if(d.length>1){t.subType=d[1]}if(b.context()){t.data.push(b.context())}});if(t){this._helper.selectedPropertyZone(t)}else{this._helper.selectedPropertyZone(null)}return this}else{if(this._helper.vizType()==='info/donut'&&this._propertyZones&&this._propertyZones[0]&&this._propertyZones[0].type()===V.DATA_POINT){return this._propertyZones}else{var z=this._getPropertyZones();if(!z||z.length===0){return this._propertyZones}else{return z}}}};return I});define('sap/viz/controls/chart/adapters/renderer/RendererInfoBase',['require','sap/viz/controls/common/utils/Utils'],function(r,U){var a=r||a;var R=function(i,v){this.implClassPath='sap/viz/controls/chart/adapters/renderer/RendererInfoBase';this.id=i;this.vizPath=v;this.generator=null;this._parameters=[];this._fallbackParas=null};R.prototype.parameters=function(v){if(arguments.length>0){this._parameters=v;return this}else{return this._parameters}};R.prototype.fallbackParas=function(){return this._fallbackParas};R.prototype.simplify=function(){var b=[];var c=false;this._iterate('general',$.proxy(function(p){if(this._renderGeneral(p.paras)){c=true;b.push(p)}else{this._fallbackParas=p.paras}},this));this._iterate('specified',$.proxy(function(p){if(c||this._renderSpecified(p.paras)){b.push(p)}},this));return b};R.prototype._updatePropsAll=function(c,k,v){var p=this._parameters,b;for(var i=0;i<p.length;i++){if(U.deepEqual(p[i].ctx,c)){p[i].paras[k]=v;b=true}}return b};R.prototype._updatePropsGeneral=function(c,k,v){var b;if(c){var p=this._parameters,d,e=-1,n=0,f;for(var i=0;i<p.length;i++){if(!p[i].ctx){f=i}else if(R._compareCtx(p[i].ctx,c)){for(var j in p[i].ctx){n++}if(e<n){e=n;f=i}}}if(p[f]){b=U.clone(p[f]).paras}}b=b||{};b[k]=v;this._parameters.push({'ctx':c,'paras':b});d=true};R.prototype._updatePropsSpecified=function(c,k,v){var p=this._parameters;for(var i=0;i<p.length;i++){if(!U.deepEqual(p[i].ctx,c)&&R._compareCtx(c,p[i].ctx)){p[i].paras[k]=v}}if(!c){for(var i=0;i<p.length;i++){p[i].paras[k]=v}}};R.prototype._mergeAndAddSeriesProps=function(c,k,v){var p=this._parameters,b,d;for(var i=0;i<p.length;i++){if(!R._compareCtx(c,p[i].ctx)&&!R._compareCtx(p[i].ctx,c)&&U.hasCommonKeyValue(c,p[i].ctx)){b=U.updateJSON(p[i].ctx,c);var e=R._contextLength(b);if(e>R._contextLength(c)&&e>R._contextLength(p[i].ctx)){var o={};o[k]=v;d=U.updateJSON(p[i].paras,o);this._parameters.push({'ctx':b,'paras':d})}}}};R._contextLength=function(c){var l=0;if(c){for(var i in c){if(c.hasOwnProperty(i)){l++}}}return l};R.prototype.setProperty=function(c,k,v){var i=false;i=this._updatePropsAll(c,k,v);if(!i){this._updatePropsGeneral(c,k,v)}this._updatePropsSpecified(c,k,v);this._mergeAndAddSeriesProps(c,k,v)};R.prototype.getProperty=function(c,k){var v;var p=this._parameters;for(var i=0;i<p.length;i++){if(!p[i].ctx){v=p[i].paras[k]}else if(U.deepEqual(c,p[i].ctx)){v=p[i].paras[k];break}}var b=-1,n=0,m=-1,g=0;for(var i=0;i<p.length;i++){if((R._compareCtx(c,p[i].ctx)||c===undefined)&&!U.deepEqual(p[i].paras[k],v)){if(v!==null&&v!==undefined){return null}else{v=p[i].paras[k]}g++}else if(R._compareCtx(p[i].ctx,c)){n=0;for(var j in p[i].ctx){n++}if(b<n){b=n;m=i}}}if(g===1){return null}if(m>-1){v=p[m].paras[k]}return v};R.prototype.toJSON=function(){return{'id':this.id,'vizPath':this.vizPath,'generator':this.generator,'parameters':this._parameters,'implClassPath':this.implClassPath}};R.fromJSON=function(j){var c=a(j.implClassPath);return new c(j.id,j.vizPath).parameters(j.parameters)};R.prototype._renderGeneral=function(p){return true};R.prototype._renderSpecified=function(p){return true};R.prototype._iterate=function(t,c,b){this._parameters.forEach(function(p,i,d){if(t==='all'){c(p)}else if(t==='general'){if(!p.ctx||R._compareCtx(p.ctx,b)){c(p)}}else if(t==='specified'&&p.ctx){c(p)}})};R._compareCtx=function(c,b){if(c instanceof Object&&b instanceof Object){var k=Object.keys(c);var d=Object.keys(b);return(d.length>0)&&k.every(function(e){return R._compareCtx(c[e],b[e])})}else{return c===b}};R.prototype.isConflict=function(p,b,c){var i=false;var _=this;this._iterate('all',function(d){if(_._ignoreKey(b,d.paras,p)){return}else{if(d.paras[c]!==p[b]){i=true}}});return i};R.prototype._ignoreKey=function(p,b,c){return false};return R});define('sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var D=function(i,v){D.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo';this.generator='dataLabelRenderer'};O.extend(D,R);D.prototype._renderSpecified=function(p){if(p.iconVisible===true||p.textVisible===false){return true}else{return p.fontFamily!==undefined||p.fontSize!==undefined||p.fontWeight!==undefined||p.fontColor!==undefined||p.fontStyle!==undefined}};D.prototype._ignoreKey=function(p,a,b){switch(p){case'textVisible':if(b.textVisible===undefined){if(a.textVisible===b.dataLabelVisible){return true}}break;case'iconVisible':if(b.iconVisible===undefined){return true}break;case'fontFamily':if(a.fontFamily===undefined){return true}break;case'fontSize':if(a.fontSize===undefined){return true}break;case'fontWeight':if(a.fontWeight===undefined){return true}break;case'fontColor':if(a.fontColor===undefined){return true}break;case'fontStyle':if(a.fontStyle===undefined){return true}break}return false};return D});define('sap/viz/controls/chart/adapters/config/DataLabelPropConfig',['sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo'],function(D){var a={};var _=function(p){return{'id':'plotArea.dataLabel.renderer','infoClass':D,'vizPath':'plotArea.dataLabel.renderer','paraName':p}};a.instance=function(){return{'dataLabelVisible':{'vizPath':'plotArea.dataLabel.visible'},'textVisible':{'renderer':_('textVisible')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'plotArea.dataLabel.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'plotArea.dataLabel.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'plotArea.dataLabel.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'plotArea.dataLabel.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'plotArea.dataLabel.style.fontStyle'},'iconVisible':{'renderer':_('iconVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconSize':{'renderer':_('iconSize')}}};return a});define('sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var S=function(i,v){S.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo';this.generator='stackDecorator'};O.extend(S,R);S.prototype._renderSpecified=function(p){if(p.stackShape){return true}else{return false}};return S});define('sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var B=function(i,v){B.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo';this.generator='barShapeRenderer'};O.extend(B,R);B.prototype._renderGeneral=function(p){if(p.dataPointShape||p.dataPointShapeFill){return true}else{return false}};B.prototype._renderSpecified=function(p){if(p.dataPointShape||p.dataPointShapeFill){return true}else{return false}};return B});define('sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var P=function(i,v){P.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo';this.generator='pieSliceRenderer'};O.extend(P,R);P.prototype._renderGeneral=function(p){if(p.sliceShape){return true}else{return false}};P.prototype._renderSpecified=function(p){if(p.sliceShape){return true}else{return false}};return P});define('sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(i,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo';this.generator='lineMarkerRenderer'};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true}else{return false}};L.prototype._renderSpecified=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true}else{return false}};return L});define('sap/viz/controls/chart/adapters/config/DataPointPropConfig',['sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo','sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo','sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo'],function(S,B,P,L){var D={};var _=function(p){return{'id':'plotArea.markerRenderer.barShapeRenderer','infoClass':B,'vizPath':'plotArea.markerRenderer','paraName':p}};var a=function(p){return{'id':'plotArea.stackDecorator.stackDecorator','infoClass':S,'vizPath':'plotArea.stackDecorator','useStackContext':true,'paraName':p}};var b=function(p){return{'id':'plotArea.sliceRenderer.pieSliceRenderer','infoClass':P,'vizPath':'plotArea.sliceRenderer','paraName':p}};var c=function(p){return{'id':'plotArea.markerRenderer.lineMarkerRenderer','infoClass':L,'vizPath':'plotArea.markerRenderer','paraName':p}};D.instance=function(){return{'line.iconSVG':{'renderer':c('iconSVG')},'line.iconColor':{'renderer':c('iconColor')},'line.iconSize':{'renderer':c('iconSize')},'dataPointShape':{'renderer':_('dataPointShape')},'stackShape':{'renderer':a('stackShape')},'dataPointShapeFill':{'renderer':_('dataPointShapeFill')},'sliceShape':{'renderer':b('sliceShape')},'sliceShapeFill':{'renderer':b('sliceShapeFill')},'centerName.fontFamily':{'vizPath':'plotArea.highlight.centerName.style.fontFamily'},'centerName.fontSize':{'vizPath':'plotArea.highlight.centerName.style.fontSize'},'centerName.fontWeight':{'vizPath':'plotArea.highlight.centerName.style.fontWeight'},'centerName.fontColor':{'vizPath':'plotArea.highlight.centerName.style.color'},'centerName.fontStyle':{'vizPath':'plotArea.highlight.centerName.style.fontStyle'},'centerValue.fontFamily':{'vizPath':'plotArea.highlight.centerValue.style.fontFamily'},'centerValue.fontSize':{'vizPath':'plotArea.highlight.centerValue.style.fontSize'},'centerValue.fontWeight':{'vizPath':'plotArea.highlight.centerValue.style.fontWeight'},'centerValue.fontColor':{'vizPath':'plotArea.highlight.centerValue.style.color'},'centerValue.fontStyle':{'vizPath':'plotArea.highlight.centerValue.style.fontStyle'}}};return D});define('sap/viz/controls/chart/adapters/config/ValueAxisPropConfig',[],function(){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.label.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.label.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.label.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.label.style.color'},'fontStyle':{'vizPath':'valueAxis.label.style.fontStyle'}}};return V});define('sap/viz/controls/chart/adapters/config/ChartTitlePropConfig',[],function(){var C={};C.instance=function(){return{'fontFamily':{'vizPath':'title.style.fontFamily'},'fontSize':{'vizPath':'title.style.fontSize'},'fontWeight':{'vizPath':'title.style.fontWeight'},'fontColor':{'vizPath':'title.style.color'},'fontStyle':{'vizPath':'title.style.fontStyle'}}};return C});define('sap/viz/controls/chart/adapters/config/ChartAreaPropConfig',[],function(){var C={};C.instance=function(){return{'fill':{'vizPath':'general.background.color'}}};return C});define('sap/viz/controls/chart/adapters/config/PlotAreaPropConfig',[],function(){var P={};P.instance=function(){return{'fill':{'vizPath':'plotArea.background.color'}}};return P});define('sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig',[],function(C){var a={};a.instance=function(){return{'fontFamily':{'vizPath':'categoryAxis.title.style.fontFamily'},'fontSize':{'vizPath':'categoryAxis.title.style.fontSize'},'fontWeight':{'vizPath':'categoryAxis.title.style.fontWeight'},'fontColor':{'vizPath':'categoryAxis.title.style.color'},'fontStyle':{'vizPath':'categoryAxis.title.style.fontStyle'}}};return a});define('sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig',[],function(C){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.title.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.title.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.title.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.title.style.color'},'fontStyle':{'vizPath':'valueAxis.title.style.fontStyle'}}};return V});define('sap/viz/controls/chart/adapters/config/LegendPropConfig',[],function(){var L={};L.instance=function(){return{'fontFamily':{'vizPath':'legend.label.style.fontFamily'},'fontSize':{'vizPath':'legend.label.style.fontSize'},'fontWeight':{'vizPath':'legend.label.style.fontWeight'},'fontColor':{'vizPath':'legend.label.style.color'},'fontStyle':{'vizPath':'legend.label.style.fontStyle'},'title-fontFamily':{'vizPath':'legend.title.style.fontFamily'},'title-fontSize':{'vizPath':'legend.title.style.fontSize'},'title-fontWeight':{'vizPath':'legend.title.style.fontWeight'},'title-fontColor':{'vizPath':'legend.title.style.color'},'title-fontStyle':{'vizPath':'legend.title.style.fontStyle'}}};return L});define('sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var C=function(i,v){C.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo';this.generator='categoryAxisLabelRenderer'};O.extend(C,R);C.prototype._renderGeneral=function(p){if(p.iconVisible===true||p.textVisible===false){return true}else{return false}};C.prototype._renderSpecified=function(p){if(p.iconVisible===true||p.textVisible===false){return true}else{return p.fontFamily!==undefined||p.fontSize!==undefined||p.fontWeight!==undefined||p.fontColor!==undefined||p.fontStyle!==undefined}};C.prototype._ignoreKey=function(p,a,b){switch(p){case'fontFamily':if(a.fontFamily===undefined){return true}break;case'fontSize':if(a.fontSize===undefined){return true}break;case'fontWeight':if(a.fontWeight===undefined){return true}break;case'fontColor':if(a.fontColor===undefined){return true}break;case'fontStyle':if(a.fontStyle===undefined){return true}break}return false};return C});define('sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig',['sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo'],function(C){var a={};var _=function(p){return{'id':'categoryAxis.labelRenderer.categoryAxisLabelRenderer','infoClass':C,'vizPath':'categoryAxis.labelRenderer','paraName':p}};a.instance=function(){return{'textVisible':{'renderer':_('textVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconSize':{'renderer':_('iconSize')},'iconVisible':{'renderer':_('iconVisible')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'categoryAxis.label.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'categoryAxis.label.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'categoryAxis.label.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'categoryAxis.label.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'categoryAxis.label.style.fontStyle'}}};return a});define('sap/viz/controls/chart/adapters/renderer/LineRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(i,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LineRendererInfo';this.generator='lineRenderer'};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.dash||p.color||p.width){return true}else{return false}};L.prototype._renderSpecified=function(p){if(p.dash||p.color||p.width){return true}else{return false}};return L});define('sap/viz/controls/chart/adapters/config/LinePropConfig',['sap/viz/controls/chart/adapters/renderer/LineRendererInfo'],function(L){var a={};var _=function(p){return{'id':'plotArea.lineRenderer','infoClass':L,'vizPath':'plotArea.lineRenderer','paraName':p}};a.instance=function(){return{'lineFill':{'renderer':_('color')},'lineStyle':{'renderer':_('dash')},'plotArea.width':{'renderer':_('width'),'vizPath':'plotArea.width'}}};return a});define('sap/viz/controls/chart/adapters/PropertyMap',['sap/viz/controls/chart/adapters/config/DataLabelPropConfig','sap/viz/controls/chart/adapters/config/DataPointPropConfig','sap/viz/controls/chart/adapters/config/ValueAxisPropConfig','sap/viz/controls/chart/adapters/config/ChartTitlePropConfig','sap/viz/controls/chart/adapters/config/ChartAreaPropConfig','sap/viz/controls/chart/adapters/config/PlotAreaPropConfig','sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig','sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig','sap/viz/controls/chart/adapters/config/LegendPropConfig','sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig','sap/viz/controls/chart/adapters/config/LinePropConfig','sap/viz/controls/common/property/VizPropertyZone'],function(D,a,V,C,b,P,c,d,L,e,f,g){var h={};h.getPropConfig=function(z,i){switch(z){case g.DATA_LABEL:return D.instance();break;case g.DATA_POINT:return a.instance();break;case g.X_AXIS:if(i){return V.instance()}else{return e.instance()}break;case g.CHART_TITLE:return C.instance();break;case g.CHART_AREA:return b.instance();break;case g.PLOT_AREA:return P.instance();break;case g.X_AXIS_TITLE:if(i){return d.instance()}else{return c.instance()}break;case g.Y_AXIS_TITLE:if(i){return c.instance()}else{return d.instance()}break;case g.LEGEND:return L.instance();break;case g.Y_AXIS:if(i){return e.instance()}else{return V.instance()}break;case g.LINE:return f.instance();break}};return h});define('sap/viz/controls/chart/adapters/PropFnGenerator',[],function(){var P=function(n,f){this.__className="sap.viz.controls.chart.adapters.PropFnGenerator";this._name=n;this._fn=f};prototype=P.prototype;prototype.generateFn=function(p){return this._fn.apply(null,[p])};prototype.getName=function(){return this._name};return P});define('sap/viz/controls/chart/adapters/PropFnGeneratorRegistry',['sap/viz/controls/chart/adapters/PropFnGenerator'],function(P){var a={};var _={};a.register=function(n,f){var g=_;if(g.hasOwnProperty(n)){throw"PropFnGenerator '"+n+"' exists."}g[n]=new P(n,f)};a.unregister=function(n){delete _[n]};a.get=function(n){return _[n]};return a});define('sap/viz/controls/chart/adapters/PropertyAdapter',['require','jquery','sap/viz/controls/chart/adapters/PropertyMap','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/chart/adapters/PropFnGeneratorRegistry','sap/viz/controls/chart/adapters/renderer/RendererInfoBase','sap/viz/controls/common/utils/ChartTypeUtil'],function(r,$,P,E,V,O,U,a,R,C){var b=r||b;var c=function(h,d){c.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.adapters.PropertyAdapter';this._helper=h;this._rendererInfo={};if(d){this._loadRendererInfo(d)}};O.extend(c,E);c.prototype.query=function(o){if(o&&o.propertyZones){var z=o.propertyZones;var p=o.propertyFields;var d=o.chartType;var m;for(var i in z){var e={};for(var l in p){if(p[l]===true){var f=z[i];var g=P.getPropConfig(f.type(),C.isHorizontal(d));if(g&&g[l]){var h=g[l];h.vizPath=h.vizPath||l;if(h.vizPath){e[l]=this._getVizProp(h.vizPath)}if(h.renderer){h.renderer.paraName=h.renderer.paraName||l;var j=this._rendererInfo[h.renderer.id];if(j){var k=f.getDimensionContext();if(h.renderer.useStackContext){k=f.stackContext()}var n=j.getProperty(k,h.renderer.paraName);if(n!==undefined){e[l]=n}}}}else{e[l]=this._getVizProp(l)}}}if(!m){m=e}else{for(var l in e){if(!U.deepEqual(m[l],e[l])){m[l]=null}}}}return m}return null};c.prototype._getCfg=function(p,d){for(var l in p){if(p&&p[l]&&p[l].renderer&&p[l].renderer.paraName===d){return p[l]}}return null};c.prototype.update=function(o){if(!o||!o.propertyZones){return}var p=o.propertyZones;var d=o.properties;var e=o.chartType;var f={};var n={};for(var i in p){var g=p[i];var h=P.getPropConfig(g.type(),C.isHorizontal(e));var j={};for(var k in d){var l=d[k];if(h&&h[k]){var m=h[k];if(m.renderer){var q=m.renderer;if(!this._rendererInfo[q.id]){this._rendererInfo[q.id]=new q.infoClass(q.id,q.vizPath)}j[q.id]=this._rendererInfo[q.id];var s=g.getDimensionContext();if(q.useStackContext===true){s=g.stackContext()}this._rendererInfo[q.id].setProperty(s,q.paraName,l)}else if(m.vizPath){n[m.vizPath]=l}}else{n[k]=l}}for(var t in j){var u=j[t];if(u.simplify().length>0){f[u.vizPath]=u}else{f[u.vizPath]=undefined}if(u.fallbackParas()){var v=u.fallbackParas();for(var w in v){var x=v[w];var m=this._getCfg(h,w);if(m&&m.vizPath){n[m.vizPath]=x}}}}}var d={};for(var y in f){var u=f[y];if(u){c._parseVizPath(y,c._getRenderer(u.generator,u.parameters()),d)}else{c._parseVizPath(y,null,d)}}for(var y in n){c._parseVizPath(y,n[y],d)}this._helper.propertiesWithEvents(d)};c.prototype._getVizProp=function(p){var v=this._helper.vizProperties();try{var d=p.split('.');for(var i in d){v=v[d[i]]}}catch(e){return undefined}return v};c.prototype.saveRendererInfo=function(){var j={};for(var i in this._rendererInfo){j[i]=this._rendererInfo[i].toJSON()}return j};c.parseRendererInfo=function(d,p){p=p||{};for(var i in d){var e=d[i];c._parseVizPath(e.vizPath,c._getRenderer(e.generator,e.parameters),p)}return p};c.prototype._loadRendererInfo=function(d){var e=[];for(var i in d){var f=d[i];e.push(f.implClassPath)}for(var i in d){this._rendererInfo[i]=R.fromJSON(d[i])}};c._getRenderer=function(n,p){var g=a.get(n);return(g)?g.generateFn(p):null};c._parseVizPath=function(v,d,p){var e=v.split('.');if(e.length>0){var t=p;for(var i=0;i<e.length;i++){if(i===e.length-1){t[e[i]]=d;break}t[e[i]]=t[e[i]]||{};t=t[e[i]]}}return p};return c});define('sap/viz/controls/chart/views/InfoChartView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/chart/adapters/InteractionAdapter','sap/viz/controls/chart/adapters/PropertyAdapter','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View','sap/viz/controls/chart/views/EditAxisView'],function($,O,C,a,L,A,b,c,F,V,I,d,P,f,g,E){var h=function(e,o,l,i){h.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.views.InfoChartView';this._useBuiltInPropertyZoneInteraction=o.useBuiltInPropertyZoneInteraction;this._iAdapter=null;this._pAdapter=null;this._rendererInfo=null;this._createChildren()};O.extend(h,g);h.prototype._createChildren=function(){h.superclass._createChildren.apply(this,arguments);this._editAxisView=new E(this._chartHolder$.get(0),null);this._editAxisView.addEventListener(E.AxisScaleChanged,this._axisScalerChangedHandler,this)};h.prototype._createChartInstance=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');if(!this._options){return}var o=this._options;if(this._useBuiltInPropertyZoneInteraction===true){o.properties=o.properties||{};o.properties.interaction={behaviorType:'DesignTimeBehavior'}}try{this._destroyChartInstance();this._updateDescription();this._chart=this._chartProxy.execute('sap.viz.api.core.createViz',{type:o.type,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:this._chartLayer$.get(0)});if(this._chart){this._postVizProcess(o)}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create')}catch(e){var v=o.type;var i=L.get('VIZ_CHART_CREATE_CHART_FAILED')+e;if(!F.getVizFeeds(v)){this._updateDescription(utils.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(i)}this._chartLayer$.html("");this._chart=null;this._hasChartInstance=false;throw i}};h.prototype.setAxisScale=function(e){if(this._chart){var t=this._options.type;this._editAxisView.show(t,this._chartProxy.get('properties',this._options.properties),e)}};h.prototype._axisScalerChangedHandler=function(e){if(!this._chart){return}this._helper.propertiesWithEvents(e.data)};h.prototype._postVizProcess=function(o){h.superclass._postVizProcess.apply(this,arguments);this._chart.on('initialized.create',$.proxy(function(){if(!this._chart){return}this._chart.off('initialized.create');if(!this._iAdapter){this._iAdapter=new d(this._helper);this._iAdapter.addEventListener(f.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new f(f.PROPERTY_ZONES_CHANGED,this,e.data))},this)}if(!this._pAdapter){this._pAdapter=new P(this._helper,this._rendererInfo);this._pAdapter._ownerDom$=this._dom$}this._dispatchEvent(new f(f.PROPERTY_ZONES_CHANGED,this,{'propertyZones':[new V(V.CHART_AREA)]}))},this))};h.prototype.hasChartInstance=function(){return this._chart!==null};h.prototype.properties=function(v){if(arguments.length>0){this._options.properties=v;if(this._chart){this._chartProxy.set('properties',v);return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('properties',this._options.properties)}};h.prototype.copyData=function(t,e){var r=e.data();var i=new sap.viz.api.data.FlatTableDataset(r);return i};h.prototype.buildFeedings=function(t,e,i){var n=null;var j=false;if(F.hasMND(i)||(F.countAnalyses(i,b.MEASURE)===0)){n=i}else{var v=I.getVizType(t);if(v!==a.TYPE_BULLET){n=c.directFeeding(i,v,[A.genMND()]);j=true}else{n=i}}return I.buildInfoFeeding(n,j)};h.prototype.feeding=function(e){try{if(this._chart){if(arguments.length>0){this._chartProxy.set('feeding',e);return this}else{return this._chartProxy.get('feeding',this._options.feeding)}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(i){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+i}};h.prototype.getPropertyZones=function(){if(this._iAdapter){return this._iAdapter.propertyZones()}else{return[]}};h.prototype.setPropertyZones=function(p){if(this._iAdapter){this._iAdapter.propertyZones(p)}};h.prototype.queryProperties=function(o){return this._pAdapter?this._pAdapter.query(o):{}};h.prototype.updateProperties=function(o){if(this._pAdapter){this._pAdapter.update(o)}};h.prototype.save=function(){if(this._pAdapter){return{'pAdapter':{'rendererInfo':this._pAdapter.saveRendererInfo()}}}else{return{}}};h._migrateRenderInfo=function(r){var e="categoryAxis.labelRenderer.categoryAxisLabelRenderer";if(!r||r[e]){return}var i;var x="xAxis.labelRenderer.categoryAxisLabelRenderer";var y="yAxis.labelRenderer.categoryAxisLabelRenderer";if(r[x]){i=r[x];delete r[x]}else if(r[y]){i=r[y];delete r[y]}if(i){r[e]=i;i.id=e;i.vizPath="categoryAxis.labelRenderer"}};h.prototype.load=function(j,v){if(j&&j.pAdapter){h._migrateRenderInfo(j.pAdapter.rendererInfo);this._rendererInfo=j.pAdapter.rendererInfo;P.parseRendererInfo(j.pAdapter.rendererInfo,v)}};h.prototype.css=function(e){try{if(arguments.length>0){this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chartProxy.set('css',e);return this}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('css',this._options.css)}}catch(i){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+i}};h.prototype.data=function(e){if(this._chart){try{if(arguments.length>0){this._chartProxy.set('data',e)}else{return this._chartProxy.get('data',this._options.data)}}catch(i){errorMsg=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+i;this._updateDescription(errorMsg);throw errorMsg}}else{return h.superclass.data.apply(this,arguments)}};h.prototype.exportViz=function(o){if(this._chart){var r=this._chartProxy.execute('toJSON',o);if(r){r.properties=this._options.properties;delete r.css}return r}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};return h});define('sap/viz/controls/chart/views/ESRIServicePanel',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent'],function($,C,O,V,L,a){var E=function(d,u){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServicePanel";this._uiconfig=u;this._div=d;this._serviceGallery$=null;this.createChildren()};O.extend(E,V);E.prototype.createChildren=function(){this._serviceGallery$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery').appendTo(this._div)};E.prototype.init=function(s,t,b){var c=this;var d=function(){$('.'+C.CHART_PREFIX+'map-service-selector-services-item-icon').removeClass(C.CHART_PREFIX+'map-service-selector-services-item-icon-selected');$(this).addClass(C.CHART_PREFIX+"map-service-selector-services-item-icon-selected");c._dispatchEvent(new a(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId"),}))};this._serviceGallery$.empty();if(s&&s.length>0){var e,f,g,h;for(var i=0;i<s.length;i++){e=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item').appendTo(this._serviceGallery$);f=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item-icon').appendTo(e);f.attr("title",s[i].description);f.data("__serviceId",s[i].id);f.data("__serviceUrl",s[i].url);f.on("click",d);g=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item-title').appendTo(e);g.html(s[i].title);h="url(https://www.arcgis.com/sharing/rest/content/items/"+s[i].id+"/info/"+s[i].thumbnail+"?token="+t+")";f.css({"background-image":h});if(b&&b===s[i].id){f.addClass(C.CHART_PREFIX+"map-service-selector-services-item-icon-selected")}}}};E.prototype.getSelectedService=function(){return{id:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId"),url:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceUrl")}};E.prototype.show=function(){this._serviceGallery$.show()};E.prototype.hide=function(){this._serviceGallery$.hide()};return E});define('sap/viz/controls/chart/views/ESRIServiceColor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent'],function($,C,O,V,L,a){var E=function(d,u){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServiceColor";this._uiconfig=u;this._div=d;this._serviceColor$=null;this._fieldsSelector$=null;this._startVal$=null;this._startColor$=null;this._endVal$=null;this._endColor$=null;this.createChildren()};O.extend(E,V);E.prototype.createChildren=function(){this._serviceColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-panel').appendTo(this._div);$(document.createElement('div')).html(L.get('VIZ_CHART_SELECT_DATASET')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-title').appendTo(this._serviceColor$);this._fieldsSelector$=$(document.createElement('select')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-selector').appendTo(this._serviceColor$);this.createGradient()};E.prototype.createGradient=function(){var g=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-title-group').appendTo(this._serviceColor$);$(document.createElement('div')).html(L.get('VIZ_CHART_SET_COLOR_LAYER')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-title-label').appendTo(g);this._reset$=$(document.createElement('div')).html(L.get("VIZ_CHART_RESET")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-reset').on("click",function(){this._startVal$.val(this._startVal$.prop("defaultValue"));this._endVal$.val(this._endVal$.prop("defaultValue"))}.bind(this)).appendTo(g);var b=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient').appendTo(this._serviceColor$);$(document.createElement('div')).html(L.get("VIZ_CHART_START")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-start').appendTo(b);var s=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value-group1').appendTo(b);this._startVal$=$(document.createElement('input')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value').attr("value","0").appendTo(s);this._startColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-colorpicker').css("background-color","#c2e3a9").appendTo(s);$(document.createElement('div')).html(L.get("VIZ_CHART_END")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-end').appendTo(b);s=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value-group2').appendTo(b);this._endVal$=$(document.createElement('input')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value').attr("value","100").appendTo(s);this._endColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-colorpicker').css("background-color","#35581C").appendTo(s)};E.prototype.init=function(s,c){$.ajax({url:s,data:{f:"json"},dataType:"json",type:"POST",success:function(r){this._fieldsSelector$.empty();var v=r.fields.filter(function(f){return f.type==="esriFieldTypeSmallInteger"||f.type==="esriFieldTypeInteger"||f.type==="esriFieldTypeSingle"||f.type==="esriFieldTypeDouble"});for(var i=0;i<v.length;i++){$(document.createElement('option')).attr('value',v[i].name).html(v[i].name).appendTo(this._fieldsSelector$)}}.bind(this)})};E.prototype.show=function(){this._serviceColor$.show()};E.prototype.hide=function(){this._serviceColor$.hide()};E.prototype.getColor=function(){return{type:"gradient",bindedField:this._fieldsSelector$.val(),start:{val:this._startVal$.val(),color:this._startColor$.css("background-color")},end:{val:this._endVal$.val(),color:this._endColor$.css("background-color")}}};return E});define('sap/viz/controls/chart/views/ESRIServiceSelector',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/ESRIServicePanel','sap/viz/controls/chart/views/ESRIServiceColor'],function($,C,O,V,L,a,E,b){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIMapServiceSelector";this._uiconfig=u;this._div=d;this._titleDiv$=null;this._footerDiv$=null;this._servicesDiv$=null;this._servicePanel=null;this._serviceColor=null;this._btnDone$=null;this._btnLayer$=null;this._btnConfirm$=null;this.createChildren()};O.extend(c,V);c.prototype.createChildren=function(){this._titleDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-title').html(L.get('VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE')).appendTo($(this._div));this._servicesDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-panel').appendTo($(this._div));this._servicePanel=new E(this._servicesDiv$);this._serviceColor=new b(this._servicesDiv$);$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery-close').on("click",function(){this.hide()}.bind(this)).appendTo($(this._div));this._servicePanel.addEventListener(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,function(e){if(e.data.serviceId){this._btnConfirm$.show();this._btnDone$.hide()}else{this._btnConfirm$.hide();this._btnDone$.show()}}.bind(this));this._footerDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-footer').appendTo($(this._div));this._btnDone$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-done').html(L.get('VIZ_CHART_CONFIRM')).on("click",function(){this.hide();this._dispatchEvent(new a(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:this._servicePanel.getSelectedService().id,color:this._serviceColor.getColor()}))}.bind(this)).appendTo(this._footerDiv$);this._btnConfirm$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-confirm').html(L.get('VIZ_CHART_NEXT')).on("click",function(){this._btnConfirm$.hide();this._btnDone$.show();this._btnLayer$.show();this._servicePanel.hide();this._serviceColor.init(this._servicePanel.getSelectedService().url);this._serviceColor.show()}.bind(this)).appendTo(this._footerDiv$);this._btnLayer$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-layer').html(L.get('VIZ_CHART_BACK')).on("click",function(){this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide()}.bind(this)).appendTo(this._footerDiv$);this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide()};c.prototype.show=function(s,t,d){this._servicePanel.init(s,t,d);if(!d){this._btnConfirm$.hide();this._btnDone$.show()}else{this._btnLayer$.hide();this._btnDone$.hide();this._btnConfirm$.show()}this._servicePanel.show();this._serviceColor.hide();$(this._div).show()};c.prototype.hide=function(){$(this._div).hide()};return c});define('sap/viz/controls/chart/views/EsriNoService',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager'],function setup($,C,l){var E=function(d){this.__className="sap.viz.controls.chart.views.EsriNoSerive";this._div=d;this._titleDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-no-service-title').html(l.get('VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE')).appendTo($(this._div));this._messageDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-no-serive-message').html(l.get('VIZ_CHART_NO_ESRI_SERVICE')).appendTo($(this._div));$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery-close').on("click",function(){this.hide()}.bind(this)).appendTo($(this._div))};E.prototype.hide=function(){$(this._div).hide()};E.prototype.show=function(){$(this._div).show()};return E});define('sap/viz/controls/chart/views/MapView',['require','jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/chart/views/ESRIServiceSelector','sap/viz/controls/chart/views/EsriNoService'],function(r,$,G,C,D,M,E,F,a,b,L,O,u,c,T,V,d,g,h,k,I,A,l,m,n){var o=r||o;var p=function(e,f,i){e.splice(i,0,e.splice(f,1)[0])};var q=function(e,f,i,j){q.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.MapView";this._mapselector$=null;this._mapNoService$=null;this._mapNoService=null;this._mapServiceSelector=null;this._esriservices=null;this._selectedServiceId=undefined;this._loadedViz=null;this._mapInitialized=false;this._updateCache=null;this._createChildren();sap.viz.extapi.env.Template.removeListener(this._changeTemplateFunc)};O.extend(q,k);q.prototype._createChildren=function(){q.superclass._createChildren.apply(this,arguments);this._createESRIMapServiceSelector()};q.prototype._createESRIMapServiceSelector=function(){this._mapselector$=$(document.createElement('div')).addClass(d.CHART_PREFIX+'map-service-selector').appendTo($(this._div));this._mapNoService$=$(document.createElement('div')).addClass(d.CHART_PREFIX+'map-no-service').appendTo($(this._div));this._mapNoService=new n(this._mapNoService$);this._mapNoService.hide();this._mapServiceSelector=new m(this._mapselector$);this._mapServiceSelector.addEventListener(g.ESRI_CUSTOMIZED_SERVICE_CHANGED,this._esriServiceChanged.bind(this));this._mapServiceSelector.hide()};q.prototype._esriServiceChanged=function(e){var f=e.data.serviceId;this._selectedServiceColor=e.data.color;this._enableService=true;if(!this._selectedServiceId){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:this._enableService}}})}this._selectedServiceId=f;this._changeBaseMap({serviceId:f,color:this._selectedServiceColor})};q.prototype._changeBaseMap=function(e){var i=e.serviceId;var f=e.color;var j;if(!i){j=new sap.viz.geo.basemap.esri.Provider({basemap:this._chart.baseMap().toJSON().options.basemap})}else{var v=this._esriservices.filter(function(w){return w.id===i});var w=[{}];w[0].type=sap.viz.geo.basemap.esri.Provider.ARCGIS_SERVICE_TYPE_FEATURE;w[0].url=v[0].url;w[0].options={outFields:["*"]};w[0].color=f;j=new sap.viz.geo.basemap.esri.Provider({extent:new esri.geometry.Extent(-115,-34,115,7),basemap:this._chart.baseMap().toJSON().options.basemap},w)}this._chart.baseMap(j)};q.prototype._showRefreshButton=function(){this._refresh$.css({left:$(this._div).width()/2-this._refresh$.width()/2});this._refresh$.css({top:$(this._div).height()/2-this._refresh$.height()/2+40});this._refresh$.show()};q.prototype.modelChanged=function(e,f){if(f.vizTypeChanged){this.showLoadingIcon()}if(f.feedingItemsChanged&&f.feedsChangedInfo&&f.feedsChangedInfo.items){var v=f.feedsChangedInfo.items[0];var w=e.feedingItems()[v];var x=new F(F.FEEDS_CHANGED,this,{'datasetType':D.FLAT_TABLE,'feeds':w,'layerIdx':v});this._dispatchEvent(new E(k.DISPATCH_PROPERTY_EVENT,this,x))}if(f.extensionValuesChanged){var y=e.extensionValues();if(y.mapBuilder){var z=y.mapBuilder;var B=this._chart;if(z&&B){if(z.layer){var H=z.layer.action;var v=z.layer.idx;var J=z.layer.from;var K=z.layer.to;if(H==='add'){B.addLayer(new sap.viz.geo.dataviz.Layer({viz:new sap.viz.geo.dataviz.Choropleth(),legendVisible:true}),true);var N=e.feedingItems();N.push(z.layer.feeds);e.feedingItems(N,false);if(!this._options.data){this._options.data=[]}if(!this._options.feeding){this._options.feeding=[]}this._options.data.push(undefined);this._options.feeding.push(undefined)}else if(H==='delete'&&v>=0){B.removeLayer(B.getLayer(v));var N=e.feedingItems();N.splice(v,1);e.feedingItems(N,false);this._options.data.splice(v,1);this._options.feeding.splice(v,1)}else if(H==='reorder'&&J>=0&&K>=0){B.reorderLayer(B.getLayer(J),K);var P=e.feedingItems();p(P,J,K);e.feedingItems(P,false);p(this._options.data,J,K);p(this._options.feeding,J,K)}else if(H==='show'&&v>=0){var Q=B.getLayer(v);Q.visibility(true)}else if(H==='hide'&&v>=0){var Q=B.getLayer(v);Q.visibility(false)}else if(H==='changeVizType'&&v>=0){var Q=B.getLayer(v);var R=z.layer.vizType;var S=z.layer.feeding;var U,W,X,Y,Z,_;if(S!==null){for(var i=0;i<S.length;i++){W=S[i];if(W){for(var j=0;j<W.values().length;j++){var id=W.values()[j].id();if(W.id()==="location"){X=id}else if(W.id()==="color"){Y=id;Z=W.type()}else if(W.id()==="size"){_=id}}}}Q.data(null)}if(R==='choropleth'){if(S!==null){U={};if(X){U.location=X}if(Z===a.MEASURE&&Y){U.color=Y}Q.viz(new sap.viz.geo.dataviz.Choropleth(),U)}else{Q.viz(new sap.viz.geo.dataviz.Choropleth())}}else if(R==='bubble'){if(S!==null){U={};if(X){U.location=X}if(_){U.size=_}if(Z===a.DIMENSION&&Y){U.color=Y}Q.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}),U)}else{Q.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}))}}else if(R==='marker'){if(S!==null){U={};if(X){U.location=X}Q.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false}}),U)}else{Q.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false}}))}}}else if(H==='changeProperties'&&v>=0){var Q=B.getLayer(v);var b1=z.layer.propKey;var c1=z.layer.propValue;if(b1==='markerCluster'||b1==='bubbleCluster'){Q.viz().properties({cluster:{enabled:c1}})}}}else if(z.mapservice){if(z.mapservice.action==='choose'){this._chooseMapServiceAsBaseMap()}else if(z.mapservice.action==='enable'){this._enableService=true;this._changeBaseMap({serviceId:this._selectedServiceId,color:this._selectedServiceColor})}else if(z.mapservice.action==='disable'){this._mapServiceSelector.hide();this._enableService=false;this._changeBaseMap({})}}}}}};q.prototype.data=function(e){if(arguments.length>0){this._options.data=e;if(this._chart){this._chartProxy.set('map_doData',e);return this}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('map_doData',this._options.data)}};q.prototype.doData=function(e){try{if(arguments.length>0){if(this._chart){if(!e.length){return this}var f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var j=f.length>e.length?e.length:f.length;for(var i=0;i<j;++i){if(e[i]){f[i].data(e[i])}}return this}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{var v=[];if(this._chart){var f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<f.length;++i){v.push(f[i].data())}}return v}}catch(w){throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+w}};q.prototype.action=function(e,f){if(this._chart){if(this._chart.__instance){return this._chart.__instance.action(e,f)}else{return this._chart}}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};q.prototype.exportViz=function(e){if(!this._isMapInitialized()&&this._loadedViz){return this._loadedViz}if(this._chart){var f=this._chartProxy.execute('toJSON',e);if(f){f.esriServices=[this._exportEsriService()]}return f}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};q.prototype._exportEsriService=function(){return{serivceId:this._selectedServiceId,color:this._selectedServiceColor,enableService:!!this._enableService}};q.prototype._loadEsriService=function(v){if(v.esriServices&&v.esriServices.length>0){this._selectedServiceId=v.esriServices[0].serivceId;this._selectedServiceColor=v.esriServices[0].color;this._enableService=v.esriServices[0].enableService}};q.prototype.loadViz=function(v){this._destroyChartInstance();if(!v.baseMap){this._options=this._options||{};this._options.properties=this._options.properties||{};this._options.properties.tooltip=v.properties.tooltip;this._createChartInstance();return}this._options=this._options||{};this._options.data=v.data;this._options.feeding=v.feeding;this._options.properties=v.properties;this._loadedViz=u.clone(v);this._loadEsriService(this._loadedViz);this._hasChartInstance=true;this._mapInitialized=false;this._dispatchEvent(new g(g.CHART_CHANGING,this,v.type));this._updateDescription();this.showLoadingIcon();var e={};if(v.properties&&v.properties.tooltip){e.tooltip=v.properties.tooltip}var f=this._chartLayer$;var i=sap.viz.api.core.createViz({type:v.type,container:f.get(0),options:e});this._chart=i.action("getMap");this._chart.__instance=i;this._bindExternalEventListener();if(v.baseMap.id.indexOf("esri")!==-1){this._logonESRI(function(){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));this._chart.fromJSON(v);this._postVizProcess(this._options)}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized")}}.bind(this))}else if(v.baseMap.id.indexOf("cvom")!==-1){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});this._chart.fromJSON(v);this._postVizProcess(this._options)}else if(v.baseMap.id.indexOf("navtaq")){this._chart.fromJSON(v);this._postVizProcess(this._options)}};q.prototype._setChartSize=function(w,e){if(this._chart&&this._chart.__instance){this._chart.__instance.size({width:w,height:e})}};q.prototype._updateDescription=function(e){if(e){this._descriptionLayer$.show();this._descriptionLayer$.text(e);this._showDescription()}else{this._descriptionLayer$.hide();this._chartHolder$.css({'opacity':""})}this.hideLoadingIcon()};q.prototype.getTitleByFeeding=function(){return''};q.prototype._logonESRI=function(e,f){var i=sap.viz.geo.basemap.esri.Authentication.credential().disabled;if(i){this._updateDescription(sap.viz.geo.basemap.esri.Authentication.credential().description);f.call(this);return}var j=sap.viz.geo.basemap.esri.Authentication.credential().accessToken;if(!j){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOG_ON'));sap.viz.geo.basemap.esri.Authentication.login({credential:{}},function(){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));e.call(this)}.bind(this),function(v){if(v===null||v===undefined||v===''){this._updateDescription(L.get('VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE'))}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL')+": "+v)}f.call(this)}.bind(this))}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOG_ON'));sap.viz.geo.basemap.esri.Authentication.checkLoginStatus(j,function(){e.call(this)}.bind(this),function(v){if(v===null||v===undefined||v===''){this._updateDescription(L.get('VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE'))}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL')+": "+v)}f.call(this)}.bind(this))}};q.prototype._createChartInstance=function(){var e=this._options;var f=this._chartLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var v=C.TYPE_GEO_MAP;this._destroyChartInstance();try{this._dispatchEvent(new g(g.CHART_CHANGING,this,v));var w=sap.viz.api.core.createViz({type:v,container:f.get(0),options:{tooltip:this.properties().tooltip}});this._chart=w.action("getMap");this._chart.__instance=w;this._bindExternalEventListener();this._hasChartInstance=true;this._mapInitialized=false;var x=M.ESRI;if(x===M.ESRI){this._logonESRI(function(){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));var y=this.createBaseMap(x,{});this._chart.baseMap(y,this._afterMapInitialized.bind(this));this._postVizProcess(e)}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized")}}.bind(this))}else{var y=this.createBaseMap(x,{});this._chart.baseMap(y,this._afterMapInitialized.bind(this));this._postVizProcess(e)}}catch(z){var B=L.get('VIZ_CHART_CREATE_CHART_FAILED')+z;if(!b.getVizFeeds(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(B)}f.html("");this._chart=null;this._hasChartInstance=false;throw B}};q.prototype._afterMapInitialized=function(e){var f=$.proxy(function(i,e){this._dispatchEvent(new g(g.TRIGGER_CVOM_EVENT,this,{type:i,data:e}))},this);this.hideLoadingIcon();this._updateDescription();var v=this._chartModelProvider();f("initialized",e);if(!this._loadedViz&&this._isMapInitialized()===false){this._chartModelProvider().extensionValues({map:{created:true}})}else if(this._loadedViz){this._restoreMapBuilder()}this._mapInitialized=true;if(this._updateCache){this.update(this._updateCache);this._updateCache=null}};q.prototype._bindExternalEventListener=function(){if(this._chart){Object.keys(this._onEventMap).forEach($.proxy(function(e){var f=this._onEventMap[e];this._chart.on(e,f)},this))}};q.prototype._postVizProcess=function(e){var f=$.proxy(function(i,j){this._dispatchEvent(new g(g.TRIGGER_CVOM_EVENT,this,{type:i,data:j}))},this);this._chart.on("initialized.chartview",this._afterMapInitialized.bind(this));this._chart.on("mapChanged.chartview",function(){this._chartModelProvider().extensionValues({})}.bind(this));var _=this;this._chart.on("selectData.chartview",function(i){_._dispatchEvent(new g(g.CHANGED_SELECTED_DATA,this));f("selectData",i)});this._chart.on("deselectData.chartview",function(i){_._dispatchEvent(new g(g.CHANGED_SELECTED_DATA,this));f("deselectData",i)});this._chart.on("showTooltip.chartview",function(i){f("showTooltip",i)});this._chart.on("hideTooltip.chartview",function(i){f("hideTooltip",i)});this._hasChartInstance=true;this._dispatchEvent(new g(g.CHART_CHANGED,this,this._chart))};q.prototype.getTemplateId=function(e){return this._templateId};q.prototype._isMapInitialized=function(){return this._mapInitialized};q.prototype.update=function(e){if(this._isMapInitialized()){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');var f;try{if(e.data){if(!this._options.data){this._options.data=[]}for(var i=0;i<e.data.length;i++){if(e.data[i]!==undefined){this._options.data[i]=e.data[i]}}}var j=e.properties;if(j){this._options.properties=j}if(e.feeding){this._options.feeding=e.feeding}if(!this._chart){f=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(f);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');throw f}this._updateDescription();this._chartLayer$.css('opacity','');var v=this._chart;if(v){this._chartProxy.execute('map_doUpdate',v,e)}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');return this}catch(w){f=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+w;this._updateDescription(f);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');throw f}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update')}else{this._updateCache=e}};q.prototype.doUpdate=function(e,f){if(!e||!f){return}if(f.data){for(var i=0;i<f.data.length;i++){if(f.data[i]||f.data[i]===null){var j=e.getLayer(i);var v=f.feeding?f.feeding[i]:null;if(j){j.data(f.data[i],v,true)}}}}if(f.properties){var w=f.properties.layers;if(w){w.forEach(function(x,y){if(x){t(e.getLayer(y),x.formats)}})}}};var s={bubble:{measureFeedId:"size",legendPropName:"sizeLegend"},choropleth:{measureFeedId:"color",legendPropName:"mbcLegend"}};function t(e,f){if(e&&f){var v=e.viz();var i;if(v instanceof sap.viz.geo.dataviz.Marker){i="marker"}else if(v instanceof sap.viz.geo.dataviz.Bubble){i="bubble"}else if(v instanceof sap.viz.geo.dataviz.Choropleth){i="choropleth"}if(i){var j=s[i];if(j){var w=j.measureFeedId;function x(H){var J=f[H];if(J){J=J[w];J=J&&J[0]}return J};var y=x("viz");if(y){var z={};z[j.legendPropName]={formatString:y};v.properties(z)}var B=x("tooltip")||y;if(B){e.tooltipFormat(B)}}}}};q.prototype.feeding=function(f,e){if(this._chart){if(arguments.length>0&&f.length>0){this._options.feeding=f;this._chartProxy.set('map_doFeeding',f,e);return this}else{return this._chartProxy.get('map_doFeeding',this._options.feeding)}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};q.prototype.doFeeding=function(f,e){try{if(this._chart){if(arguments.length>0&&f.length>0){var j=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var v=j.length>f.length?f.length:j.length;for(var i=0;i<v;++i){if(f[i]){j[i].feeding(f[i])}}return this}else{var w=[];var j=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<j.length;++i){var x=j[i].feeding();w.push(x)}return w}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(y){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+y}};q.prototype.getValidProperties=function(e,f){if(f===C.TYPE_GEO_MAP){return e}return V.getValidProperties(e,f)};q.prototype.properties=function(e){if(arguments.length>0){this._options.properties=e;if(this._chart){this._chartProxy.set('map_doProperties',e);return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._options.properties}};q.prototype.doProperties=function(e){try{if(arguments.length>0){if(this._chart){var f=this._chart;var j=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<j.length;i++){var v=j[i];if(v&&e.legend){v.legendVisibility(e.legend.visible)}}return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}}catch(w){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+w}};q.prototype.copyData=function(e,f){if(f&&f.length>0){var j=[];for(var i=0;i<f.length;i++){if(f[i]&&f[i].id&&(f[i].id==="sap.viz.data.FlatTableDataset")){var v=sap.viz.api.data.FlatTableDataset.fromJSON(f[i]);j.push(v)}else j.push(f[i])}return j}else{return f}};q.prototype.buildFeedings=function(e,v,w){var x=[];for(var i=0;i<w.length;i++){x[i]={};if(!w[i]||w[i].length===0){continue}w[i].forEach(function(f){if(f._values&&f._values.length){if(f._values[0].type()===A.HIERARCHY){for(var j=0;j<f._values[0].hierarchyLevels().length;j++){var y=f._values[0].hierarchyLevels()[j];if(y.selected()){x[i][f._id]=y._id;break}}}else{x[i][f._id]=f._values[0]._id}}})}return x};q.prototype.createBaseMap=function(e,f){var i=null;if(e===M.ESRI){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});var j='topo';if(f&&f.type){j=f.type}return new sap.viz.geo.basemap.esri.Provider({basemap:j})}else if(e===M.NAVTEQ){var v={center:[40.72,-84],zoomLevel:5};return new sap.viz.geo.basemap.navteq.Provider(v)}else{sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});var v={center:[-84,40.72],scale:6000};return new sap.viz.geo.basemap.cvom.Provider(f)}};q.prototype.FeedsToJSON=function(f){var e=[];for(var i=0;i<f.length;i++){e[i]=l.toJSON(f[i])}return e};q.prototype.FeedsFromJSON=function(v){var f=[];for(var i=0;i<v.length;i++){f[i]=l.fromJSON(v[i])}return f};q.prototype._queryEsriServices=function(e){var f=sap.viz.geo.basemap.esri.Authentication.credential();if(f!=null){var i="https://www.arcgis.com/sharing/rest/content/users/"+f.username;$.ajax({url:i,data:{token:f.accessToken,f:"json"},dataType:"json",type:"POST",success:function(j){if(j.items){this._esriservices=j.items.filter(function(v){return v.type==="Feature Service"});e()}}.bind(this)})}};q.prototype._chooseMapServiceAsBaseMap=function(){this._queryEsriServices(function(){if(this._esriservices&&this._esriservices.length>0){var e=$(this._div).height()/2-this._mapselector$.height()/2;var f=$(this._div).width()/2-this._mapselector$.width()/2;this._mapselector$.css({top:e,left:f});this._mapServiceSelector.show(this._esriservices,sap.viz.geo.basemap.esri.Authentication.credential().accessToken,this._selectedServiceId)}else{var e=$(this._div).height()/2-this._mapNoService$.height()/2;var f=$(this._div).width()/2-this._mapNoService$.width()/2;this._mapNoService$.css({top:e,left:f});this._mapNoService.show()}}.bind(this))};q.prototype._getVizTypeByVizId=function(v){if(v==="sap.viz.geo.dataviz.Bubble"){return"bubble"}else if(v==="sap.viz.geo.dataviz.Marker"){return"marker"}else{return"choropleth"}};q.prototype._restoreMapBuilder=function(e){if(this._loadedViz){var f=[];if(this._loadedViz.layers.length>0){var j=this._chartModelProvider().feedingItems();for(var i=0;i<this._loadedViz.layers.length;i++){var v=this._getVizTypeByVizId(this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].id);var w="";if(j[i].length>0){if(j[i][0].values().length>0){w=j[i][0].values()[0].name()}}var x=false;if(v==="bubble"||v==="marker"){x=this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].options.cluster.enabled}var y={checked:this._loadedViz.layers[i].options.visible,feeding:{feeding:this.FeedsToJSON(j[i])},title:w,titleText:v,vizType:v,sortable:true,clusterChecked:x};f.push(y)}}this._chartModelProvider().extensionValues({mapBuilder:{status:f}})}if(this._loadedViz&&this._selectedServiceId){this._queryEsriServices(function(){if(this._esriservices&&this._esriservices.length>0){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:!!this._enableService}}})}}.bind(this))}this._loadedViz=null};q.prototype.exportable=function(){return this._chart!=null};q.prototype.exportToSVGString=function(e){return""};q.prototype.queryProperties=function(e){return{}};q.prototype.updateProperties=function(e){};q.prototype.selectedPropertyZone=function(){if(arguments.length){return this}return null};return q});define('sap/viz/controls/chart/views/TableView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost'],function($,G,C,D,M,E,F,a,L,O,u,b,T,V,c,d,e,f,I){var g=function(h,o,l,i){g.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.TableView";this._createChildren();sap.viz.extapi.env.Template.addListener($.proxy(this.changeTemplate,this))};O.extend(g,f);g.prototype._createChildren=function(){g.superclass._createChildren.apply(this,arguments);this._createDropZone()};g.prototype.getTitleZone=function(){if(!this._chart){return[]}var t=this._options.type;var z;try{z=this._chartProxy.get('propertyZone',[])}catch(h){return[]}var j=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){j=z[i].bound[0];break}}return j};g.prototype.properties=function(p,h){try{if(!h){this._requestMorphing=true}if(arguments.length>0){this._options.properties=p;if(this._chart){this._chartProxy.set('properties',p);return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('properties',this._options.properties)}}catch(i){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+i}};g.prototype.css=function(h){try{if(arguments.length>0){this._updateCssCacheByNewCss(h);this._options.css=h;if(this._chart){this._chartProxy.set('css',h);return this}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._chartProxy.get('css',this._options.css)}}catch(i){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+i}};g.prototype._createChartInstance=function(){this._hasChartInstance=false;var o=this._options;var h=this._chartLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var v=o.type;this._supportMorphing=false;this._destroyChartInstance();try{this._dispatchEvent(new d(d.CHART_CHANGING,this,v));this._updateDescriptionByOptions(o);this._chart=this._chartProxy.execute('sap.viz.api.core.createViz',{type:v,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:h.get(0)});if(this._chart){this._postVizProcess(o)}}catch(k){var l=L.get('VIZ_CHART_CREATE_CHART_FAILED')+k;if(!a.getVizFeeds(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(l)}h.html("");this._chart=null;this._hasChartInstance=false;throw l}};g.prototype._postVizProcess=function(o){Object.keys(this._onEventMap).forEach($.proxy(function(k){var h=this._onEventMap[k];this._chart.on(k,h)},this));this._hasChartInstance=true;this._dispatchEvent(new d(d.CHART_CHANGED,this,this._chart))};g.prototype.buildFeedings=function(t,h,i){var j=null;if(!h||b.isEmptyData(t,h)){return j}if(!V.hasFakeData(h)&&!b.isEmptyData(t,h)&&!a.isEmptyFeeds(i)){j=[];i.forEach(function(k){var l=k.id();j[l]=[];k.values().forEach(function(m){var n={"id":m.id(),"name":m.name(),"type":m.type()};j[l].push(n)})})}return j};g.prototype.exportViz=function(o){if(this._chart){var r=this._chartProxy.execute('toJSON',o);return r}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};return g});define('sap/viz/controls/chart/ViewManager',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/InfoChartView','sap/viz/controls/chart/views/MapView','sap/viz/controls/chart/views/TableView'],function(C,a,b,I,M,T){var t={};var V={};V._register=function(c,v){if(c&&v){t[c]=v}};V._getViewClass=function(c){if(t.hasOwnProperty(c)){return t[c]}else if(a.isInfoChart(c)){return I}else{return b}};V.getViewClass=function(c){return V._getViewClass(c)};V._register(C.TYPE_GEO_MAP,M);V._register(C.TYPE_TABLE,T);V._register(C.TYPE_CROSSTAB,T);return V});define('sap/viz/controls/chart/VizProxyHandler',['sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/views/ChartEvent'],function(V,C){var a=function(c){this.__className="sap.viz.controls.chart.VizProxyHandler";this._chart=c;this._init()};a.prototype._init=function(){this._operationMap={};this._operationMap[V.GetTitleZoneOperation]=this._getTitleZone;this._operationMap[V.GetTitleTextOperation]=this._getTitleText;this._operationMap[V.SetTitleTextOperation]=this._setTitleText;this._operationMap[V.GetTitleTextByFeedingOperation]=this._getTitleTextByFeeding;this._operationMap[V.RestoreTitleTextOperation]=this._restoreTitleText;this._operationMap[V.SetTitleModeOperation]=this._setTitleMode;this._operationMap[V.IsFakeChartOperation]=this._isFakeChart;this._operationMap[V.IsTitleCustomizedOperation]=this._isTitleCustomized;this._operationMap[V.GetPropertiesOperation]=this._getProperties;this._operationMap[V.SetPropertiesOperation]=this._setProperties;this._operationMap[V.GetSelectionOperation]=this._getSelection;this._operationMap[V.SetDatasetOperation]=this._setDataset;this._operationMap[V.GetPropertyZonesOperation]=this._getPropertyZones;this._operationMap[V.SetPropertyZonesOperation]=this._setPropertyZones;this._operationMap[V.QueryPropertiesOperation]=this._queryProperties;this._operationMap[V.UpdatePropertiesOperation]=this._updateProperties;this._operationMap[V.GetDatasetOperation]=this._getDataset;this._operationMap[V.AddEventListenerOperation]=this._addEventListener;this._operationMap[V.RemoveEventListenerOperation]=this._removeEventListener;this._operationMap[V.SetAxisScaleOperation]=this._setAxisScaleListener;this._operationMap[V.GetDataPointsPosition]=this._getDataPointsPosition;this._operationMap[V.GetTypeOperation]=this._getType;this._operationMap[V.OnOperation]=this._on;this._operationMap[V.OffOperation]=this._off;this._operationMap[V.GetSizeOperation]=this._getSize;this._operationMap[V.SetSizeOperation]=this._setSize;this._operationMap[V.GetVizFeedingOperation]=this._getVizFeeding};a.prototype.response=function(d){var o=d.operation;var b=d.args;d.result=this._operationMap[o].apply(this,b)};a.prototype._getTitleZone=function(){return this._chart.getTitleZone()};a.prototype._getTitleText=function(){return this._chart.titleWithInteracionEvent()};a.prototype._setTitleText=function(t){this._chart.titleWithInteracionEvent(t)};a.prototype._getTitleTextByFeeding=function(){return this._chart.getTitleTextByFeeding()};a.prototype._restoreTitleText=function(){this._chart.restoreTitleText()};a.prototype._setTitleMode=function(m){this._chart.vizTitleMode(m)};a.prototype._isFakeChart=function(){return this._chart.isFake()};a.prototype._isTitleCustomized=function(){return this._chart.isTitleCustomized()};a.prototype._getProperties=function(){return this._chart.propertiesWithEvents()};a.prototype._setProperties=function(n,t){this._chart.propertiesWithEvents(n,[C.USER_INTERACTION_COMPLETE,C.VIZ_PROPERTIES_CHANGED,],t)};a.prototype._setDataset=function(o){this._chart.vizUpdate({data:o})};a.prototype._getSelection=function(){return this._chart.vizSelection()};a.prototype._getType=function(){return this._chart.vizType()};a.prototype._getPropertyZones=function(){return this._chart.getPropertyZones()};a.prototype._setPropertyZones=function(v){this._chart.setPropertyZones(v)};a.prototype._queryProperties=function(o){return this._chart.queryProperties(o)};a.prototype._updateProperties=function(o,t){this._chart.updateProperties(o,t)};a.prototype._getDataset=function(){return this._chart.vizData()};a.prototype._addEventListener=function(t,l,s,p){this._chart.addEventListener(t,l,s,p)};a.prototype._removeEventListener=function(t,l,s){this._chart.removeEventListener(t,l,s)};a.prototype._setAxisScaleListener=function(z){return this._chart.setAxisScale.apply(this._chart,arguments)};a.prototype._getDataPointsPosition=function(d){return this._chart.getDataPointsPosition.apply(this._chart,arguments)};a.prototype._on=function(e,c){return this._chart.vizOn.apply(this._chart,arguments)};a.prototype._off=function(e){return this._chart.vizOff.apply(this._chart,arguments)};a.prototype._getSize=function(){return this._chart.size()};a.prototype._setSize=function(s){if(s){this._chart.size(s);this._chart._dom$.parent().width(s.width);this._chart._dom$.parent().height(s.height)}};a.prototype._getVizFeeding=function(){return this._chart.getFeeding()};return a});define('sap/viz/controls/chart/Chart',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/ChartPreHandler','sap/viz/controls/chart/ChartProxy','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View','sap/viz/controls/chart/views/InfoChartView','sap/viz/controls/chart/ViewManager','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/common/services/BVRService','sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/VizProxyHandler'],function($,V,G,C,D,E,a,F,A,b,c,d,f,O,u,g,L,j,k,l,I,m,n,o,q,r,R,B,s,t){var v=function v(e,h){v.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.Chart";this._div=e;this._uiConfig=h?h:j.instance();this._uiConfig.libFolderPath=G.defaultAssetsRoot()+'/common/libs';this._layout=null;this._chartViewInstance=null;this._type=null;this._data=null;this._properties=null;this._categoryAxis=[];this._valueAxis=[];this._labelFormats=null;this._css=null;this._description=null;this._vizCreated=false;this._enableVizDefChangedEvent=true;this._enableUserInteractionComplete=true;this._loadingModel=false;this._loadingInstance=false;this._titleMode=v.VIZ_TITLE_MODE.auto;this._titleGeneratorFunc=null;this._enableTrellis=(this._uiConfig.enableTrellis!==false);this._enableMorphing=(this._uiConfig.enableMorphing!==false);R.getRuntime().registerModel(this._uid,this._vizModel());this._vizProxyHandler=new t(this);this._vizModel().addEventListener(s.VizProxyEvent,function(i){this._vizProxyHandler.response(i.data)},this);this._chartPreHandler=new k({"useInfoChart":this._uiConfig.useInfoChart});this._chartProxy=new l(this);this._createChildren();this._onEventMap={}};O.extend(v,V);v.VIZ_TITLE_MODE={manual:"manual",auto:"auto"};v.prototype.vizType=function(e){if(arguments.length>0){if(!u.isString(e)){return}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizType()_set');this._beginUpdateProperty();this._vizType=e;this._vizModel().type(this._vizType);this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizType()_set');return this}else{return this._vizModel().type()}};v.prototype.vizTitle=function(e){if(arguments.length>0){this._setTitle(e);return this}else{return this._getTitle()}};v.prototype.titleWithInteracionEvent=function(e){if(arguments.length>0){this._setTitle(e);this._dispatchInteractionCompleteEvent();return this}else{return this._getTitle()}};v.prototype._setTitle=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_title()_set');if(g.hasFakeData(this._data)){e=' '}var h=this.vizProperties()?this.vizProperties().title:null;if(!h||e!==h.text){if(!h){h={}}h.text=e;this._setProperties({'title':h})}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_title()_set')};v.prototype._getTitle=function(e){var e=this._getProperties()?this._getProperties().title:null;return e?e.text:null};v.prototype.clearSelectedPropertyZone=function(){this._chartViewInstance.selectedPropertyZone(null)};v.prototype.isFake=function(){return g.hasFakeData(this._data)};v.prototype.setTitleGeneratorFunc=function(e){if(e!==null&&e!==undefined&&!u.isFunction(e)){return}this._titleGeneratorFunc=e};v.prototype.vizTitleMode=function(e){if(arguments.length>0){if(e==v.VIZ_TITLE_MODE.auto||e==v.VIZ_TITLE_MODE.manual){this._titleMode=e}}else{return this._titleMode}};v.prototype.isTitleCustomized=function(){return this._titleMode===v.VIZ_TITLE_MODE.manual};v.prototype.getTitleZone=function(){if(this._chartView().getTitleZone){return this._chartView().getTitleZone()}else{return[]}};v.prototype.getTitleTextByFeeding=function(){if(this._titleGeneratorFunc){var e=[this.vizUid()];return this._titleGeneratorFunc.apply(null,e)}return this._chartView().getTitleByFeeding()};v.prototype.restoreTitleText=function(){this.titleWithInteracionEvent(this.getTitleTextByFeeding())};v.prototype._titleChangedHandler=function(e){var h=e.data.text;this.titleWithInteracionEvent(h)};v.prototype.destroy=function(){this._destroyViz();v.superclass.destroy.apply(this,arguments)};v.prototype.feedAnalysisObjects=function(e,h){this._beginUpdateProperty();var i=this._vizModel();var p;if(h===true){p=B.suggestFeeds(i.type(),i.explicitFeedingItems(),e)}else{p=B.suggestFeeds(i.type(),e)}var w=i.explicitFeedingItems();if(p){if(d.equal(w,p.feeds)){for(var z in e){var H=d.getVizFeeds(i.type());for(var J in H){if(d.canAddFeed(w,H[J],e[z])){y(this._vizModel().type(),w,e[z])}}}}else{w=p.feeds}i.feedingItems(w)}this._endUpdateProperty();return w};v.prototype.getDefaultIncompleteOptions=function(e){if(!u.isString(e)){return}var p=v._getDefaultProperties(e,this._uiConfig);return{'type':e,'properties':p,'data':I.getDataset(e)}};v.getDefaultIncompleteOptions=function(e){if(!u.isString(e)){return}var p=v._getDefaultProperties(e,j.instance());return{'type':e,'properties':p,'data':I.getDataset(e)}};v.prototype._updateColumnDimCount=function(){if(f.isMultipleChart(this._vizModel().type())){var e=d.getNumberOfDimensionsInColumn(this._vizModel().feedingItems());this._properties=this._properties||{};this._properties.multiLayout=this._properties.multiLayout||{};this._properties.multiLayout.numberOfDimensionsInColumn=e}};v.prototype._dispatchVizDefChangedEvent=function(e){var h={vizTypeChanged:(e.vizTypeChanged===true),vizPropertiesChanged:(e.vizPropertiesChanged===true),vizCssChanged:(e.vizCssChanged===true),feedingItemsChanged:(e.feedingItemsChanged===true),filterChanged:(e.filterChanged===true),vizTitleChanged:(e.vizTitleChanged===true)};if(this._vizDefChangedData){for(var p in this._vizDefChangedData){if(this._vizDefChangedData.hasOwnProperty(p)){h[p]=h[p]||this._vizDefChangedData[p]}}this._vizDefChangedData=null}if(this._enableVizDefChangedEvent){this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h))}else{this._vizDefChangedData=h}};v.prototype._dispatchInteractionCompleteEvent=function(){if(this._enableUserInteractionComplete){this._dispatchEvent(new a(n.USER_INTERACTION_COMPLETE,this));sap.viz.base.utils.log.Analyzer.pnrProfiling('vizFrame has dispatch the userInteraction Event')}};v.prototype._updateView=function(e){var h=r.getViewClass(e);if(this._chartViewInstance instanceof h){return}if(this._chartViewInstance){this._chartViewInstance.destroy();this._chartViewInstance=null;this._data=null}this._createChartView(h);this._chartView().onEventMap(this._onEventMap);var i={width:$(this._div).width(),height:$(this._div).height()};this._chartView().size(i);if(f.isTable(e)){this._data=I.getDataset(e)}var p={type:e};this._dispatchEvent(new n(n.VIZ_VIEW_CHANGED,this,p))};v.prototype._onVizModelChanged=function(e){if(!this._inUpdatingProperty()&&(e.data.feedingItemsChanged||e.data.vizTypeChanged||e.data.isMNDVisibleChanged||e.data.sliceDimensionChanged)){this._dispatchInteractionCompleteEvent()}this._dispatchVizDefChangedEvent(e.data);var h=this._vizModel().type();if(e.data.vizTypeChanged){this._updateView(h)}if(this._loadingModel){return}if(e.data.vizTypeChanged){if(!this._inUpdatingProperty()){this._properties=this._chartView().resetProperties(this._properties,h)}this._updateAxisProperties(h);this._updateLabelFormats(h);this._dispatchPropertyEvent(new n(n.VIZTYPE_CHANGED,this,{type:h}))}if(!this._chartView()){return}if(e.data.feedingItemsChanged&&!f.isGeo(h)){this._updateColumnDimCount();if(!this._inUpdatingProperty()){this._updateTitle();this.showLoadingIcon();var i=f.getDatasetType(h);this._dispatchPropertyEvent(new F(F.FEEDS_CHANGED,this,{datasetType:i,feeds:this.feeds()}));return}}this._chartView().modelChanged(this._vizModel(),e.data);if(e.data.extensionValuesChanged){var p=this._vizModel().extensionValues();if(p.feedingPanel&&this._enableTrellis!==p.feedingPanel.enableTrellis){this._enableTrellis=p.feedingPanel.enableTrellis;this._chartView().enableTrellis(this._enableTrellis)}}if(this._needCreateViz(h,false)&&(e.data.vizTypeChanged||e.data.feedingItemsChanged)){this._createVizInstance()}};function x(p,e,h){if(e&&h){var i,w,z;for(i=0;i<e.length;i++){w=e[i];if(h.length>i){z=h[i];p[w]=u.clone(h[i])}}}};v.prototype._updateAxisProperties=function(e){if(this._properties){var h=g.getCategoryAxis(e);x(this._properties,h,this._categoryAxis);var i=g.getValueAxis(e);x(this._properties,i,this._valueAxis)}};v.prototype._updateLabelFormats=function(e){var h=['xAxis','xAxis2','yAxis','yAxis2','valueAxis'];var p={'xAxis':'yAxis','xAxis2':'yAxis2','yAxis':'xAxis','yAxis2':'xAxis2'};var i,w;if(!this._labelFormats&&this._properties){for(i=0;i<h.length;i++){w=h[i];var z;if(w==='valueAxis'){z=this._properties.plotArea?this._properties.plotArea.valueAxis:null}else{z=this._properties[w]}var H=(z&&z.label&&z.label.hasOwnProperty('formatString'))?true:false;if(H){this._labelFormats=this._labelFormats||{};this._labelFormats[w]=z.label.formatString}}}var J=sap.viz.api.manifest.Viz.get(e)[0].allProperties();if(!J){return}var K;for(i=0;i<h.length;i++){w=h[i];var M;if(w==='valueAxis'){if(J.plotArea&&J.plotArea.valueAxis){M=J.plotArea.valueAxis.supportedValues}}else{M=J[w]}var N=(M&&M.label&&M.label.supportedValues&&M.label.supportedValues.hasOwnProperty('formatString'))?true:false;if(N){var P;if(this._properties){var Q;if(w==='valueAxis'){if(this._properties.plotArea&&this._properties.plotArea.valueAxis){Q=this._properties.plotArea.valueAxis;if(Q&&Q.label&&Q.label.hasOwnProperty('formatString')){P=Q.label.formatString}}}else{Q=u.clone(this._properties[w]);if(Q&&Q.label&&Q.label.hasOwnProperty('formatString')){P=Q.label.formatString}}}if(P===undefined&&this._labelFormats){P=this._labelFormats[w];if(P===undefined&&w!=='valueAxis'){var S=p[w];if(S){P=this._labelFormats[S]}}}if(P===undefined){P=this._uiConfig.defaultLabelFormatString}if(P!==undefined){this._properties=this._properties||{};if(w==='valueAxis'){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.valueAxis=this._properties.plotArea.valueAxis||{};this._properties.plotArea.valueAxis.label={formatString:P}}else{this._properties[w]=this._properties[w]||{};this._properties[w].label={formatString:P}}}}else{K=K||[];K.push(w)}}if(K&&this._properties){for(i=0;i<K.length;i++){w=K[i];if(w==='valueAxis'){if(this._properties.plotArea&&this._properties.plotArea.valueAxis&&this._properties.plotArea.valueAxis.label){delete this._properties.plotArea.valueAxis.label.formatString}}else{if(this._properties[w]&&this._properties[w].label){delete this._properties[w].label.formatString}}}}};v.prototype._createChartView=function(h){var i=this._chartViewInstance=new h($(this._div),{'type':this._vizModel().type(),'useBuiltInPropertyZoneInteraction':this._uiConfig.useBuiltInPropertyZoneInteraction,'useDefaultChartSizeForTrellis':this._uiConfig.useDefaultChartSizeForTrellis},this._uiConfig.libFolderPath,$.proxy(this._vizModel,this),this._chartProxy,{'vizProperties':$.proxy(this.vizProperties,this),'vizCss':$.proxy(this.vizCss,this),'vizCssProperty':$.proxy(this.vizCssProperty,this),'vizOn':$.proxy(this.vizOn,this),'vizType':$.proxy(this.vizType,this),'selectedPropertyZone':$.proxy(this.selectedPropertyZone,this),'vizData':$.proxy(this.vizData,this),'propertiesWithEvents':(function(e){this.propertiesWithEvents(e,[n.USER_INTERACTION_COMPLETE])}).bind(this)});i.enableTrellis(this._enableTrellis);i.enableMorphing(this._enableMorphing);i.addEventListener(n.TITLE_CHANGED,this._titleChangedHandler,this);i.addEventListener(n.ANALYSIS_DROPPED,this._analysisDroppedHandler,this);i.addEventListener(n.CHART_CHANGED,function(e){this._dispatchEvent(e)},this);i.addEventListener(n.CHART_CHANGING,function(e){this._dispatchEvent(e)},this);i.addEventListener(n.CHANGED_SELECTED_DATA,function(e){this._dispatchEvent(new n(n.CHANGED_SELECTED_DATA,this,e.data))},this);i.addEventListener(n.SELECT_PROPERTY_ZONE,function(e){this._dispatchEvent(new n(n.SELECT_PROPERTY_ZONE,this,e.data))},this);i.addEventListener(o.DISPATCH_PROPERTY_EVENT,function(e){var p=e.data;this._dispatchPropertyEvent(p)},this);i.addEventListener(n.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new n(n.PROPERTY_ZONES_CHANGED,this,e.data))},this);i.addEventListener(n.CONTEXT_MENU_TRIGGERED,function(e){this._dispatchEvent(new n(n.CONTEXT_MENU_TRIGGERED,this,e.data))},this)};v.prototype._createChildren=function(){this._validateSize();this._createChartView(m)};v.prototype._analysisDroppedHandler=function(e){var i;var h=this._vizModel();var p=h.explicitFeedingItems();var w;var z=e.data.zone;var H=e.data.analysisObject;if(z.feedDef.length===1){var J=z.feedDef[0];var K=J.id;if(z.name===d.RowsFeedingName||z.name===d.ColumnsFeedingName){K=z.name}w=d.getFeed(p,K);if(!w){w=new b(K,J.type,[]);p.push(w)}var M=J.type===c.MEASURE?J.max:J.maxStackedDims;if(M===null||M===undefined){M=Number.MAX_VALUE}if(w.values().length===M){w.values().splice(0,1)}w.values().push(H)}else{var N=[];for(i=0;i<z.feedDef.length;i++){if(z.feedDef[i].id===d.MultiplierFeedingName){N.push(d.RowsFeedingName);N.push(d.ColumnsFeedingName)}else{N.push(z.feedDef[i].id)}}var P=B.suggestFeeds(h.type(),p,[H],N);if(P){if(d.equal(p,P.feeds)){y(this._vizModel().type(),p,H)}else{p=P.feeds}}}h.feedingItems(p,this._enableTrellis)};function y(e,h,p){var w=B.suggestFeeds(e,[p]);var z,i,H;for(i=0;i<w.feeds.length;i++){H=w.feeds[i];if(H.values().length===1){z=H.id();break}}for(i=0;i<h.length;i++){H=h[i];if(H.id()===z){var J=false;var K=H.values();for(var M in K){if(K[M].id()===p.id()){J=true;break}}if(!J&&H.values().length>0){H.values().splice(0,1);H.values().push(p)}}}};v.prototype._validateSize=function(){var w=$(this._div).width();var h=$(this._div).height();$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chartView()){this._chartView().size({width:w,height:h})}};v.prototype._updateData=function(e,h){this._data=this._chartViewInstance.copyData(e,h)};v.prototype._chartView=function(){return this._chartViewInstance};v.prototype._needCreateViz=function(e,h){if(h===true){return true}var i=false;if(f.isTable(e)){i=true}else{if(e!==this._type){i=true}}if(!this._chartView().hasChartInstance()){i=true}return i};v.prototype._needChangeTemplate=function(e,h){var i=this._chartViewInstance.getTemplateId();var p=this._chartViewInstance.getTemplateId(h);return(i!==p)};v.prototype.showLoadingIcon=function(){this._chartView().showLoadingIcon()};v.prototype.connect=function(e){};v.prototype.disconnect=function(){};v.prototype.chartModel=function(){return this._vizModel()};v.prototype.vizUid=function(){return this._uid};v.prototype.vizData=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizData_set');var h=this._vizModel().type();this._updateData(h,e);if(this._vizCreated){var i=this._needChangeTemplate(h,e);if(i||f.isTable(h)){this._createVizInstance()}else{this._chartView().data(this._data)}}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizData_set');return this}else{if(this._chartView()){return this._chartView().data()}return null}};v.prototype.vizCss=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizCss_set');this._css=e;if(this._vizCreated){this._chartView().css(this._css);this._css=this._chartView().css()}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}this._dispatchVizDefChangedEvent({'vizCssChanged':true});sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizCss_set');return this}else{return this._chartView().css()}};v.prototype.vizProperties=function(p){if(arguments.length>0){this._setProperties(p);return this}else{return this._getProperties()}};v.prototype.propertiesWithEvents=function(p,e,h){if(arguments.length>0){var i=this;this._setProperties(p);e.forEach(function(w){if(w===n.USER_INTERACTION_COMPLETE){i._dispatchInteractionCompleteEvent()}else{i._dispatchEvent(new a(w,this,{properties:p,trigger:h}))}});return this}else{return this._getProperties()}};v.prototype._getProperties=function(p){return this._chartView().properties()};v.prototype._setProperties=function(p){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_properties_set');this._enableVizDefChangedEvent=false;var e=this._vizModel().type();var h=this._initOptions({properties:p});this._labelFormats=null;if(h!==e){this._vizModel().type(h);if(this._vizCreated){this._createVizInstance()}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_properties_set');throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{if(this._vizCreated){if(this._chartView().hasChartInstance()){var p=this._chartView().getValidProperties(this._properties,h);this._chartView().properties(p)}}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_properties_set');throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}var i={vizPropertiesChanged:true};if(p.hasOwnProperty("title")){i.vizTitleChanged=true}this._enableVizDefChangedEvent=true;this._dispatchVizDefChangedEvent(i);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_properties_set')};v.prototype.vizDescription=function(){return this._chartView().description()};v.prototype.vizUpdate=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');if(!e){return}e=this._chartPreHandler.preVizUpdate(e);this._beginUpdateProperty();var h=false;var i=e.type||this._vizModel().type();if(e.hasOwnProperty("type")){this._updateView(e.type)}if(e.hasOwnProperty('data')){h=this._needChangeTemplate(i,e.data)}i=this._initOptions(e);var p=(i!==this._vizModel().type());if(!f.isGeo(i)&&e.data===null){h=true;this._updateData(i,I.getDataset(i))}var w=null;var z=e.feeds;if(z){w=z.value?z.value:z}else if(z===null){w=[]}var H;if(p){H={'type':i};if(w){H['feedingItems']=w}this._vizModel().vizModelChanged(H)}else{if(w){H={'feedingItems':w};this._vizModel().vizModelChanged(H)}if(this._vizCreated){try{if(this._needCreateViz(i,h)||!this._chartView().supportUpdate(i)){this._createVizInstance()}else{this._updateVizInstance()}}catch(J){this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');throw J}}else{}}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');return this};v.prototype.vizOn=function(e,h){if(arguments.length>0){if(!u.isString(e)||!u.isFunction(h)){return}this._chartView().on(e,h);this._onEventMap[e]=h;return this}};v.prototype.vizOff=function(e){if(arguments.length>0){if(!u.isString(e)){return}this._chartView().off(e);delete this._onEventMap[e];return this}};v.prototype.vizAction=function(e,h){if(arguments.length>0){if(this._vizCreated){return this._chartView().action(e,h)}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}return this}};v.prototype.vizSelection=function(p,e){if(this._vizCreated){var h=this._chartView().selection.apply(this._chartView(),arguments);return h}else{throw L.get('VIZ_CHART_SELECTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};v.prototype.vizFeedingZone=function(){if(this._vizCreated){try{return this._chartView().feedingZone()}catch(e){return[]}}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};v.prototype.changeTemplate=function(){return this._chartView().changeTemplate.apply(this._chartView())};v.prototype._initOptions=function(e){if(!e){return}var h=e.type||this._vizModel().type();if(e.hasOwnProperty('css')){this._css=e.css}if(e.properties){var p=u.clone(e.properties);h=f.updateType(h,p);this._updateAxisCache(h,p);this._properties=this._properties||{};if(p.title&&p.title.text){p.title.text=p.title.text.trim()}this._properties=u.updateJSON(this._properties,p)}if(e.data){this._updateView(h);this._updateData(h,e.data)}return h};v.prototype._updateAxis=function(p,e,h){var i,w,z,H;if(p){for(i=0;i<p.length;i++){w=p[i];if(h.hasOwnProperty(w)){H=u.clone(h[w]);if(e.length>i){z=e[i];e[i]=u.updateJSON(z,H)}else{if(this._properties.hasOwnProperty(w)){e.push(u.updateJSON(this._properties[w],H))}else{e.push(H)}}}}}};v.prototype._updateAxisCache=function(e,h){if(h){var i=g.getCategoryAxis(e);this._updateAxis(i,this._categoryAxis,h);var p=g.getValueAxis(e);this._updateAxis(p,this._valueAxis,h)}};v.prototype._clearAxisCache=function(){if(this._categoryAxis){this._categoryAxis.length=0}if(this._valueAxis){this._valueAxis.length=0}};v.prototype._saveAxisCache=function(){var e={};e['categoryAxis']=this._categoryAxis;e['valueAxis']=this._valueAxis;return e};v.prototype._loadAxisCache=function(e){if(e['categoryAxis']){this._categoryAxis=e['categoryAxis']}if(e['valueAxis']){this._valueAxis=e['valueAxis']}};v.prototype.createViz=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_createViz');e=this._chartPreHandler.preCreateViz(e);this._beginUpdateProperty();this._type=null;this._vizModel().type(null);this._data=null;this._css=null;this._categoryAxis=[];this._valueAxis=[];this._properties={};this._vizModel().reset();if(e.hasOwnProperty("type")){this._updateView(e.type)}var h=this._initOptions(e);var i=null;var p=e.feeds;if(p){i=p.value?p.value:p}else if(p===null){i=[]}this._vizCreated=true;try{this._vizModel().vizModelChanged({'type':h,'feedingItems':i})}finally{this._endUpdateProperty()}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_createViz')}};v.prototype._destroyViz=function(){this._data=null;this._vizModel().type(null);this._properties=null;this._css=null;this._onEventMap={};this._chartView().destroy();this._vizCreated=false};v.prototype.exportViz=function(e){return(this._chartView().hasChartInstance()||this._chartView().exportable())?this._updateExportJSON(this._chartView().exportViz(e)):null};v.prototype.loadViz=function(e){if(arguments.length===1){e=sap.viz.api.serialization.migrate(e);var h=e.type;if(e.data&&e.data.type){if(e.data.type==='Crosstable'){var i=new sap.viz.api.data.CrosstableDataset();i.data(e.data.val);if(e.data.val.infos){i.info([{'type':'additionalData','info':e.data.val.infos}])}e.data=i}else if(e.data.type==='FlatTable'){e.data=new sap.viz.api.data.FlatTableDataset(e.data.val)}else{e.data=e.data.val}}if(h!==this._vizModel().type()){this._loadingModel=true;this._vizModel().vizModelChanged({'type':h});this._loadingModel=false}this._properties={};e.properties=e.properties||{};this._applyLeanLayout(e);this._initOptions(e);var p=v._getDefaultProperties(h,this._uiConfig);e.properties=u.updateJSON(p,e.properties);e.properties=this._chartView().getValidProperties(e.properties,h);this._clearAxisCache();this._type=h;this._vizCreated=true;this._updateFeeding(e,h);this._chartViewInstance.loadViz(e)}};v.prototype._applyLeanLayout=function(e){if(this._chartViewInstance instanceof q&&this._uiConfig.forceLeanLayout===true){this._properties.title=this._properties.title||{};this._properties.title.visible=false;this._properties.legend=this._properties.legend||{};this._properties.legend.visible=false;this._properties.categoryAxis=this._properties.categoryAxis||{};this._properties.categoryAxis.title=this._properties.categoryAxis.title||{};this._properties.categoryAxis.title.visible=false;this._properties.categoryAxis2=this._properties.categoryAxis2||{};this._properties.categoryAxis2.title=this._properties.categoryAxis2.title||{};this._properties.categoryAxis2.title.visible=false;this._properties.valueAxis=this._properties.valueAxis||{};this._properties.valueAxis.title=this._properties.valueAxis.title||{};this._properties.valueAxis.title.visible=false;this._properties.valueAxis2=this._properties.valueAxis2||{};this._properties.valueAxis2.title=this._properties.valueAxis2.title||{};this._properties.valueAxis2.title.visible=false;e.properties=e.properties||{};e.properties=u.updateJSON(e.properties,this._properties)}};v.prototype._updateVizInstance=function(){var e=this._vizModel().type();var h=this.feeds({'withMND':true});var p=this._chartView().getValidProperties(this._properties,e);var i={'properties':p,'css':this._css,'data':this._data};this._updateFeeding(i,e);this._data=i.data;this._chartView().update(i)};v.prototype._createVizInstance=function(e){if(!this._vizCreated){return}try{var h=this._vizModel().type();var i=v._getDefaultProperties(h,this._uiConfig);var p=u.updateJSON(i,this._properties);p=this._chartView().getValidProperties(p,h);var w={'type':h,'data':this._data,'css':this._css,'properties':p};this._updateFeeding(w,h);this._data=w.data;this._type=w.type;if(!f.isGeo(this._type)){this._chartView().hideLoadingIcon()}this._chartView().create(w)}catch(z){if(R.getRuntime()._modelRefs[this._uid]===1){throw z}}};v.prototype._updateFeeding=function(e,h){var i=this.feeds({'withMND':true});if(!f.isTable(h)){if(!f.isGeo(h)&&d.isEmptyFeeds(i)){if(g.getDatasetType(e.data)!==D.CROSS_TABLE||g.hasFakeData(e.data)){e.data=I.getDataset(h)}}else{e.feeding=this._chartViewInstance.buildFeedings(h,e.data,i)}}else{if(!e.data||g.hasFakeData(e.data)){e.data=I.getDataset(h)}e.feeding=this._chartViewInstance.buildFeedings(h,e.data,i)}};v.prototype.save=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_save');var h={};h["vizInstance"]=this.exportViz(e);var i=this.feeds();var p=this._chartViewInstance.FeedsToJSON(i);h["feedingItems"]=p;h["type"]=this._vizModel().type();h["vizTitleMode"]=this._titleMode;h["vizView"]=this._chartViewInstance.save();h["axis"]=this._saveAxisCache();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_save');return h};v.prototype.load=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_load');e=this._chartPreHandler.preLoadChart(e);this._beginUpdateProperty();var h=e["vizTitleMode"];if(h){this.vizTitleMode(h)}this._loadingModel=true;var i=e["type"];this._updateView(i);var p=null;var w=e['feedingItems'];if(w){p=this._chartViewInstance.FeedsFromJSON(w)}this._vizModel().load({"type":i,"feedingItems":p});this._loadingModel=false;var z=e["vizInstance"];if(z){this._loadingInstance=true;if(e["vizView"]){this._chartViewInstance.load(e["vizView"],z.properties)}this.loadViz(z);this._loadingInstance=false}var H=e["axis"];if(H){this._loadAxisCache(H)}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_load')};v.prototype.feeds=function(e){if(arguments.length>0&&u.isArray(e)){if(e!==null&&e!==undefined&&!g.isArrayOfFeedItem(e)){return}this._beginUpdateProperty();var h=e.slice(0);this._vizModel().feedingItems(h,this._enableTrellis);try{var i=this._vizModel().type();if(this._needCreateViz(i,false)){this._createVizInstance()}else{this._updateVizInstance()}}catch(p){this._endUpdateProperty();throw p}this._endUpdateProperty();return this}else{return this._vizModel().explicitFeedingItems(e)}};v.prototype.enableMorphing=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enableMorphing(!!e)}}else{if(this._chartView()){return this._chartView().enableMorphing()}}return this};v.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enablePropertyZone(!!e)}}else{if(this._chartView()){return this._chartView().enablePropertyZone()}}return this};v.prototype._updateTitle=function(){if(this.isTitleCustomized()){return}var e=this.getTitleTextByFeeding();this._properties.title=this._properties.title||{};e=e.trim();if(this._properties.title.text!=e){this._properties.title.text=e}};v.prototype.feeding=function(){if(this._chartViewInstance){return this._chartViewInstance.feeding()}else{return[]}};v.prototype.showMessage=function(e){if(arguments.length==1){if(this._chartView()){return this._chartView().updateDescription(e)}}};v.prototype.exportToSVGString=function(e){return this._chartView().exportToSVGString(e)};v.prototype.supportExportToSVG=function(){return this._chartView().supportExportToSVG()};v.prototype._updateExportJSON=function(J){if(J&&J.properties&&J.properties.tooltip&&J.properties.tooltip.preRender){J.properties=u.clone(J.properties);delete J.properties.tooltip.preRender}return J};v.prototype.getPropertyZones=function(){return this._chartView().getPropertyZones()};v.prototype.setPropertyZones=function(p){this._chartView().setPropertyZones(p)};v.prototype.queryProperties=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_queryProperties');var h=this._chartView().queryProperties(e);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_queryProperties');return h};v.prototype.updateProperties=function(e,h){this._chartView().updateProperties(e);this._dispatchEvent(new a(n.VIZ_PROPERTIES_CHANGED,this,{properties:e.properties,trigger:h}))};v.prototype.selectedPropertyZone=function(e){var h=this._chartView();return h.selectedPropertyZone.apply(h,arguments)};v.prototype.getZoneName=function(p){return this._chartView().getZoneName.apply(this._chartView(),arguments)};v.prototype.getDataPointsPosition=function(e){return this._chartView().getDataPointsPosition.apply(this._chartView(),arguments)};v.prototype.setAxisScale=function(e){return this._chartView().setAxisScale.apply(this._chartView(),arguments)};v.prototype.vizCssProperty=function(e,p,h){return this._chartView().cssProperty.apply(this._chartView(),arguments)};v.prototype.getFeeding=function(){return this._chartView().feeding()};v._getDefaultProperties=function(e,h){if(!e){return{}}var p;var i=f.getChartId(e);if(h&&h.hasOwnProperty('specificProperties')){p=u.updateJSON(h.defaultProperties,h.specificProperties[i])}else{p=h?h.defaultProperties:null}p=g.convertProperties(p,f.getVizType(e),e);return p};v.prototype.pauseRender=function(){this._chartProxy.pauseRender()};v.prototype.resumeRender=function(){this._chartProxy.resumeRender()};return v});define('sap/viz/controls/plugins/infochart/getPropertiesByCtx',['sap/viz/controls/common/utils/Utils'],function(U){function e(c,a){var k=Object.keys(c),b=Object.keys(a);return(k.length>0)&&k.every(function(d){return c[d]===a[d]})}function m(c,d){if(!c){return false}if(!Array.isArray(c)){c=[c]}return c.some(function(a){if(!a){return true}return e(a,d)})}function f(c,a){var r;for(var k in c){if(!r){r={}}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break}}if(!b){continue}r[k]=c[k]}return r};return function(c,a){var b=c.ctx;if(!Array.isArray(a)){a=[a]}var d;for(var i=0,l=a.length;i<l;i++){var g=a[i],h=g.ctx,p=g.paras;if(!h){d=p}}var p=this._parameters,k,n=-1,o,q;for(var i=0,l=a.length;i<l;i++){var g=a[i],h=g.ctx,p=g.paras;if(m(h,b)){o=0;for(var j in h){o++}if(n<o){n=o;q=i}}}if(a[q]){return a[q].paras}return d}});define('sap/viz/controls/plugins/infochart/SVG',[],function(){var s='http://www.w3.org/2000/svg';var E="...";var t;function c(b,r,i){var d=r?r.ownerDocument:window.document;var n=b.toLowerCase()==="svg"?s:(r?r.namespaceURI:s);var e=d.createElementNS(n,b);return r?(i?r.parentNode.insertBefore(e,r):r.appendChild(e)):e}function g(b,d){if(!t){var e=c("svg",document.body);e.style.cssText="position:absolute;left:-1000px;top:-1000px;z-index:-9000;width:1px;height:1px";t=c("text",e)}t.style.cssText=a(d);t.textContent=b;return t}function a(b){var d="";if(Object.prototype.toString.call(b)==='[object String]'){d=b}else{for(var i in b){if(b.hasOwnProperty(i)){var v=b[i];if(v!==null&&v!==undefined&&v!==""){d+=i+":"+v+";"}}}}return d}return{create:c,measureText:function(b,d){if(!b){return{width:0,height:0,x:0,y:0}}return g(b,d).getBBox()},toCSSText:a,createTextNode:function(b,d,m,e,f){d=a(d);var h=e!==undefined,i=f!==undefined;var j;if(m||h||i){var k=g(b,d);var l=false;if(h){var n=k.getComputedTextLength();if(n>e){k.textContent=E;n=k.getComputedTextLength();e-=n;if(e<=0){return}k.textContent=b;var o=b.length-1;while(o>0&&(k.getSubStringLength(0,o)>e)){o--}if(o>0){j=b;b=b.substr(0,o)+E;l=true}else{return}}}if(m||i){if(l){k.textContent=b}if(m){m=k.getBBox()}if(i&&m.height>f){return}}}var r=c("text");r.setAttribute("style",d);r.textContent=b;if(j){var p=c("title",r);p.textContent=j}return m?{measure:m,node:r}:r}}});define('sap/viz/controls/plugins/infochart/Icon',["./SVG"],function(S){var _={};var I=function(c){var a=document.createElement("div");a.innerHTML=c;var b=a.childNodes;var s;for(var i in b){var l=b[i].localName;if(l&&l.toLowerCase()==="svg"){s=this._svgNode=b[i];break}}if(!_[c]){document.body.appendChild(a);_[c]=s.getBBox()}var d=_[c];this._width=d.width;this._height=d.height;this._x=d.x;this._y=d.y};var p=I.prototype;p.render=function(a,s,f){var g=S.create("g",a);var b=this._svgNode;var n=this._svgNode.firstChild;while(n){var c=n.nextSibling;g.appendChild(n);n=c}if(s){if(Array.isArray(s)){s=s.join(" ")}g.setAttribute("transform","scale("+s+")")}if(f){g.setAttribute("fill",f)}return g};p.clipPath=function(a){var s=this._svgNode;var n=this._svgNode.firstChild;while(n){var b=n.nextSibling;a.appendChild(n);n=b}};p.destroy=function(){var c=this._svgNode.parentNode;if(c&&c.parentNode){c.parentNode.removeChild(c)}delete this._svgNode};p.getWidth=function(){return this._width};p.getHeight=function(){return this._height};p.getX=function(){return this._x};p.getY=function(){return this._y};return I});define('sap/viz/controls/plugins/infochart/StackDecoratorGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var A=50;var _=0;function t(w,h,i,n){var a;if(n){a=[[w,0]];if(i){a.push([0,h/2],[w,h])}else{a.push([0,0],[w/2,h])}}else{a=[[0,h]];if(i){a.push([0,0],[w,h/2])}else{a.push([w/2,0],[w,h])}}return a}var p={"pike":function(w,h,i,n){var a=t(w,h,i,n);if(n){if(i){if(w>A){a.splice(1,0,[A,0]);a.splice(3,0,[A,h])}}else{if(h>A){a.splice(2,0,[0,h-A]);a.splice(4,0,[w,h-A])}}}else{if(i){if(w>A){a.splice(2,0,[w-A,0]);a.splice(4,0,[w-A,h])}}else{if(h>A){a.splice(1,0,[0,A]);a.splice(3,0,[w,A])}}}return a},"triangle":t,"trapezoid":function(w,h,i,n){var a;if(n){a=[[w,0]];if(i){if(w>A){a.push([A,0])}a.push([0,h])}else{a.push([0,0]);if(h>A){a.push([0,h-A])}}}else{a=[[0,h]];if(i){a.push([0,0]);if(w>A){a.push([w-A,0])}a.push([w,h])}else{if(h>A){a.push([0,A])}a.push([w,0])}}a.push([w,h]);return a}};return{name:"stackDecorator",fn:function(c){return function(a){var b=g(a,c);if(!b){return}var e=a.graphic,n,w=e.width,h=e.height;var s=b.stackShape||{};var f=s.value;var n=a.g;var i=S.create("clipPath",n);var j="clipPath_"+(_++);i.setAttribute("id",j);n.setAttribute("clip-path","url(#"+j+")");if(s.type==="svg"){var k=new I(f);var l=k.getWidth();var m=k.getHeight();var o=w/l;var q=h/m;k.clipPath(i);i.setAttribute("transform","translate( "+e.x+","+e.y+") scale("+o+" "+q+")");k.destroy()}else{if(!f||f==="rectangle"){var r=S.create("rect",i);r.setAttribute("width",w);r.setAttribute("height",h)}else{var u=S.create("path",i);var d="";p[f](w,h,a.horizontal,a.negative).forEach(function(v,x){d+=(x===0?"M":"L")+v[0]+" "+v[1]});d+="Z";u.setAttribute("d",d)}i.setAttribute("transform","translate( "+e.x+","+e.y+")")}}}}});define('sap/viz/controls/plugins/infochart/BarShapeRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var A=50;function t(w,h,i,n){var a;if(n){a=[[w,0]];if(i){a.push([0,h/2],[w,h])}else{a.push([0,0],[w/2,h])}}else{a=[[0,h]];if(i){a.push([0,0],[w,h/2])}else{a.push([w/2,0],[w,h])}}return a}var p={"pike":function(w,h,i,n){var a=t(w,h,i,n);if(n){if(i){if(w>A){a.splice(1,0,[A,0]);a.splice(3,0,[A,h])}}else{if(h>A){a.splice(2,0,[0,h-A]);a.splice(4,0,[w,h-A])}}}else{if(i){if(w>A){a.splice(2,0,[w-A,0]);a.splice(4,0,[w-A,h])}}else{if(h>A){a.splice(1,0,[0,A]);a.splice(3,0,[w,A])}}}return a},"triangle":t,"trapezoid":function(w,h,i,n){var a;if(n){a=[[w,0]];if(i){if(w>A){a.push([A,0])}a.push([0,h])}else{a.push([0,0]);if(h>A){a.push([0,h-A])}}}else{a=[[0,h]];if(i){a.push([0,0]);if(w>A){a.push([w-A,0])}a.push([w,h])}else{if(h>A){a.push([0,A])}a.push([w,0])}}a.push([w,h]);return a}};return{name:"barShapeRenderer",fn:function(c){return function(a){var b=g(a,c);if(b){var e=a.graphic,n,w=e.width,h=e.height,f=b.dataPointShapeFill,i=f||e.fill,j=b.dataPointShape||{},k=j.type,l=j.value;if(k==="svg"){var m=new I(l);n=S.create("g");var o=m.getWidth();var q=m.getHeight();var r=w/o;var s=h/q;m.render(n,[r,s],i);if(f){a.data.color=f}n.setAttribute("transform","translate("+(w/2-o*r/2-m.getX()*r)+","+(h/2-q*s/2-m.getY()*s)+")");m.destroy()}else{if(!l||l==="rectangle"){n=S.create("rect");n.setAttribute("width",w);n.setAttribute("height",h)}else{n=S.create("path");var d="";p[l](w,h,a.horizontal,a.negative).forEach(function(u,v){d+=(v===0?"M":"L")+u[0]+" "+u[1]});d+="Z";n.setAttribute("d",d)}if(f){a.data.color=f}n.setAttribute("fill",i)}return n}}}}});define('sap/viz/controls/plugins/infochart/CategoryAxisLabelRendererGenerator',['./getPropertiesByCtx','./SVG','./Icon'],function(g,S,I){var P=5;var a=3;var D=0.5;return{name:"categoryAxisLabelRenderer",fn:function(c){var b=function(d){var p=g(d,c);if(p){var e=d.position;var i=e==="left";var f=d.size.width;var h=d.size.height;var r=f,j=h;if(i){r-=P}else{j-=P}if(r<=0||j<=0){return null}var k=S.create("g");var t,l;var m=0;if(p.iconVisible===true&&p.iconSVG){var n=p.iconSize;if(n===undefined){n=D}if(n>0){var o=new I(p.iconSVG);var q=o.getWidth();var s=o.getHeight();var u,v;if(i){u=v=Math.min(h*n,r)}else{u=v=Math.min(f*n,j)}var w=Math.min(u/q,v/s);var x=S.create("g",k);o.render(x,w,p.iconColor);o.destroy();var y=o.getX()*w;var z=o.getY()*w;if(i){t=r-u-y;l=j/2-v/2-z;r-=u+a}else{t=r/2-u/2-y;l=P-z;j-=v+a;m=v+a}x.setAttribute("transform","translate("+t+" "+l+")")}}if(r>0&&j>0){if(p.textVisible!==false){var A=!i&&d.rotated===true;var B,C;if(A){B=i?undefined:j;C=r}else{B=r;C=i?undefined:j}var E=d.styles;var F=S.createTextNode(d.text,{"font-family":p.fontFamily||E["font-family"],"font-size":p.fontSize||E["font-size"],"font-weight":p.fontWeight||E["font-weight"],"font-style":p.fontStyle||E["font-style"],"fill":p.fontColor||E["fill"]},true,B,C);if(F){var G=F.measure;if(A){var H=p.fontSize||E['font-size'];var J=parseFloat(H)*1.2;var K=3;var L=6;t=r/2+J/2-K;l=L}else{if(i){t=r-G.width-G.x;l=j/2-G.height/2-G.y;if(d.childCells&&d.childCells.length){l-=d.childCells[0].cellHeight/2}}else{t=r/2-G.width/2-G.x;l=h-j-G.y}}var M=F.node;if(A){l+=m;M.setAttribute('x',t);M.setAttribute('y',l);M.setAttribute('text-anchor','end');M.setAttribute('transform','rotate(-90,'+t+','+l+')')}else{M.setAttribute("transform","translate("+t+" "+l+")")}k.appendChild(M)}}}return k}};b.getPreferredSize=function(d){var p=g(d,c);if(!p){return}var e=b._buildCssString(d.styles,p);var i=d.rotated;if(p.iconVisible===true){if(!p.iconSVG){return}}else{if(p.textVisible===false){return{cellWidth:0,cellHeight:0,}}else{var t=S.measureText(d.text,e);if(d.position==='left'){return{cellWidth:t.width+P,cellHeight:t.height}}else{if(t.width>d.size){i=true;return{cellWidth:t.height+P,cellHeight:t.width,rotated:true}}else{return{cellWidth:t.width,cellHeight:t.height+P}}}}}var f=P;var h=P;var r=p.iconSize;if(r===undefined){r=D}if(r<=0){return}if(d.position==="top"||d.position==="bottom"){f=d.size;h+=d.size*r;if(p.textVisible!==false){var t=S.measureText(d.text,e);if(t.width>d.size){i=true;h+=a+t.width}else{h+=a+t.height}}}else{h=d.size;f+=d.size*r;if(p.textVisible!==false){var t=S.measureText(d.text,e);f+=a+t.width}}return{cellWidth:f,cellHeight:h,rotated:i}};b._buildCssString=function(s,p){var d='';d+='fill:'+(p.fontColor||s['fill'])+';';d+='font-family:'+(p.fontFamily||s['font-family'])+';';d+='font-size:'+(p.fontSize||s['font-size'])+';';d+='font-style:'+(p.fontStyle||s['font-style'])+';';d+='font-weight:'+(p.fontWeight||s['font-weight'])+';';return d};b.autoHide=function(){return true};return b}}});define('sap/viz/controls/plugins/infochart/PieSliceRendererGenerator',["./getPropertiesByCtx","./SVG"],function(g,S){return{name:"pieSliceRenderer",fn:function(c){return function(a,d){var p=g(a,c);if(p&&p.sliceShapeFill){a.graphic.color=p.sliceShapeFill}return d(a)}}}});define('sap/viz/controls/plugins/infochart/DataLabelRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var a=5,b=0.8;return{name:"dataLabelRenderer",fn:function(c){return function(d){var p=g(d,c);if(p){var e=S.create("g");var t,f;if(p.textVisible!==false){f=d.text;t=S.create("text",e);t.textContent=f;var s="",h;if((h=p.fontColor)){s+="fill:"+h+";"}if((h=p.fontFamily)){s+="font-family:"+h+";"}if((h=p.fontSize)){s+="font-size:"+h+";"}if((h=p.fontWeight)){s+="font-weight:"+h+";"}if((h=p.fontStyle)){s+="font-style:"+h+";"}if(s){t.setAttribute("style",s)}}if(p.iconVisible===true&&p.iconSVG){var i=p.iconSize;if(i!==0){i=i||b;var j=new I(p.iconSVG);var k=S.create("g",e);var l=j.getWidth();var m=j.getHeight();var n=d.horizontal;var o=n?m:l;var q=d[n?"dataPointHeight":"dataPointWidth"];if(q===0){j.destroy();return e}var r=q*i/o;j.render(k,r,p.iconColor);j.destroy();if(t){var u=d.styles;var v=S.measureText(f,{"font-family":p.fontFamily||u["font-family"],"font-size":p.fontSize||u["font-size"],"font-weight":p.fontWeight||u["font-weight"],"font-style":p.fontStyle||u["font-style"]});l*=r;m*=r;var w=j.getX()*r;var x=j.getY()*r;var y,z;if(n){y=v.x+v.width+a-w;z=v.y+v.height/2-x-m/2}else{y=v.x+v.width/2-w-l/2;z=v.y-a-x-m}k.setAttribute("transform","translate("+y+","+z+")")}}}return e}}}}});define('sap/viz/controls/plugins/infochart/LineMarkerRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){return{name:"lineMarkerRenderer",fn:function(c){return function(a){var p=g(a,c);if(p){var b=a.graphic,i=p.iconSVG;if(i){var d=p.iconSize;if(d===0){return null}d=Math.min(p.iconSize,a.bandLength,a.plotSize[a.horizontal?0:1]);i=new I(i);var e=S.create("g");var f=i.getWidth();var h=i.getHeight();var x=d/f;var y=d/h;i.render(e,[x,y],p.iconColor||b.fill);i.destroy();e.setAttribute("transform","translate("+(-i.getX()*x-d/2)+","+(-i.getY()*y-d/2)+")");return e}}}}}});define('sap/viz/controls/plugins/infochart/LineRendererGenerator',["./getPropertiesByCtx"],function(g){return{name:"lineRenderer",fn:function(c){return function(a){var p=g(a,c);if(p){var b=a.graphic;b.color=p.color||b.color;b.width=p.width||b.width;b.dash=p.dash||b.dash}}}}});define('sap/viz/controls/plugins/infochart/interaction/DesignTimeUtils',[],function(){var _={};var C='v-stack';function h(n,c){if(!n||!n.getAttribute){return false}var a=n.getAttribute('class')||"";return(' '+a+' ').indexOf(' '+c+' ')>=0}function f(c,s,E){var n=s;while(n!==E&&!h(n,c)&&n.parentNode){n=n.parentNode}return n===E?null:n}_.hasClass=h;_.findAncestor=f;_.getAxisModules=function(m){var a=["xAxis","xAxis2","yAxis","yAxis2"];var b=[];a.forEach(function(n,i){n="main."+n;if(m[n]){b.push(m[n])}});return b};_.matchCtx=function(t,c){var i=true;for(var k in t){if(t.hasOwnProperty(k)){if(!c.hasOwnProperty(k)||c[k]!==t[k]){i=false;break}}}return i};_.featureClassesMap={'plotArea':'v-plot-bound','dataPoint':'v-datapoint','stack':'v-stack','dataLine':'v-lines','legend':'v-m-legend','title':'v-m-title','axis':'v-m-axisBody','axisItem':'v-axis-item','axisTitle':'v-m-axisTitle','chart':'v-m-root','gridline':'v-gridline-group','dataLabel':'v-datalabel',_unselectables:['v-gridline-group'],_clz2NameMap:undefined,_allClzs:undefined,_init:function(){var v;if(!this._name2ClzMap){this._clz2NameMap={};this._allClzs=[];for(var k in this){if(this.hasOwnProperty(k)&&typeof(v=this[k])==='string'){this._allClzs.push(v);this._clz2NameMap[v]=k}}}},clz2Name:function(c){this._init();return this._clz2NameMap[c]},allClzs:function(){this._init();return this._allClzs},featureClass:function(n){var a=this.allClzs();for(var i=-1;++i<a.length;){if(h(n,a[i])){return a[i]}}},isSelectable:function(n){n=n[0]||n;var c=this.featureClass(n);return this._unselectables.indexOf(c)===-1},isMultiselectable:function(n){n=n[0]||n;var c=this.featureClass(n);return[this.dataLabel,this.dataPoint,this.axisItem].indexOf(c)>-1},targetPattern:function(n){if(!this[n]){throw"Can't find class for "+n}return"(\\s+|^)"+this[n]+"(\\s+|$)"},allSelectableTargetsPattern:function(){var a=this.allClzs(),c=[];for(var i=-1;++i<a.length;){if(a[i]!==this.chart&&this._unselectables.indexOf(a[i])<0){c.push(a[i])}}return"(\\s+|^)("+c.join('|')+")(\\s+|$)"}};_.axisSubType=function(n){var a=f('v-axis',n).parentNode,b=a.getAttribute('class'),g=/\sv-m-(.)Axis\s/.exec(' '+b+' ');return g[1]};_.typesOfUnit=function(c,u){var t,s;t=this.featureClassesMap.clz2Name(c);if(!t){throw'unknow class: '+c}if(t==='axis'||t==='axisItem'||t==='axisTitle'){s=this.axisSubType(u)}return[t,s]};_.getStackData=function(u){var s=[];var p,c,d,k;for(var i=0;i<u.length;i++){p=u[i].parentNode;if(_.featureClassesMap.featureClass(p)===C){c=d3.select(p).datum();if(!c){continue}d={};for(k in c){if(c.hasOwnProperty(k)){d[k]=c[k]}}s[i]=d}}return s};_.getData=function(n){return n["__data__"]};_.getExtraData=function(n){return n["__extra_data__"]};_.constructEventData=function(u,b,s){if(!u||u.length===0){return null}var t,a,c,d=[],e,g,k=[],l,m,n=this.featureClassesMap.featureClass(u[0]),o;t=this.typesOfUnit(n,u[0]);a=t[0];c=t[1];for(var i=-1;++i<u.length;){e=d3.select(u[i]).datum();if(!e){break}if(n==='v-axis-item'){e=e.ctx}g={};for(o in e){if(e.hasOwnProperty(o)){g[o]=e[o]}}d.push(g);m={};l=_.getExtraData(u[i]);if(l){for(o in l){if(l.hasOwnProperty(o)){m[o]=l[o]}}}k.push(m)}var r={type:a,subType:c,data:d,extraData:k};if(n==='v-datapoint'){var p=_.getStackData(u);if(p.length>0){r.stackData=p}}if(b&&b.isBySeries){var q={};for(var j=0;j<b.seriesBindings.length;j++){q[b.seriesBindings[j]]=d[0][b.seriesBindings[j]]}r.seriesData=q}if(s){r.selectAllData=true}return r};return _});define('sap/viz/controls/plugins/infochart/interaction/DesignTimeLineUtils',["./DesignTimeUtils"],function(D){var _={fuzzyDistance:10,geoUtils:{distance:function(p,a){return Math.sqrt(Math.pow(p.x-a.x,2)+Math.pow(p.y-a.y,2))},distanceFromPointToLine:function(d,l){var a=this.distance(d,l.p1),b=this.distance(d,l.p2),c=this.distance(l.p1,l.p2),p=(a+b+c)/2,s=Math.sqrt(p*(p-a)*(p-b)*(p-c));return 2*s/c},isObtuseAngle:function(a,b,c){var d=this.distance(a,b),e=this.distance(b,c),f=this.distance(c,a);return(d*d+e*e)<(f*f)}},centerOfDP:function(d){var r=d.getBoundingClientRect();return{x:r.left+r.width/2,y:r.top+r.height/2}},fuzzyDP:function(a,p){var m=this.fuzzyDistance+10,b,c,d,e;for(var i=-1;++i<a.length;){d=a[i];c=this.centerOfDP(d);e=this.geoUtils.distance(c,p);if(e<m&&e<this.fuzzyDistance){e=m;b=d}}return b},fuzzyLineByGeo:function(a,b,p){var l,c,d,e,f,m=this.fuzzyDistance+10,g,h,k,n,i,j;for(i=-1;++i<a.length;){l=a[i];c=d3.select(l).datum();e=[];for(j=-1;++j<b.length;){f=b[j];d=d3.select(f).datum();if(D.matchCtx(c,d)){e.push(f)}}for(j=-1;++j<e.length-1;){k=this.centerOfDP(e[j]);n=this.centerOfDP(e[j+1]);h=this.geoUtils.distanceFromPointToLine(p,{p1:k,p2:n});if(h<m&&h<this.fuzzyDistance&&!this.geoUtils.isObtuseAngle(p,k,n)&&!this.geoUtils.isObtuseAngle(p,n,k)){m=h;g=i}}}if(m<this.fuzzyDistance){return a[g]}},fuzzyLine:function(l,a,p){var b,d,n,i,t;for(i=-1;++i<l.length;){b=l[i];d=b.getAttribute('d');n=document.createElementNS("http://www.w3.org/2000/svg",'path');n.setAttribute('d',d);n.setAttribute('stroke-width',this.fuzzyDistance*2);n.setAttribute('fill','none');n.setAttribute('stroke','transparent');b.parentNode.appendChild(n);t=document.elementFromPoint(p.x,p.y);b.parentNode.removeChild(n);if(t===n){return b}}},fuzzilyMatch:function(r,p){var l=r.querySelectorAll('.'+D.featureClassesMap.dataLine);if(!l.length){return}var a=r.querySelectorAll('.'+D.featureClassesMap.dataPoint),d;d=this.fuzzyDP(a,p);if(d){return d}return this.fuzzyLine(l,a,p)}};return _});define('sap/viz/controls/plugins/infochart/interaction/PieBehaviorHelper',["sap/viz/controls/common/utils/Utils"],function(U){var c=function(d,a,e){var f=a;var g=e;if(d3.select(d).attr('transform')){var t=d3.select(d).attr('transform');if(t.indexOf('translate')>-1){d3.select(d).attr("originalTransform",t);var h=d3.transform(t);if(h&&h.translate&&h.translate.length===2){f=h.translate[0]+a;g=h.translate[1]+e}}}if(d){d3.select(d).transition().attr('transform',"translate("+f+","+g+")")}};var b=function(d){var t=d3.select(d).attr("originalTransform");if(t){d3.select(d).transition().attr('transform',t)}};var P={selectDataPoint:function(f){if(!U.isArray(f)){f=[f]}f.forEach(function(e){var g=d3.select(e);var d=g.node()["__extra_data__"];if(d){var h=d.decoras;var i=0,j=0;var a=d.midAngle;var r=d.r;var s;s=0.08*r;i=s*Math.sin(a);j=-s*Math.cos(a);g.attr('transform',"translate("+i+","+j+")");g.attr('translateOffsetX',i);g.attr('translateOffsetY',j);if(h&&(!g.attr('offsetDone')||g.attr('offsetDone')==="false")){c(h,i,j)}g.attr('offsetDone',true)}})},deselectDataPoint:function(a){if(!U.isArray(a)){a=[a]}a.forEach(function(e){var f=d3.select(e);if(f){if(f.attr('offsetDone')==="true"){f.attr('transform',"translate(0,0)");var o=f.attr('translateOffsetX');var g=f.attr('translateOffsetY');var d=f.node()["__extra_data__"];var h=d.decoras;if(h&&o&&g){b(h)}f.attr('offsetDone',false)}}})}};return P});define('sap/viz/controls/plugins/infochart/interaction/DesignTimeBehavior',["sap/viz/controls/plugins/infochart/interaction/DesignTimeUtils","sap/viz/controls/plugins/infochart/interaction/DesignTimeLineUtils","sap/viz/controls/plugins/infochart/interaction/PieBehaviorHelper","sap/viz/controls/common/utils/Utils","jquery"],function(D,a,P,U,$){var b=new sap.viz.api.interaction.Behavior({id:"DesignTimeBehavior"});var p="v-plot-bound",c="v-datapoint",f="v-lines",g="v-datalabel",l="v-m-legend",h="v-m-axisBody",j="v-m-axisTitle",k="v-m-title";var m=["info/bar","info/column","info/dual_bar","info/dual_column","info/stacked_bar","info/stacked_column","info/dual_stacked_bar","info/dual_stacked_column","info/100_stacked_bar","info/100_stacked_column","info/100_dual_stacked_bar","info/100_dual_stacked_column"];var n=["info/pie","info/donut"];var o=["info/line","info/horizontal_line","info/dual_line","info/dual_horizontal_line"];var q=D.hasClass,r=D.findAncestor;function u(d,i,s){if(U.isArray(d)){d.forEach(function(e){u(e,i,s)});return}var t=x(d),R=v(d),S=t.style,T={},V=1;i=i||{"stroke":"blue","stroke-width":V+"px","stroke-dasharray":3*V+","+3*V,"fill-opacity":1,"stroke-opacity":1};for(var W in i){if(i.hasOwnProperty(W)){if(R){T[W]=S[W]}S[W]=i[W]}}if(R&&!$(t).data("vizSelectOrigStyle")){$(t).data("vizSelectOrigStyle",T)}}function v(d){return q(d,'v-datapoint')||q(d,'v-lines')}function w(d){if(v(d)){return d}return $(d).data("v-select-indicator")}function x(d){var i=w(d);if(v(d)){return i}var e=d,s,t,R;t=q(d,"v-m-root")?d:r("v-m-root",d);R=t.getBoundingClientRect();if(i){d3.select(i).remove()}i=d3.select(t).append("rect").attr("class","v-select-indicator").style({"visibility":"hidden","fill":"none"}).node();if(q(d,"v-m-title")){e=d.querySelector(".v-title")}else if(q(d,"v-m-axisTitle")){e=d.querySelector("text")}else if(q(d,"v-axis-item")){e=d.querySelector(".viz-axis-label-rect")}s=e.getBoundingClientRect();d3.select(i).attr({x:s.left-R.left,y:s.top-R.top,width:s.width,height:s.height}).style("visibility","visible");$(d).data("v-select-indicator",i);return i}function y(d){if(U.isArray(d)){d.forEach(function(e){y(e)});return}var i=w(d);if(!i){return}if(v(d)){var s=$(i).data("vizSelectOrigStyle")||{},t=i.style;for(var R in s){if(s.hasOwnProperty(R)){if(s[R]===undefined){delete t[R]}else{t[R]=s[R]}}}$(i).removeData("vizSelectOrigStyle")}else{d3.select(i).remove()}}function z(s,d){var e=false;for(var i=-1;++i<d.length;){if(s&&s.indexOf(d[i])>-1){e=true}else{if(e){return'some'}}}return e?'all':'none'}b.add({"id":"initialized_datapoint","trigger":{"name":"afterBehaviorLoaded"},"handler":function(e,s){s.setStatus("selectedUnits",[]);s.setStatus("isHoveringDeselectedDataPoint",false);this.exposeMoreEvents("selectPropertyZone");this.exposeMoreEvents("deselectPropertyZone");var b=this;window.setTimeout(function(){if(s.getRootNode()){K(b,s,{targets:s.getRootNode().node(),ctrlKeyPressed:false,force:true,bySeries:false,suppressEvent:true,selectAllData:false})}})}});b.add({"id":"afterChartRendered","trigger":{"name":"afterChartRendered"},"handler":function(e,s){if(s.getStatus("selectedPropertyZoneData")){Q(this,s,O(this,s));var d=s.getStatus("selectedUnits");if(d&&d.length){s.fireEvent("selectItem",{targets:d})}}}});b.add({"id":"select_on_plotArea","trigger":{"name":"click","targets":["v-plot-bound"]},"handler":function(e,s){var d=s.getStatus("selected"),i=s.getStatus("selectedUnits"),t=e.data.currentTarget;var R=a.fuzzilyMatch(s.getRootNode().node(),e.data.point),S;if(R){if(q(R,"v-datapoint")){A(this,{data:{currentTarget:R,target:R,ctrlKey:e.data.ctrlKey}},s,"v-datapoint");return}if(q(R,"v-lines")){B(this,{data:{currentTarget:R,target:R,ctrlKey:e.data.ctrlKey}},s);return}}K(this,s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:false,selectAllData:false})}});b.add({"id":"select_on_datalabel","trigger":{"name":"click","targets":["v-datalabel"]},"handler":function(e,s){A(this,e,s,"v-datalabel")}});function A(b,e,s,i){var d=s.getStatus("selected"),t=s.getStatus("selectedUnits"),R=e.data.currentTarget;var S,T,V=false;function W(R,V){K(b,s,{targets:R,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:V,selectAllData:false})}if(!e.data.ctrlKey){S=L(s,R,i);T=z(t,S);if(T==='none'||(T==='all'&&t.length>S.length)){R=S;V=true}}W(R,V)}function B(b,e,s){var d=s.getStatus("selected"),i=s.getStatus("selectedUnits"),t=e.data.currentTarget,R;K(b,s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:false,selectAllData:false})}b.add({"id":"select_on_datapoint","trigger":{"name":"click","targets":["v-datapoint"]},"handler":function(e,s){A(this,e,s,"v-datapoint")}});b.add({"id":"select_on_line","trigger":{"name":"click","targets":["v-lines"],"supportedChartTypes":o},"handler":function(e,s){B(this,e,s)}});function C(b,e,s){var d=s.getStatus("selectedUnits").splice(0);F(s);s.fireEvent("deselectItem",{targets:d});if(d.length){I(b,d,"deselect")}}b.add({"id":"deselect_all","trigger":{"name":"click","excludeTargets":["v-datapoint","v-m-legend","v-axis-item","v-datalabel","v-m-axisBody","v-plot-bound","v-m-axisTitle","v-m-title","v-lines"]},"handler":function(e,s){var d=s.getStatus("selected"),i=s.getStatus("selectedUnits"),t=e.data.currentTarget;C(this,e,s);t=s.getRootNode().node();s.setStatus("selected","v-m-root");s.setStatus("selectedPropertyZoneData",D.constructEventData([t]));i.push(t);s.fireEvent("selectItem",{targets:[t]});I(this,[t],"select")}});function E(s){var d=s.getRootNode().select(".v-plot-main").node().firstChild;d.setAttribute("fill-opacity","0.2");d.setAttribute("stroke-opacity","0.2")}function F(s){var d=s.getRootNode().select(".v-plot-main").node().firstChild;d.removeAttribute("fill-opacity");d.removeAttribute("stroke-opacity")}function G(e){var d=1,i,t;if(v(e)){i=e.querySelector("circle")||e.querySelector("path");if(i){t=i.getTransformToElement(e);d=1/t.a}}return d}b.add({"id":"selectItem_general","trigger":{"name":"selectItem"},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d]}var i=G(d[0]);u(d,{"stroke":"blue","stroke-width":i+"px","stroke-dasharray":3*i+","+3*i,"fill-opacity":1,"stroke-opacity":1})}});b.add({"id":"selectItem_line","trigger":{"name":"selectItem","supportedChartTypes":o},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d]}if(q(d[0],"v-lines")){u(d,{"stroke-opacity":'1'})}else{var i=G(d[0]);u(d,{"stroke":"blue","stroke-width":i+"px","stroke-dasharray":3*i+","+3*i,"fill-opacity":1,"stroke-opacity":1})}}});b.add({"id":"deselectItem_general","trigger":{"name":"deselectItem"},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d]}y(d)}});b.add({"id":"selectItem_pie","trigger":{"name":"selectItem","supportedChartTypes":n},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d]}var i=G(d[0]);u(d,{"stroke":"blue","stroke-width":i+"px","stroke-dasharray":3*i+","+3*i,"fill-opacity":1,"stroke-opacity":1});P.selectDataPoint(d)}});b.add({"id":"deselectItem_pie","trigger":{"name":"deselectItem","supportedChartTypes":n},"handler":function(d,s){var i=d.data.targets;if(!U.isArray(i)){i=[i]}i.forEach(function(e){y(e)});P.deselectDataPoint(i)}});function H(b,e,s){var d=s.getStatus("selected"),i=s.getStatus("selectedUnits"),t=e.data.currentTarget;K(b,s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:false,selectAllData:false})}b.add({"id":"select_on_title","trigger":{"name":"click","targets":["v-m-title"]},"handler":function(e,s){H(this,e,s)}});b.add({"id":"select_on_axisTitle","trigger":{"name":"click","targets":["v-m-axisTitle"]},"handler":function(e,s){H(this,e,s)}});b.add({"id":"select_on_legend","trigger":{"name":"click","targets":["v-m-legend"]},"handler":function(e,s){H(this,e,s)}});function I(b,t,s){var e=D.constructEventData(t),d=s==="select"?"selectPropertyZone":"deselectPropertyZone";b.dispatchEvent(d,e)};function J(b,d,s){var e=d,i=s==="select"?"selectPropertyZone":"deselectPropertyZone";b.dispatchEvent(i,e)};function K(d,s,t){var R=s.getStatus("selectedUnits"),S=t.targets,T=D.featureClassesMap.isMultiselectable(S);if(!t.force&&R.length===1&&S.length===1&&R[0]===S[0]&&!T){return}if(t.ctrlKeyPressed&&!T&&R.length){return}if(!U.isArray(S)){S=[S]}if(R.length===0){}var V=[],W=[],X,Y;if(t.ctrlKeyPressed){for(var i=-1;++i<S.length;){Y=S[i];if((X=R.indexOf(Y))>-1){Array.prototype.push.apply(W,R.splice(X,1))}else if(!s.getStatus("selected")||q(Y,s.getStatus("selected"))){R.push(Y);V.push(Y)}}if(!R.length){var Z=D.featureClassesMap.chart;var _=s.getRootNode().node();if(!q(_,Z)){_=_.querySelector("."+Z)}R.push(_);V.push(_)}}else{if(R.length===S.length){if(R.every(function(e,i){return e===S[i]})){return}}Array.prototype.push.apply(W,R);R.splice(0);Array.prototype.push.apply(R,S);Array.prototype.push.apply(V,S)}var a1=R.length===0?null:D.featureClassesMap.featureClass(R[0]);if(a1!==s.getStatus("selected")&&(a1==="v-datapoint"||a1===D.featureClassesMap.dataLine)){E(s)}else if(a1!=="v-datapoint"&&a1!==D.featureClassesMap.dataLine){F(s)}s.setStatus("selected",a1);var b1={};b1.isBySeries=t.bySeries;b1.seriesBindings=s.getModule("main.plot").getColorBindings();s.setStatus("selectedPropertyZoneData",D.constructEventData(R,b1,t.selectAllData));if(W.length>0){s.fireEvent("deselectItem",{targets:W});if(!t.suppressEvent){I(d,W,"deselect")}}if(V.length>0){s.fireEvent("selectItem",{targets:V});if(!t.suppressEvent){J(d,s.getStatus("selectedPropertyZoneData"),"select")}}}function L(s,e,t){var R=d3.select(e).datum(),S={},T=[],V=s.getModule("main.plot").getColorBindings();for(var i=-1;V&&++i<V.length;){S[V[i]]=R[V[i]]}s.getRootNode().selectAll('.'+t).filter(function(d){for(var W in S){if(S.hasOwnProperty(W)){if(d[W]!==S[W]){return}}}T.push(this)});return T}function M(t,s){var e=d3.select(t).datum(),R={},S=[],T=s.getModule("main.plot").getColorBindings();for(var i=-1;T&&++i<T.length;){R[T[i]]=e[T[i]]}s.getRootNode().selectAll("."+D.featureClassesMap.dataPoint).filter(function(d){for(var V in R){if(R.hasOwnProperty(V)){if(d[V]!==R[V]){return}}}S.push(this)});return S}b.add({"id":"select_on_axisBody","trigger":{"name":"click","targets":["v-m-axisBody"]},"handler":function(e,s){var d=s.getStatus("selected"),i=s.getStatus("selectedUnits"),t=e.data.currentTarget;var R=i[0];if(R&&(R===t||q(R,'v-axis-item'))){t=r('v-axis-item',e.data.target,t)||t}K(this,s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:false,selectAllData:false})}});b.add({"id":"getSelection","trigger":{"name":"getSelection",},"handler":function(e,s){return O(this,s)}});b.add({"id":"setSelection","trigger":{"name":"setSelection",},"handler":function(e,s){return Q(this,s,e.data)}});b.add({"id":"clearSelection","trigger":{"name":"clearSelection",},"handler":function(e,s){return N(s)}});function N(s){s.fireEvent("deselectItem",{targets:s.getStatus("selectedUnits").splice(0)});F(s);s.setStatus("selected",null)}function O(b,s){return s.getStatus("selectedPropertyZoneData")}function Q(b,s,e){var t=[],R=D.featureClassesMap[e.type],S=e.data&&e.data.length;if(!R){throw"Unsupported property zone type: "+e.type}var T=s.getRootNode().selectAll("."+R);var V=function(d){for(var i=-1;++i<e.data.length;){if(D.matchCtx(e.data[i],d)){return true}}return false};var W=e.selectAllData||false;switch(e.type){case"dataPoint":E(s);if(S){T=T.filter(V)}else{W=true}break;case"dataLine":E(s);if(S){T=T.filter(V)}else{W=true}break;case"dataLabel":if(S){T=T.filter(V)}else{W=true}break;case"axis":case"axisItem":case"axisTitle":T=T.filter(function(d){var X=D.axisSubType(this);if(X!==e.subType){return false}if(e.type!=="axisItem"||!S){if(e.type==="axisTitle"){return this.querySelector(".viz-axis-title")}return true}for(var i=-1;++i<e.data.length;){if(D.matchCtx(e.data[i],d.ctx)){return true}}return false});break;case"title":T=T.filter(function(d){return this.querySelector(".v-title")});break;default:break}T.each(function(){t.push(this)});if(q(s.getRootNode().node(),R)){t.push(s.getRootNode().node())}K(b,s,{targets:t,ctrlKeyPressed:false,force:true,bySeries:undefined,suppressEvent:true,selectAllData:W});if(!t.length){s.setStatus("selectedPropertyZoneData",e)}return true}return b});define('sap/viz/controls/plugins/infochart/setup',['sap/viz/controls/chart/adapters/PropFnGeneratorRegistry','./StackDecoratorGenerator','./BarShapeRendererGenerator','./CategoryAxisLabelRendererGenerator','./PieSliceRendererGenerator','./DataLabelRendererGenerator','./LineMarkerRendererGenerator','./LineRendererGenerator','./interaction/DesignTimeBehavior'],function(P,S,B,C,a,D,L,b,d){function r(c){P.register(c.name,c.fn)}var g=[S,B,C,a,D,L,b];g.forEach(r);sap.viz.api.interaction.add(d)});define('sap/viz/controls/contextmenu/ContextMenuConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{'menu':[["sap.viz.controls.contextmenu.item.direction","sap.viz.controls.contextmenu.item.stacking"],["sap.viz.controls.contextmenu.item.title","sap.viz.controls.contextmenu.item.legend","sap.viz.controls.contextmenu.item.mbclegend","sap.viz.controls.contextmenu.item.datalabels","sap.viz.controls.contextmenu.item.negative","sap.viz.controls.contextmenu.item.mnd","sap.viz.controls.contextmenu.item.setAxisScale"]]}};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU,C);return C});define('sap/viz/controls/contextmenu/ContextMenuEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenuEvent"};O.extend(C,E);C.POPUP_CONTEXT_MENU="popupContextMenu";C.REQUEST_LEGEND_COLOR="chooseLegendColors";C.POPUP_CHART_EDITOR='popupChartEditor';C.MENU_ITEM_SELECTED='menuItemSelected';return C});define('sap/viz/controls/contextmenu/views/MenuItem',['jquery','sap/viz/controls/common/constants/CSSConst'],function($,C){var c=C.CONTEXTMENU_PREFIX;var a=c+"MnuItm";var b=c+"MnuItmIco";var d=c+"MnuItmTxt";var e=c+"MnuItm-Show";var f=c+"MnuItm-Hide";var g=c+"MnuItmIco-Show";var h=c+"MnuItmIco-Hide";var i=c+"MnuItmOpen";var j=C.COMMON_PREFIX+'menu-list-suffix-icon-submenu';var k=C.COMMON_PREFIX+'havanaSharedSprite16';var l=C.CONTEXTMENU_PREFIX+"disabled";function M(q,r,s){this.__className="sap.viz.controls.contextmenu.views.MenuItem";q=q||{};var t=this.dom=document.createElement('li');t.className=a;t.innerHTML='<div id="'+q.name+'" class="'+a+'"><div class="'+b+'"></div><div class="'+d+'">'+(q.text===undefined?'':q.text)+'</div><div class="'+j+' '+k+'"></div></div>';this._menuItemNode=t.firstChild;this._iconNode=this._menuItemNode.firstChild;this._textNode=this._iconNode.nextSibling;this._arrowNode=this._menuItemNode.lastChild;this._arrowNode.style.visibility='hidden';this.name=q.name;this.menu=r;if(q.icon){this.setIcon(q.icon)}if(q.tooltip){this.setTooltip(q.tooltip)}if(q.disabled){this.setDisablaed(q.disabled)}if($.isArray(q.submenu)&&q.submenu.length){this.setSubmenu(new s(q.submenu,r))}if(!q.disabled){this.onExecute=q.click;this._setupEvents()}}M.prototype._setupEvents=function(){var s=this;var q=$(this.dom);function r(){s.showSubmenu()}function t(){if(!s._submenu){s._onExecute()}}q.on('mouseenter',r).on('click',t);s._cleanupEvents=function(){q.off('mouseenter',r).off('click',t)}};M.prototype.setDisablaed=function(q){$(this.dom).toggleClass(l,!!q)};M.prototype.destroy=function(){if(this._submenu){this._submenu.destroy()}if(this._cleanupEvents){this._cleanupEvents()}$(this.dom).remove()};M.prototype.text=function(){return this._textNode.innerHTML};M.prototype.setText=function(t){this._textNode.innerHTML=t};M.prototype.setIcon=function(q){this._iconNode.innerHTML='<img src="'+q+'" />'};M.prototype.setTooltip=function(t){_(this.dom,t,this.menu.container())};M.prototype.submenu=function(){return this._submenu};M.prototype.setSubmenu=function(q){this._submenu=q;this._arrowNode.style.visibility=q?'':'hidden'};M.prototype.showSubmenu=function(){this.menu.hideSubmenus();if(this._submenu){$(this.dom).addClass(i);this._submenu.show({dock:this.dom},this.menu._hDir+'-down')}};M.prototype.hideSubmenu=function(){if(this._submenu){$(this.dom).removeClass(i);this._submenu.hideSubmenus();this._submenu.hide()}};M.prototype._onExecute=function(){if(this.onExecute){this.onExecute()}this.menu.hideAll()};var T={top:15,left:20};var m=C.CONTEXTMENU_PREFIX+"MnuItmTooltip";function _(q,t,r){var s;var u=$(q);var v=$(r);u.on('mouseover',function(w){var x=$(document.createElement('div')).addClass(m).appendTo($("body"));x.text(t);p(v,x,o(v,n(u)),T);s=setTimeout(function(){$("."+m).animate({opacity:1},500)},1000)});u.on("mouseout mousedown",function(){$("."+m).remove();clearTimeout(s)})}function n(q){var r=q.offset(),w=q.innerWidth(),s=q.innerHeight();return{pageX:r.left+w/2,pageY:r.top+s/2}}function o(q,r){return{pageX:r.pageX-q.offset().left,pageY:r.pageY-q.offset().top}}function p(q,r,s,t){if(!t){t={top:0,left:0}}if(s){var u=q.innerWidth();var v=r.outerWidth();var w=s.pageX+t.left;if(u<v+w){w=s.pageX-v-t.left}var x=s.pageY+t.top;var y=q.innerHeight();var z=r.outerHeight();if(y<z+x){x=s.pageY-z-t.top}r.css({position:"fixed",left:q.offset().left+w+"px",top:q.offset().top+x+"px"})}}return M});define('sap/viz/controls/contextmenu/views/CheckedMenuItem',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/contextmenu/views/MenuItem'],function($,O,C,M){var c=C.CONTEXTMENU_PREFIX+"MnuItm-Show";var a=C.CONTEXTMENU_PREFIX+"MnuItm-Hide";var b=C.CONTEXTMENU_PREFIX+"MnuItmIco-Show";var d=C.CONTEXTMENU_PREFIX+"MnuItmIco-Hide";function e(f){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.CheckedMenuItem";this._iconNode.style.display='none';this.setChecked(f.checked)}O.extend(e,M);e.prototype.setChecked=function(f){$(this.dom).toggleClass(b,!!f).toggleClass(d,!f);$(this._menuItemNode).toggleClass(c,!!f).toggleClass(a,!f)};e.prototype.checked=function(){return $(this.dom).hasClass(b)};e.prototype._onExecute=function(){this.setChecked(!this.checked());e.superclass._onExecute.apply(this,arguments)};return e});define('sap/viz/controls/contextmenu/views/BlankMenuItem',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/contextmenu/views/MenuItem'],function($,O,C,L,M){var c=C.CONTEXTMENU_PREFIX+"blank-MnuItem";var a=C.CONTEXTMENU_PREFIX+'blank-MnuItmTxt';function B(){B.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.BlankMenuItem";$(this.dom).addClass(c);$(this._textNode).addClass(a).text(L.get('VIZ_CONTEXTMENU_NO_MENU_ITEMS'))}O.extend(B,M);return B});define('sap/viz/controls/contextmenu/views/MenuSeparator',['sap/viz/controls/common/constants/CSSConst'],function(C){function M(){this.__className="sap.viz.controls.contextmenu.views.MenuSeparator";var d=this.dom=document.createElement('div');d.className=C.CONTEXTMENU_PREFIX+"MnuItem-separator"}return M});define('sap/viz/controls/contextmenu/views/Menu',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/contextmenu/views/MenuItem','sap/viz/controls/contextmenu/views/CheckedMenuItem','sap/viz/controls/contextmenu/views/BlankMenuItem','sap/viz/controls/contextmenu/views/MenuSeparator'],function($,C,M,a,B,b){var c=C.PREFIX+'contextmenu';var d=C.CONTEXTMENU_PREFIX+'list';var e=C.CONTEXTMENU_PREFIX+'list-hovered';var f=document;var w=window;function g(i,p,h){this.__className="sap.viz.controls.contextmenu.views.Menu";var j=this.dom=f.createElement('div');j.className=c;j.innerHTML='<ul class="'+d+'"></ul>';this._listNode=j.firstChild;this._items=[];this._parentMenu=p;this.setContainer(h);this._opennedSubmenuCount=0;this._shown=0;this._setupEvents();this.create(i)}g.prototype.marginOffset=6;g.prototype._setupEvents=function(){var s=this;function n(i,j){var r=false;for(var m=i;m&&!r;m=m._parentMenu){r=$.contains(m.dom,j)}return r}function o(i){if(s._shown&&s._opennedSubmenuCount===0&&!n(s,i.target)){s.hideAll()}}function h(){s.hide()}$(f).on('mousedown',o);$(w).on('blur',h);this._cleanupEvents=function(){$(f).off('mousedown',o);$(w).off('blur',h)}};g.prototype._createMenuItem=function(h){h=h||{};var m={checked:a,blank:B,separator:b}[h.menuItemType]||M;return new m(h,this,g)};g.prototype.create=function(h){h=$.isArray(h)?h:[];this._destroyChildren();$(this._listNode).toggleClass(e,!!h.length);if(!h.length){h.push({menuItemType:'blank'})}for(var i=0;i<h.length;++i){var j=this._createMenuItem(h[i]);if(j){this.addChild(j)}}};g.prototype._destroyChildren=function(){for(var i=0;i<this._items.length;++i){var h=this._items[i];if(h.destroy){h.destroy()}}this._listNode.innerHTML='';this._items=[]};g.prototype.destroy=function(){this._destroyChildren();this._cleanupEvents();$(this.dom).remove()};g.prototype.setContainer=function(h){this._container=h||(this._parentMenu&&this._parentMenu.container())||f.body};g.prototype.container=function(){return this._container};g.prototype.isShown=function(){return!!this._shown};g.prototype._calcPopupPosition=function(p,h){var i=this.dom;var j=this._container;var l=0;var t=0;var k;if(p){l=p.left||0;t=p.top||0;k=p.dock}h=String(h).toLowerCase().split('-');var m=h[0];var v=h[1];this._hDir='right';this._vDir='down';if(j){var n=j.clientHeight;var o=j.clientWidth;var q=i.offsetWidth;var r=i.offsetHeight;var s=$(j).offset();var u=s.left;var x=s.top;if(k){var y=$(k).offset();var z=y.left;var A=y.top;var D=k.offsetWidth;var E=k.offsetHeight;var F=this.marginOffset;if((m==='left'&&u<=z-q)||(m!=='left'&&u+o<z+D+q)){l=z-q;this._hDir='left'}else{l=z+D}if((v==='up'&&x<=A+E-r)||(v!=='up'&&x+n<A+r)){t=A+E-r+F;this._vDir='up'}else{t=A-F}}else{if((m==='left'&&l>=q)||(m!=='left'&&o<l+q)){l-=q;this._hDir='left'}if((v==='up'&&up>=r)||(v!=='up'&&n<t+r)){t-=r;this._vDir='up'}l+=u;t+=x}l-=f.body.scrollLeft;t-=f.body.scrollTop}return{left:l,top:t}};g.prototype.show=function(p,h){if(!this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount++}this._shown=1;f.body.appendChild(this.dom);var i=this.dom.style;i.display='block';var j=this._calcPopupPosition(p,h);i.left=j.left+'px';i.top=j.top+'px'}};g.prototype.hide=function(){if(this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount--}this._shown=0;var h=this.dom;h.style.display='none';if(h.parentNode){h.parentNode.removeChild(this.dom)}}};g.prototype.hideAll=function(){if(this._parentMenu){this._parentMenu.hideAll()}else{this.hideSubmenus();this.hide()}};g.prototype.children=function(){return this._items};g.prototype.addChild=function(m){var i=this._items.indexOf(m);if(i<0){this._items.push(m);this._listNode.appendChild(m.dom)}};g.prototype.removeChild=function(m){var i=this._items.indexOf(m);if(i>=0){this._items.splice(i,1);this._listNode.removeChild(m.dom)}};g.prototype.hideSubmenus=function(){this._items.forEach(function(i){if(i.hideSubmenu){i.hideSubmenu()}})};return g});define('sap/viz/controls/contextmenu/constants/MenuItemConst',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager'],function(C,L){var M={};M.getText=function(t){return L.get(t)};M.DEFAULT={"icon":"/contextmenu/uncheck.png"};M.LEGEND={"name":"sap.viz.controls.contextmenu.item.legend","text":"VIZ_CONTEXTMENU_SHOW_LEGEND","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/geomap":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true,"info/bar":true,"info/column":true,"info/line":true,"info/donut":true}};M.DATALABELS={"name":"sap.viz.controls.contextmenu.item.datalabels","text":"VIZ_CONTEXTMENU_SHOW_DATALABELS","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/heatmap":true,"viz/treemap":true,"viz/radar":true,"viz/waterfall":true,"info/bar":true,"info/column":true,"info/line":true,"info/donut":true}};M.DIRECTION={"name":"sap.viz.controls.contextmenu.item.direction","text":{"horizontal":"VIZ_CONTEXTMENU_VERTICAL","vertical":"VIZ_CONTEXTMENU_HORIZONTAL"},"supportType":{"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/boxplot":true,"viz/waterfall":true,"info/line":true}};M.STACKING={"name":"sap.viz.controls.contextmenu.item.stacking","text":{"full":"VIZ_CONTEXTMENU_NORMAL_STACKING","normal":"VIZ_CONTEXTMENU_FULL_STACKING"},"supportType":{"viz/stacked_bar":true,"viz/stacked_column":true,"viz/area":true}};M.COMMENT={"name":"sap.viz.controls.contextmenu.item.comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};M.CHARTEDITOR={"name":"sap.viz.controls.contextmenu.item.charteditor","text":"VIZ_CONTEXTMENU_MENU_CHART_EDITOR","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};M.MBCLEGEND={"name":"sap.viz.controls.contextmenu.item.mbclegend","text":"VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR","supportType":{"viz/choropleth":true,"viz/treemap":true,"viz/heatmap":true,"viz/tagcloud":true}};M.MND={"name":"sap.viz.controls.contextmenu.item.mnd","text":"VIZ_CONTEXTMENU_SHOW_MND","tooltip":"VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":false,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true,"info/bar":true,"info/column":true,"info/line":true,"info/donut":true}};M.TITLE={"name":"sap.viz.controls.contextmenu.item.title","text":"VIZ_CONTEXTMENU_SHOW_TITLE","notSupportType":{"viz/geomap":true,}};M.SETAXISSCALE={"name":"sap.viz.controls.contextmenu.item.setAxisScale","text":"VIZ_CONTEXTMENU_SET_AXIS_SCALE","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/scatter":true,"viz/bubble":true,"viz/boxplot":true,"viz/waterfall":true,"info/bar":true,"info/column":true,"info/line":true}};M.NEGATIVE={"name":"sap.viz.controls.contextmenu.item.negative","text":"VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES","supportType":{"viz/bubble":true,"viz/geobubble":true}};return M});define('sap/viz/controls/contextmenu/MenuModelGenerator',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/contextmenu/constants/MenuItemConst'],function(C,U,V,D,F,a,b,L,c,M){var d=(function(m){var n,i={};for(n in m){if(m[n]["name"]){i[m[n]["name"]]=m[n]}}return i})(M);function g(i,v){var e=d[i];if(!e)return true;if(e.supportType)return!!e.supportType[v];if(e.notSupportType)return!e.notSupportType[v];return true}var h={"separator":function(i,e,f,v,p){return{type:"separator"}},"sap.viz.controls.contextmenu.item.direction":function(i,e,f,v,p){var k=b.getDirection(e().type());return{id:i,label:L.get(d[i].text[k])}},"sap.viz.controls.contextmenu.item.stacking":function(i,e,f,v,p){var s=b.getStacking(e().type());return{id:i,label:L.get(d[i].text[s])}},"sap.viz.controls.contextmenu.item.title":function(i,e,f,v,p){var k=function(v){var m=f().getProperties();m=m||{};m.title=m.title||{visible:true};var n=m.title.visible;return n};return{id:i,label:L.get(d[i].text),checked:k(v)}},"sap.viz.controls.contextmenu.item.legend":function(i,e,f,v,p){var k=function(v){var m=f().getProperties();m=m||{};m.legend=m.legend||{visible:true};var n=m.legend.visible;if(v.search('geo')>-1){var s=m.sizeLegend;n=n&&(s?s.visible:true)}return n};return{id:i,label:L.get(d[i].text),checked:k(v)}},"sap.viz.controls.contextmenu.item.mbclegend":function(e,f,k,v,p){var m=function(v){if(k().isFakeChart()){return false}var o=f().feedingItems();for(var i=0;i<o.length;i++){var q=o[i];if(v===C.TYPE_TAG_CLOUD&&q.id()==="tagFamily"&&q.values().length===0){return false}if(v===C.TYPE_TREEMAP&&q.id()==="rectangleColor"&&q.values().length===0){return false}}return true};if(!m(v)){return}var n=function(v){var i=k().getProperties();i=i||{};i.legend=i.legend||{visible:true};var o=i.legend.visible;if(v.search('geo')>-1){var s=i.sizeLegend;o=o&&(s?s.visible:true)}return o};return{id:e,label:L.get(d[e].text)}},"sap.viz.controls.contextmenu.item.datalabels":function(i,e,f,v,p){var k=function(v){var m=f();var n=m.getProperties();n=n||{};n.dataLabel=b.isInfoChart(v)?n.plotArea.dataLabel:n.dataLabel;n.dataLabel=n.dataLabel||{visible:false};if(!b.isInfoChart(v)){return n.dataLabel.visible}else{var k=false;var o=m.getPropertyZones();var z=new c(c.DATA_LABEL);m.setPropertyZones([z]);var q=m.getPropertyZones();if(q){var t=m.queryProperties({'propertyZones':q,'propertyFields':{'textVisible':true},'chartType':v});if(t.textVisible===undefined){k=n.dataLabel.visible}else if(t.textVisible===null||t.textVisible===true){k=true}}m.setPropertyZones(o);return k}};return{id:i,label:L.get(d[i].text),checked:k(v)}},"sap.viz.controls.contextmenu.item.mnd":function(e,f,m,v,p){var n=function(v){var s=false;var o;var k=-1;var q=sap.viz.api.manifest.Viz.get(v)[0];if(q){o=q.allFeeds();for(k=0;k<o.length;k++){if(a.canAcceptMND(o[k].acceptMND)){s=true;break}}}if(!s&&!b.isMultipleChart(v)&&b.supportMultiChart(v)){var r=b.toMultiChartType(v);q=sap.viz.api.manifest.Viz.get(r)[0];o=q.allFeeds();for(k=0;k<o.length;k++){if(a.canAcceptMND(o[k].acceptMND)){s=true;break}}}if(!s){return false}var t=f().feedingItems();for(var i=0;i<t.length;i++){var u=t[i];if(u.type()===F.MEASURE&&u.values().length>0){return true}}return false};if(!n(v)){return}return{id:e,label:L.get(d[e].text),tooltip:L.get(d[e].tooltip),checked:f().isMNDVisible()}},"sap.viz.controls.contextmenu.item.setAxisScale":function(i,e,f,v,p){var k=function(v){if(b.isMultipleChart(v)){return false}return true};if(!k(e().type())){return}return{id:i,label:L.get(d[i].text)}},"sap.viz.controls.contextmenu.item.negative":function(i,e,f,v,p){var k=function(v){var m=f().getProperties();m=m||{};m.plotArea=m.plotArea||{showNagativeValues:false};var n=m.plotArea.showNegativeValues;return n};if(!D.hasNegativeMeasureValue(f().getDataset(),e().type())){return}return{id:i,label:L.get(d[i].text),checked:k(v)}}};function j(m,i,k,n,v,p){var o=m.reduce(function(f,e){if(U.isArray(e)){Array.prototype.push.apply(f,e);f.push({type:"separator"})}else{if(!(U.isBoolean(e.visible)&&e.visible===false)){f.push(e)}}return f},[]).map(function(e){var f;if(e&&e.id&&e.id.charAt(7)===":"&&e.id.substring(0,7)==="builtIn"){e.id=e.id.substring(8);f=i.generate([e.id],k,n,v,p)[0];if(f)$.extend(true,f,e);return f}else{return e}}).reduce(function(f,e){if(!e)return f;if(e.type==="separator"&&f[f.length-1]&&f[f.length-1].type==="separator")return f;f.push(e);if(e.subMenus){e.subMenus=j(e.subMenus)}return f},[]);if(o[0]&&o[0].type==="separator"){o.shift()}if(o[o.length-1]&&o[o.length-1].type==="separator"){o.pop()}return o}function l(){this.__className="sap.viz.controls.contextmenu.MenuModelGenerator";this._index={}}l.isSupport=g;l.prototype.merge=function(m,e,f,v,p){return j(m,this,e,f,v,p)};l.prototype.generate=function(n,f,i,v,p){var m=this,k;k=n.filter(function(e){if(e==="separator")return true;return g(e,v)}).map(function(e){var o=(m._index[e]||h[e]);if(!U.isFunction(o))return o;return o?o(e,f,i,v,p):null}).filter(function(e){return!!e});if(k[0]&&k[0].type==="separator")k.shift();if(k[k.length-1]&&k[k.length-1].type==="separator")k.pop();return k};l.prototype.put=function(i,e){this._index[i]=e};return l});define('sap/viz/controls/contextmenu/DefaultMenuItemHandlers',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/property/VizPropertyZone'],function(C,V,D,F,a,b,c){var i={"sap.viz.controls.contextmenu.item.title":function(d,e,v,p){var f=e.getProperties();var h=false;var m=0;if(f&&f.title){h=!f.title.visible;if(f.title.layout){if(h){m=1}else{m=0.1}}}var n={};n.title={};n.title.visible=h;if(!!m){n.title.layout={};n.title.layout.maxHeight=m}e.setProperties(n,{trigger:"CONTEXT_MENU"})},"sap.viz.controls.contextmenu.item.datalabels":function(d,e,v,p,m){var f;if(m&&m.hasOwnProperty('checked')){f=!m.checked}else{var h=e.getProperties();if(b.isInfoChart(v)){f=!h.plotArea.dataLabel.visible}else{f=!h.dataLabel.visible}}if(!b.isInfoChart(v)){var n={};if(b.isInfoChart(v)){n.plotArea={};n.plotArea.dataLabel={};n.plotArea.dataLabel.visible=f}else{n.dataLabel={};n.dataLabel.visible=f}e.setProperties(n,{trigger:"CONTEXT_MENU"})}else{var j={};j['textVisible']=f;if(f){j['dataLabelVisible']=f}var z=new c(c.DATA_LABEL);e.setPropertyZones([z]);var k=e.getPropertyZones();if(k){e.updateProperties({'propertyZones':k,'properties':j,'chartType':v},{trigger:"CONTEXT_MENU"})}}},"sap.viz.controls.contextmenu.item.direction":function(d,e,v,p){var f=d.type();var h=b.getDirection(f);if(h==C.DIRECTION_VERTICAL){h=C.DIRECTION_HORIZONTAL}else{h=C.DIRECTION_VERTICAL}var n=b.changeDirection(f,h);d.type(n)},"sap.viz.controls.contextmenu.item.legend":function(d,e,v,p){var f=e.getProperties();var h=false;if(f&&f.legend){h=!f.legend.visible}else if(f&&f.sizeLegend){h=!f.sizeLegend.visible}else if(f&&f.geomap){var l=f.geomap.layers;h=!l[0].options.legendVisible}var j=false;var k,m,n;if(f&&f.legendGroup&&f.legendGroup.layout&&f.legendGroup.layout.maxHeight!==undefined){j=true;var o=f.legendGroup.layout;k=o.position;if(h){if(o.position==='right'||o.position==='left'){m=null;maxWidth=0.2}else{m=0.2;maxWidth=null}}else{if(o.position==='right'||o.position==='left'){m=null;maxWidth=0}else{m=0;maxWidth=null}}}var q={};q.legend={};q.legend.visible=h;if(d.type().search('geo')>-1||d.type().search('bubble')>-1){q.sizeLegend={};q.sizeLegend.visible=h}if(j){q.legendGroup={};q.legendGroup.layout={position:k,maxHeight:m,maxWidth:maxWidth}}e.setProperties(q,{trigger:"CONTEXT_MENU"})},"sap.viz.controls.contextmenu.item.mbclegend":function(d,e,v,p){},"sap.viz.controls.contextmenu.item.mnd":function(d,e,v,p){var f=d.isMNDVisible();d.isMNDVisible(!f)},"sap.viz.controls.contextmenu.item.setAxisScale":function(d,e,v,p){var f=e.getProperties();if(b.isInfoChart(v)){p=null}else{var h=V.getValueAxis(v);if(!h||h.indexOf(p)===-1){p=null}}e.setAxisScale(p)},"sap.viz.controls.contextmenu.item.negative":function(d,e,v,p){var f=e.getProperties();f=f||{};f.plotArea=f.plotArea||{};var s=!f.plotArea.showNegativeValues;var n={};n.plotArea={};n.plotArea.showNegativeValues=s;e.setProperties(n)},"sap.viz.controls.contextmenu.item.stacking":function(d,e,v,p){var f=d.type();var s=b.getStacking(f);if(s==C.STACKING_NORMAL){s=C.STACKING_FULL}else{s=C.STACKING_NORMAL}var n=b.changeStacking(f,s);d.type(n)}};function g(d){return i[d]}return{get:g}});define('sap/viz/controls/contextmenu/ContextMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/contextmenu/ContextMenuEvent','sap/viz/controls/contextmenu/views/Menu','sap/viz/controls/contextmenu/MenuModelGenerator','sap/viz/controls/contextmenu/DefaultMenuItemHandlers'],function($,O,U,F,V,G,C,a,c,M,d,D){var f=function(b,u){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenu";this._div$=$(b);this._uiConfig=u?u:a.instance();this._uiConfig.contextMenuAssetFolderPath=G.defaultAssetsRoot()+'/common/assets';this._vizModelProvider=$.proxy(this._vizModel,this);this._vizProxyProvider=$.proxy(this._vizProxy,this);this._menu=new M();this._menuModelGenerator=new d();r(this)};O.extend(f,V);function l(b){if(!b){return b}if(b.charAt(37)==="."&&b.substring(0,38)==="sap.viz.controls.contextmenu.location."){return b.substring(38)}return b}function r(b){b.addEventListener("menuItemSelected",function(e){var i=D.get(e.data.menuItem.id);if(i){i(b._vizModelProvider(),b._vizProxyProvider(),e.data.vizType,l(e.data.location),e.data.menuItem)}if(e.data.menuItem.id==="sap.viz.controls.contextmenu.item.mbclegend"){b._dispatchEvent(new c("chooseLegendColors",b))}})}function g(b){var e=Array.prototype.slice.call(arguments,1);return function(){return b.apply(this,e.concat(Array.prototype.slice.call(arguments)))}}function h(b,i){var e=new c("menuItemSelected",b,i);b._dispatchEvent(e)}f.prototype._onVizModelChanged=function(e){};f.prototype.create=function(i,m){var v=C.getVizType(this._vizModel().type()),j=this,k,n;i=i||null;if(m){k=this._menuModelGenerator.merge(m,this._vizModelProvider,this._vizProxyProvider,v,l(i))}if(!k){n=this._uiConfig.menu.reduce(function(e,b){if(e.length>0){e.push("separator")}Array.prototype.push.apply(e,b);return e},[]);k=this._menuModelGenerator.generate(n,this._vizModelProvider,this._vizProxyProvider,v,l(i))}function t(k){return k.map(function(e){return{name:e.id,text:e.label,tooltip:e.tooltip,icon:e.icon&&e.icon.url,menuItemType:(U.isBoolean(e.checked)?"checked":e.type),checked:e.checked,disabled:(U.isBoolean(e.enabled)?!e.enabled:false),submenu:e.subMenus&&t(e.subMenus),click:g(h,j,{menuItem:e,vizType:v,location:i})}})}this._menu.create(t(k));return this};f.prototype.show=function(p){this._menu.setContainer(this._div$.parent().get(0));var v=C.getVizType(this._vizModel().type());var b=F.getVizFeeds(v);if(b){this._menu.show(p&&{left:p.pageX,top:p.pageY})}};f.prototype.hide=function(){this._menu.hide()};f.prototype.save=function(){var b={};return b};f.prototype.load=function(v){};f.prototype.addMenuItem=function(i,b){this._menuModelGenerator.put(i,b);this._addDefaultMenuItem(i)};f.prototype._addDefaultMenuItem=function(i){var b=this._uiConfig.menu.some(function(j){return j.some(function(e){return i===e})});if(!b){this._uiConfig.menu.push([i])}return!b};f.prototype.getEventNames=function(){var b=[c.MENU_ITEM_SELECTED,c.REQUEST_LEGEND_COLOR];return b};return f});define('sap/viz/controls/custombutton/CustomButtonConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{"visible":true,"title":"Button"}};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON,C);return C});define('sap/viz/controls/custombutton/CustomButtonEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButtonEvent"};O.extend(C,E);C.CLICK_CUSTOM_BUTTON="clickCustomButton";return C});define('sap/viz/controls/custombutton/CustomButton',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/custombutton/CustomButtonEvent'],function($,O,U,V,C,a,b){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButton";this._div=d;this._uiConfig=u?u:a.instance();this._button$=null;this._icon$=null;this._createChildren()};O.extend(c,V);c.prototype._createChildren=function(){if(!(this._uiConfig.visible===false)){this._button$=$(document.createElement("div")).appendTo(this._div);this._button$.addClass(C.CUSTOMBUTTON_PREFIX+"button");this._icon$=$(document.createElement("div")).appendTo(this._button$);if(this._uiConfig.title){this.setTitle(this._uiConfig.title)}var _=this;this._button$.click(function(e){var d=_._button$.offset();_._dispatchEvent(new b(b.CLICK_CUSTOM_BUTTON,_,d))})}};c.prototype.setIcon=function(i){if(arguments.length>0){this._icon$.removeAttr('class');this._icon$.addClass(i);return this}};c.prototype.setTitle=function(t){if(arguments.length>0){this._icon$.attr("title",t);return this}};return c});define('sap/viz/controls/common/VizControlHost',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/VizControlBase'],function(O,E,V){var a=function a(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlHost";this._children=[]};O.extend(a,V);a.prototype._onConnect=function(v){a.superclass._onConnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].connect(v)}};a.prototype._onDisconnect=function(){a.superclass._onDisconnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].disconnect()}};a.prototype._addChild=function(c,f,e){if(!c){return}this._children.push(c);var _=this;f&&f.forEach(function(n){_[n]=function(){return c[n].apply(c,arguments)}});e&&e.forEach(function(b){c.addEventListener(b,function(d){_._dispatchEvent(d)})})};a.prototype.destroy=function(){var c;while(c=this._children.shift()){try{c.destroy()}catch(e){}}a.superclass.destroy.apply(this,arguments)};return a});define('sap/viz/controls/filterbar0/FilterBarConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var F={};F.instance=function(){return{"module":{"visible":true}}};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FILTERBAR0,F);return F});define('sap/viz/controls/frame/VizFrameConfig',['sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/constants/ChartConst'],function(G,A,a,C,F,b,c,d){var V={};V.instance=function(){var r={"enableAnnotation":false,"enableAnnotationControl":false,"enableContextMenu":true,"enableFilterMenu":true,"enableFilterBar":true,"enableTitleEditor":true,"enableSettingButton":true,"enableFullScreenButton":true,"enablePlayControl":true,"enableResponsiveLegend":false,"useInfoChart":false,"useCustomizedContextMenu":false,"controls":{"chart":C.instance(),"filterBar":F.instance(),"contextMenu":b.instance(),"annotation":A.instance(),"annotationControl":a.instance(),"settingButton":c.instance(),"fullScreenButton":c.instance()}};return r};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FRAME,V);return V});define('sap/viz/controls/frame/VizFrameEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var V=function(t,a,d){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrameEvent"};O.extend(V,E);V.FILTERS_CHANGED="filtersChanged";V.CONTEXT_MENU_CHANGED='contextMenuChanged';V.ENTER_FULL_SCREEN="enterFullScreen";V.EXIT_FULL_SCREEN="exitFullScreen";V.ADD_COMMENT='addComment';V.ADD_FILTER='addFilter';V.REQUEST_LEGEND_COLOR='chooseLegendColors';V.POPUP_CHART_EDITOR='popupChartEditor';V.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";return V});define('sap/viz/controls/frame/chartEditor/ChartEditorEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments)};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F});define('sap/viz/controls/frame/chartEditor/ChartEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,L,O,U,a){var b=function(d,c){b.superclass.constructor.apply(this,arguments);this._dom$=$(d);this._createChildren(c)};O.extend(b,U);b.prototype._createChildren=function(c){var _=this;this._dom$.addClass(C.FRAME_PREFIX+'editor');var d=$('<div/>').appendTo(this._dom$);d.addClass(C.FRAME_PREFIX+'editor-main');d.addClass(C.COMMON_PREFIX+'popUp');var e=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-header');var f=$('<h3/>').appendTo(e).text(L.get("VIZ_FRAME_CHART_EDITOR"));var g=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-content');var h=$('<img/>').appendTo(g).addClass(C.FRAME_PREFIX+'editor-content-img');h.attr('src',c+'/chartEditorPH.png');var i=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-footer');var j=$('<button/>').appendTo(i).text(L.get("VIZ_COMMON_OK"));j.addClass(C.FRAME_PREFIX+'editor-footer-button');j.addClass(C.COMMON_PREFIX+'button');var k=$('<button/>').appendTo(i).text(L.get("VIZ_COMMON_CANCEL"));k.addClass(C.FRAME_PREFIX+'editor-footer-button');k.addClass(C.COMMON_PREFIX+'button');var l=$('<div/>').appendTo(d);l.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');l.addClass(C.FRAME_PREFIX+'editor-close');var m=function(){_._dispatchEvent(new a(a.EDIT_CANCELED,this));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach()};var n=function(){_._dispatchEvent(new a(a.EDIT_CONFIRMED,this,{}));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach()};j.click(n);k.click(m);l.click(m)};return b});define('sap/viz/controls/frame/chartEditor/ChartEditorPlugin',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/frame/chartEditor/ChartEditor','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,a,b){var c=function(d,v,u){this.__className="sap.viz.controls.frame.chartEditor.ChartEditorPlugin";this._vizFrame=v;this._uiConfig=u;this._div=d;this._chartEditor=null};c.prototype.validateSize=function(w,h){this._locateChartEditor()};c.prototype.destroy=function(){if(this._chartEditor){this._chartEditor.removeAllEventListeners();this._chartEditor.destroy();this._chartEditor=null}};c.prototype._popUpEditor=function(){var d=$(this._div);var e=this._uiConfig.chartEditorAssetFolderPath?this._uiConfig.chartEditorAssetFolderPath:'../src/controls/frame/assets';d.children().addClass(C.COMMON_PREFIX+'blur');var f=$(document.createElement('div')).appendTo(d);this._chartEditor=new a(f[0],e);this._locateChartEditor();this._chartEditor.addEventListener(b.EDITOR_CLOSED,function(g){d.children().removeClass(C.COMMON_PREFIX+'blur')})};c.prototype._locateChartEditor=function(){if(this._chartEditor){var d=$(this._div);var e=$(this._chartEditor._dom);e.css({'left':(d.width()-e.width())/2,'top':Math.min(120,(d.height()-e.height())/2)})}};return c});define('sap/viz/controls/common/constants/KeyboardEventConst',[],function(){var K={};K.UP=38;K.DOWN=40;K.ENTER=13;K.SPACE=32;K.ESC=27;K.SUBTRACT=45;K.DECIMAL=46;K.NUM_0=48;K.NUM_9=57;return K});define('sap/viz/controls/common/views/feed/FeedList',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/constants/KeyboardEventConst'],function($,C,u,O,U,F,L,A,a,b,K){var c=function(e,f,g,h){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedList";this._dom$=$(e);this._analyses=f;this._feedingType=g;this._dataProvider=[];var i,j;var k=function(m){for(var i=0;i<h.length;i++){if(h[i].id()===m){return true}}return false};if(f){for(i=0;i<f.length;i++){var l=f[i];if(k(l.id())){continue}if(b.feedCompatible(this._feedingType,l.type(),l.dataType())){this._dataProvider.push({'label':l.name(),'analysis':l})}}}this._header={'label':L.get(c.langProps[this._feedingType]),'suffix':this._dataProvider.length};this._container$=null;this._content$=null;this._header$=null;this._ul$=null;this._arrow$=null;this._createChildren();this._dock=null;this._calDockPosFun=null;this._resizeHandler=null;this._documentHandler=null;this._keyDownHandlerProvider=$.proxy(this._keyDownHandler,this);this._mouseMoveHandlerProvider=$.proxy(this._mouseMoveHandler,this)};O.extend(c,U);c.langProps={'Measure':'VIZ_COMMON_MEASURES','Dimension':'VIZ_COMMON_DIMENSIONS','Geography':'VIZ_COMMON_DIMENSIONS','Subtotal':'VIZ_COMMON_SUBTOTALS'};var S='down';var d='up';c.prototype.locate=function(e,o){var f=this._dom$;var g=this._ul$;var h=g.outerHeight();var i=Math.max($(document.body).height(),$(window).height());var m=i-this._header$.outerHeight()-15;if(h>m){h=m}g.outerHeight(h);var j=h+this._header$.outerHeight()+5;var k=Math.max(g.outerWidth(),this._header$.outerWidth());var l=this._arrow$.outerWidth();var n='left';if(o==='left'||o==='right'){n=o}else if(k+l*3/4>e.x){n='right'}var p=8;var q=this._arrow$.outerHeight()+18;var r=Math.max(0,e.y-i+q/2+p);e.y=Math.min(e.y,i-q/2-p);var t=Math.max(e.y-r+q/2+p-j,5);var s=Math.min(e.y-t-12,i-q-p-t-r);var v=2;if(n==='right'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-right');f.css({"left":e.x+e.shelfWidth+l*3/4,"top":t});this._arrow$.css({"left":-l/2+v,"top":s})}else if(n==='left'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-left');f.css({"left":e.x-k-l*3/4,"top":t});this._arrow$.css({"left":k-l/2-v,"top":s})}this._content$.css({'width':k+'px','height':j+'px'});this._container$.css({'width':k+2+'px','height':j+'px'})};c.prototype.open=function(e){if(typeof(e)==='function'){this._dock=e();this._calDockPosFun=e}else{this._dock=e}var f=this._dom$;f.appendTo($("body"));this._dispatchEvent(new F(F.DROP_DOWN_OPENED,this));this.locate(this._dock);this._documentHandler=$.proxy(function(g){if(!$.contains(this._dom,g.target)){this.close()}},this);this._addEventListeners();document.addEventListener("mousedown",this._documentHandler,true);document.addEventListener("keydown",this._keyDownHandlerProvider,true);$(window).on('blur',this._documentHandler);this._cursorShowed=true};c.prototype.close=function(){var e=this._dom$;var f=1;if(this._classVisible){e.removeClass(this._classVisible);f=2000}setTimeout(function(){e.detach()},f);document.removeEventListener("mousedown",this._documentHandler,true);document.removeEventListener("keydown",this._keyDownHandlerProvider,true);document.removeEventListener("mousemove",this._mouseMoveHandlerProvider,true);$(window).off('blur',this._documentHandler);$(window).off('resize',this._resizeHandler);this._dispatchEvent(new F(F.DROP_DOWN_CLOSED,this));if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor')}this._calDockPosFun=null;this.destroy()};c.prototype._createChildren=function(e){this._dom$.addClass(C.COMMON_PREFIX+'feedlist');var _=this;var f=this._container$=$(document.createElement('div')).appendTo(this._dom$);f.addClass(C.COMMON_PREFIX+'feedlist-container');var g=this._arrow$=$(document.createElement('div')).appendTo(f);g.addClass(C.COMMON_PREFIX+'feedlist-arrow');g.addClass(C.PREFIX+'feedlist');var h=this._content$=$(document.createElement('div')).appendTo(f);h.addClass(C.COMMON_PREFIX+'feedlist-content');var j=this._header$=$(document.createElement('div')).appendTo(h).text(this._header.label);j.addClass(C.COMMON_PREFIX+'feedlist-content-header');var k=this._ul$=$(document.createElement('ul')).appendTo(h);k.addClass(C.COMMON_PREFIX+'scrollable');k.addClass(C.COMMON_PREFIX+'scrollable-y');var i;var l;for(i=0;i<this._dataProvider.length;i++){var m=$(document.createElement('li')).appendTo(k);var n=$(document.createElement('a')).appendTo(m);l=this._dataProvider[i];var o,p;var q=l.analysis.dataType();var r=b.isGeoHierarchyFeed(this._feedingType,l.analysis.type(),q);if(((this._feedingType===a.DIMENSION||this._feedingType===a.SUBTOTAL)&&l.analysis.type()===A.HIERARCHY)||r){var s=this._setHierarchyAnalysis(l.analysis.clone(),0);m.data('__item',s);o=$(document.createElement('div')).appendTo(m);o.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');p=$(document.createElement('div')).appendTo(o);p.addClass(C.COMMON_PREFIX+'UVBSharedSprite');if(q&&q.toLowerCase()===a.GEOGRAPHY.toLowerCase()){p.addClass(C.COMMON_PREFIX+'geography')}else{p.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-Icon')}var t=$(document.createElement('div')).appendTo(m);t.data('__items',l.analysis);t.addClass(C.COMMON_PREFIX+'feedlist-li-button');var v=$(document.createElement('div')).appendTo(t);v.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-plus-icon');t.attr('command','open');t.click(function(w){w.stopPropagation();_._expandButtonHandler(w)});m.click($.proxy(this._analysisSelectedHandler,this))}else{if(q&&q.toLowerCase()===a.GEOGRAPHY.toLowerCase()){o=$(document.createElement('div')).appendTo(m);o.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');p=$(document.createElement('div')).appendTo(o);p.addClass(C.COMMON_PREFIX+'geography')}m.data('__item',l.analysis);m.click($.proxy(this._analysisSelectedHandler,this))}m.hover($.proxy(function(w){this._highlightItem($(w.currentTarget))},this),$.proxy(function(w){this._unhighlightItem($(w.currentTarget))},this));n.text(l.label);n.addClass(C.COMMON_PREFIX+'text-ellipsis');if(l.suffix){n.addClass(C.COMMON_PREFIX+'feedlist-li-a_suffix').attr('__suffix',l.suffix)}if(l.icon){}}};c.prototype._expandButtonHandler=function(e){var f=$(e.currentTarget);if(f.attr('command')==='open'){this._openHierarchyItem(f)}else{this._closeHierarchyItem(f)}};c.prototype._setHierarchyAnalysis=function(h,i){var e=h.hierarchyLevels();for(var j=0;j<e.length;j++){var l=e[j];if(j===i){l.selected(true)}else{l.selected(false)}}return h};c.prototype._analysisSelectedHandler=function(e){var _=this;var l=$(e.currentTarget);var i=l.data('__item');_._dispatchEvent(new F(F.ITEM_SELECTED,_,{'selectedItem':i}));_.close()};c.prototype._keyDownHandler=function(e){var k=e.keyCode;if(!e.ctrlKey&&(k===K.DOWN||k===K.UP)){if(this._cursorShowed){$("*").addClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=false;setTimeout($.proxy(function(){document.addEventListener('mousemove',this._mouseMoveHandlerProvider,true)},this),200)}}var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);switch(k){case K.UP:if(e.ctrlKey){var m=$('.'+C.COMMON_PREFIX+'feedlist-li-minus-icon',l);if(m[0]){this._closeHierarchyItem(m.parent())}}else if(l[0]!=this._ul$[0].firstChild){this._unhighlightItem(l);this._highlightItem(l.prev());if(l.offset().top-this._ul$.offset().top<l.height()){this._updateScrollBarPosition(l,d)}}break;case K.DOWN:if(e.ctrlKey){var p=$('.'+C.COMMON_PREFIX+'feedlist-li-plus-icon',l);if(p[0]){this._openHierarchyItem(p.parent())}}else{if(!l[0]){this._highlightItem($(this._ul$[0].firstChild))}else if(l[0]!=this._ul$[0].lastChild){this._unhighlightItem(l);this._highlightItem(l.next());if(l.offset().top+l.height()>this._ul$.offset().top+this._ul$.height()){this._updateScrollBarPosition(l,S)}}}break;case K.ENTER:case K.SPACE:if(l[0]){this._selectItem(l)}break;case K.ESC:this.close();break}};c.prototype._validateSize=function(){if(!!this._calDockPosFun&&typeof(this._calDockPosFun)==='function'){this.locate(this._calDockPosFun())}};c.prototype._resizer=function(e){var _=this;if(!e.data.invalidateSize){setTimeout(function(){e.data.invalidateSize=false;_._validateSize()},1000/24)}e.data.invalidateSize=true};c.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({'invalidateSize':false},this._resizeHandler)};c.prototype._mouseMoveHandler=function(e){if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=true;document.removeEventListener('mousemove',this._mouseMoveHandlerProvider,true);var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);this._unhighlightItem(l)}};c.prototype._highlightItem=function(l){l.addClass(C.COMMON_PREFIX+'feedlist-li-highlight')};c.prototype._unhighlightItem=function(l){l.removeClass(C.COMMON_PREFIX+'feedlist-li-highlight')};c.prototype._selectItem=function(l){var i=l.data('__item');this._dispatchEvent(new F(F.ITEM_SELECTED,this,{'selectedItem':i}));this.close()};c.prototype._openHierarchyItem=function(e){var f=e.data('__items');var h=f.hierarchyLevels();var g=e.parent();for(var i=0;i<h.length;i++){var l=$(document.createElement('li'));$(g).after(l);g=l;var s=$(document.createElement('span')).appendTo(l);var j=this._setHierarchyAnalysis(f.clone(),i);l.data('__item',j);s.text(h[i].name());s.addClass(C.COMMON_PREFIX+'text-ellipsis');l.click($.proxy(this._analysisSelectedHandler,this));l.hover($.proxy(function(k){this._highlightItem($(k.currentTarget))},this),$.proxy(function(k){this._unhighlightItem($(k.currentTarget))},this))}e.attr('command','close');e.addClass(C.COMMON_PREFIX+'feedlist-li-button-close');e.children().attr('class',C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-minus-icon');this._updateAllExpandButtons()};c.prototype._closeHierarchyItem=function(e){var f=e.data('__items');var h=f.hierarchyLevels();for(var j=0;j<h.length;j++){e.parent().next().remove()}e.attr('command','open');e.removeClass(C.COMMON_PREFIX+'feedlist-li-button-close');e.children().attr('class',C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-plus-icon');this._updateAllExpandButtons()};c.prototype._updateAllExpandButtons=function(){var h=this._ul$[0].scrollHeight>this._ul$.outerHeight();$('.'+C.COMMON_PREFIX+'feedlist-li-button').each(function(){$(this).removeClass(C.COMMON_PREFIX+'feedlist-li-button-offset');if(h){$(this).addClass(C.COMMON_PREFIX+'feedlist-li-button-offset')}})};c.prototype._updateScrollBarPosition=function(l,e){var f=this._ul$.scrollTop();if(e===S){var n=l.nextAll();var g=l.height()*n.length;if(g<=this._ul$.height()){f+=g}else{f+=(this._ul$.scrollHeight()/l.height())}}else{var p=l.prevAll();var h=l.height()*p.length;if(h<=this._ul$.height()){f=0}else{f-=(this._ul$.scrollHeight()/l.height())}}this._cursorShowed=true;this._ul$.scrollTop(f);setTimeout($.proxy(function(){this._cursorShowed=false},this),500)};return c});define('sap/viz/controls/filterbar0/Tooltip',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function($,C,A,L){var d=1000;var o={x:8,y:16};var T=function(a){this._div=a;this._showing=false;this._tooltip$=null};T.prototype._getTitle=function(f){if(f.getType()!==A.VALUE_TYPE){return f.filterTitle()}var c=f.values().length;var t=f.filterName()+' ('+c+' ';if(f.isExcluded()){t+=L.get('VIZ_FILTERBAR_ITEMS_EXCLUDED')}else{t+=L.get('VIZ_FILTERBAR_ITEMS_INCLUDED')}t+=')';return t};T.prototype._showTooltip=function(f){if(!this._showing){return}if(!this._tooltip$){this._tooltip$=$(document.createElement('div')).appendTo(this._div)}else{this._tooltip$.empty()}var t=this._tooltip$;t.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip');if(f.isGlobalFilter()){var g=L.get('VIZ_FILTERBAR_GLOBAL_FILTER');var a=$(document.createElement('span')).appendTo(t).text(g);a.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-globalfilter')}var b=$(document.createElement('span')).appendTo(t).text(this._getTitle(f));b.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-title');var c=$(document.createElement('span')).appendTo(t);c.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-value');if(f.isExcluded()){c.addClass(C.FILTERBAR0_PREFIX+'filter-exclude')}c.text(f.filterContent());var m=15*15;while(c.height()>m){c.text(c.text().replace(/(\s)*([a-zA-Z0-9]+|\W)(\.\.\.)?$/,"..."))}var l=this._position.left+o.x;var r=this._div.offset().left+this._div.outerWidth();l=Math.min(l,r-t.outerWidth());t.offset({"left":l,"top":this._position.top+o.y})};T.prototype.show=function(f,p){this._position=p;if(this._showing){return}this._showing=true;var _=this;setTimeout(function(){_._showTooltip(f)},d)};T.prototype.position=function(p){this._position=p};T.prototype.hide=function(){this._showing=false;if(this._tooltip$){this._tooltip$.remove();this._tooltip$=null}};return T});define('sap/viz/controls/filterbar0/FilterBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBarEvent"};O.extend(F,E);F.DELETE_FILTER="deleteFilter";F.HEIGHT_CHANGED="heightExtend";return F});define('sap/viz/controls/filterbar0/FilterBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/filterbar0/Tooltip','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/filterbar0/FilterBarEvent'],function($,V,C,E,a,D,L,O,U,b,F,c,A,d,R,f,g,N,h,j,T,k,l){var m=function(e,u){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');this._div=e;this._uiConfig=u?u:k.instance();this._containerCurrentPosition=0;this._allAnalyses=null;this._settings=null;this._visualLines=2;this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._tooltip=new T(this._div);this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control')};var n=0.8;var o=40;var p=190;O.extend(m,V);m.TYPE_STRING='string';m.TYPE_INTEGER='integer';m.TYPE_NUMBER='number';m.TYPE_DATE='date';var I=16;m.prototype.filterItems=function(e){if(arguments.length>0){this._vizModel().filterItems(e);return this}else{return this._vizModel().filterItems()}};m.prototype.save=function(){var e={};e['filterItems']=j.toJSON(this._vizModel().filterItems());return e};m.prototype.load=function(v){var e=null;if(v&&v.filterItems){e=j.fromJSON(v.filterItems)}e=e||[];this._vizModel().filterItems(e)};m.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){this._filtersChanged()}};m.prototype._createChildren=function(){var _=this;var q=this._uiConfig.module;if(q&&!(q.visible===false)){this._headerVisible=true;this._plus$=$(document.createElement("div")).appendTo(this._div);this._plus$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._plus$.addClass(C.FILTERBAR0_PREFIX+'header-plus');this._plus$.click(function(e){_._plusClickHandler(e)});var r=q.label?q.label:L.get('VIZ_FILTERBAR_DESCRIPTION');this._description$=$(document.createElement("span")).text(r).appendTo(this._div);this._description$.addClass(C.FILTERBAR0_PREFIX+"description")}this._layout$=$(document.createElement('div')).appendTo(this._div);this._layout$.addClass(C.FILTERBAR0_PREFIX+'layout');this._layout$.addClass(C.COMMON_PREFIX+'scrollable');this._layout$.addClass(C.COMMON_PREFIX+'scrollable-y');this._layout$.css({'max-height':this._visualLines*o});this._filterItemsContainer$=$(document.createElement('div')).appendTo(this._layout$);this._filterItemsContainer$.addClass(C.FILTERBAR0_PREFIX+'filterItems-container');if(this._headerVisible===true){this._layout$.hide()}else{this._layout$.css({'left':'0px'})}$(this._div).droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,over:$.proxy(this._dragOver,this),out:$.proxy(this._dragOut,this),drop:$.proxy(this._drop,this)})};m.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};m.prototype._plusClickHandler=function(e){var q=document.createElement('div');var r=this._getExcludeGlobalFilter(this._vizModel().filterItems());var s=new F(q,this._allAnalyses,d.DIMENSION,r);s.addEventListener(c.ITEM_SELECTED,function(u){var v=u.data.selectedItem;if(v){this._addFilterItem(v)}},this);var t=this._plus$.offset();s.open({x:t.left,y:t.top,shelfWidth:this._plus$.width()})};m.prototype._getExcludeGlobalFilter=function(e){var q=[];if(e){for(i=0;i<e.length;i++){if(e[i].isGlobalFilter()==false){q.push(e[i])}}}return q};m.prototype._getDroppableAnalysisObject=function(t){if(!t||!t.analysisObject){return null}var e=t.analysisObject;var q=e.type();var r=j.getFilterInfo(e);if(A.compatible(A.DIMENSION,q)&&!j.isFilterItemExisted(this._vizModel(),r.id,r.hierarchyLevelId)&&q!==A.MND){return e}else{return null}};m.prototype._dragOver=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return}var q=this._getDroppableAnalysisObject(t);if(q){t.currentAction(b.ACCEPT_AS_COPY)}else{t.currentAction(b.DENY)}};m.prototype._dragOut=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(t){t.currentAction(b.DENY)}};m.prototype._drop=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return}var q=this._getDroppableAnalysisObject(t);if(q){t.currentAction(b.ACCEPT_AS_COPY);this._addFilterItem(q)}else{t.currentAction(b.DENY)}t.dropTarget(this._dom)};m.prototype._addFilterItem=function(e){var q=j.getFilterInfo(e);var r=q.name;var s=q.id;var t=e.dataType();var u;switch(t){case m.TYPE_INTEGER:case m.TYPE_NUMBER:u=new N(s,r);break;case m.TYPE_DATE:u=new g(s,r);break;case m.TYPE_STRING:default:u=new h(s,r);if(q.hierarchyLevelId){u.hierarchyLevelId=q.hierarchyLevelId}break}var v=this._vizModel().filterItems();v.push(u);this._vizModel().filterItems(v);this._dispatchRequestFilterEvent(u)};m.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty()}var e=this._vizModel().filterItems();if(!e||e.length==0){this._updateDescription();return this}if(this._headerVisible===true){this._description$.hide();this._layout$.show()}this._updateFilterItemContainer()};m.prototype._dispatchRequestFilterEvent=function(e){var _=this;var v=function(s){var t=_._vizModel().filterItems();if(e.isEmpty()){var u=t.indexOf(e);if(u>=0){t.splice(u,1);_._vizModel().filterItems(t);_._tooltip.hide()}return}if(s){_._vizModel().filterItems(t)}};var q=$('#'+e.id(),this._filterItemsContainer$);var r={bounds:R.toJSON(R.parseDOM(q)),filterName:e.filterName(),analysisObjectId:e.analysisObjectId(),filterItem:e,validate:v};this._dispatchEvent(new a(E.REQUEST_FILTER_VALUES,this,r))};m.prototype._createFilterTitle=function(e,q){if(e.getType()!==f.VALUE_TYPE){var r=$(document.createElement('span')).appendTo(q).text(e.filterTitle());r.addClass(C.FILTERBAR0_PREFIX+'filter-item-text');r.addClass(C.FILTERBAR0_PREFIX+'range-filter-item-text');return}var t=$(document.createElement('div')).appendTo(q);var s=$(document.createElement('div')).appendTo(t).text(e.filterName()).css("display",'inline');s.addClass(C.FILTERBAR0_PREFIX+'filter-item-text').attr('id','filterName');var u=$(document.createElement('div')).appendTo(t).css("display",'inline').attr('id','countInfo');u.addClass(C.FILTERBAR0_PREFIX+'filter-item-info');$(document.createElement('span')).appendTo(u).text('(');var v=$(document.createElement('span')).appendTo(u).text(e.values().length);if(e.isExcluded()){v.addClass(C.FILTERBAR0_PREFIX+'filter-exclude')}$(document.createElement('span')).appendTo(u).text(')')};m.prototype._createFilterItem=function(q){var r=q.filterName();var _=this;var s=document.createElement('div');var t=$(s).appendTo(this._filterItemsContainer$);this._createFilterTitle(q,t);if(q.isGlobalFilter()){t.attr({'id':'GLOBAL-'+q.id()});t.addClass(C.FILTERBAR0_PREFIX+'global-filter-item')}else{t.attr({'id':q.id()});t.addClass(C.FILTERBAR0_PREFIX+'filter-item');t.click(function(){_._dispatchRequestFilterEvent(q)});var u=$(document.createElement('div')).appendTo(t);u.addClass(C.FILTERBAR0_PREFIX+'delete-icon');u.addClass(C.COMMON_PREFIX+'UVBSharedSprite');u.click(function(e){_._removeFilterItem(q);_._dispatchEvent(new l(l.DELETE_FILTER,_));_._tooltip.hide();e.stopPropagation()})}return t};m.prototype._stringToNumber=function(v){if(!v){return 0}return parseInt(v.replace('px',''))};m.prototype.validateSize=function(){var e=this._filterItemsContainer$.children();if(e.length==0){return this}e.css({'width':p});this._updateFilterItemsWidth()};m.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var q=e>o;if(q){return true}else{return false}};m.prototype._updateFilterItemContainer=function(){var e=this._vizModel().filterItems();var i;for(i=0;i<e.length;i++){this._createFilterUI(e[i])}this._updateFilterItemsWidth();return this};m.prototype._createFilterUI=function(e){var q=e.filterName();var r;var _=this;r=this._createFilterItem(e);r.mouseover(function(s){_._tooltip.show(e,{left:s.clientX,top:s.clientY});$('.'+C.FILTERBAR0_PREFIX+'filter-values',s.currentTarget).addClass(C.FILTERBAR0_PREFIX+'filter-values-active')});r.mousemove(function(s){_._tooltip.position({left:s.clientX,top:s.clientY})});r.mouseout(function(s){_._tooltip.hide();$('.'+C.FILTERBAR0_PREFIX+'filter-values',s.currentTarget).removeClass(C.FILTERBAR0_PREFIX+'filter-values-active')});this._addFilterValues(e,r)};m.prototype._updateFiltersTitle=function(){var u=function(e,q){var r=$('#filterName',q);if(r.length===0){return}r.css({'width':'auto'});var t=r.parent();var s=$('#countInfo',q);var v=r.position();var w=r.width()+v.left+2;var x=t.width()-I;var y=s.width();var z=Math.min(w,x-y);r.css({'width':z-v.left});s.css({'left':z})};$('.'+C.FILTERBAR0_PREFIX+'filter-item',this._div).each(u);$('.'+C.FILTERBAR0_PREFIX+'global-filter-item',this._div).each(u)};m.prototype._updateFilterItemsWidth=function(){var e;if(this._filterItemsContainer$.children().length===0){this._updateDescription();return this}if(!this._needAdjust()){e={'height':o};this._dispatchEvent(new l(l.HEIGHT_CHANGED,this,e));this._updateFiltersTitle();return this}var q=0;while(this._needAdjust()&&q<2){q++;var r=$('.'+C.FILTERBAR0_PREFIX+'filter-item');var w=$($('.'+C.FILTERBAR0_PREFIX+'filter-item')[0]).outerWidth()*n;r.css({'width':w})}if(this._needAdjust()){e={'height':this._avaliableHeightForHeader()};this._dispatchEvent(new l(l.HEIGHT_CHANGED,this,e));if(e.height<this._filterItemsContainer$.outerHeight()){$(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight())}}if(!this._needAdjust()){e={'height':o};this._dispatchEvent(new l(l.HEIGHT_CHANGED,this,e))};this._updateFiltersTitle();return this};m.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var q=o-2;var r=o;var s=this._visualLines-1;for(var i=2;i<=this._visualLines;i++){if(q*i<=e&&e<=r*i){s=i-1;break}}var t=2;return s*q+r+t};m.prototype._addFilterValues=function(e,q){var v=e.filterContent();var r=q.find("span[id='values']");if(r.length===0){r=$(document.createElement('span')).appendTo(q);r.addClass(C.FILTERBAR0_PREFIX+'filter-values');r.attr({id:'values'})}r.text(v);var s=C.FILTERBAR0_PREFIX+'filter-exclude';if(e.isExcluded()){r.addClass(s)}else{r.removeClass(s)}};m.prototype._removeFilterItem=function(e){var q=this._vizModel().filterItems().slice(0);var r=q.indexOf(e);q.splice(r,1);this._vizModel().filterItems(q);return q};m.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide()}};return m});define('sap/viz/controls/frame/views/FilterMenuEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenuEvent"};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F});define('sap/viz/controls/frame/views/FilterMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/views/FilterMenuEvent'],function($,O,U,C,L,F){var a=function(d,u){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenu";this._div=d;this._uiConfig=u;this._container=null;this._createChildren()};O.extend(a,U);a.prototype._createChildren=function(){this._container=$(document.createElement('div')).appendTo(this._div);$(this._container).addClass(C.FRAME_PREFIX+"filtermenu");var b=$(document.createElement('div')).appendTo(this._container);var f=$(document.createElement('div')).appendTo(b);f.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');f.addClass(C.FRAME_PREFIX+'filtermenu-filter-icon');var c=$(document.createElement('div')).appendTo(b);c.text(L.get('VIZ_FRAME_FILTERMENU_FILTER'));b.click($.proxy(function(){this._dispatchEvent(new F(F.FILTER_CLICKED),this)},this));var d=$(document.createElement('div')).appendTo(this._container);var e=$(document.createElement('div')).appendTo(d);e.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');e.addClass(C.FRAME_PREFIX+'filtermenu-exclude-icon');var g=$(document.createElement('div')).appendTo(d);g.text(L.get('VIZ_FRAME_FILTERMENU_EXCLUDE'));$(d).click($.proxy(function(){this._dispatchEvent(new F(F.EXCLUDE_CLICKED),this)},this))};a.prototype.show=function(s,b){if(s||b){$(this._container).css({bottom:2+'px','visibility':'visible','display':'block'});$(this._container).show()}else{$(this._container).hide()}};a.prototype.hide=function(){$(this._container).hide()};a.prototype.size=function(s){$(this._container).css({left:(s.width-$(this._container).outerWidth())/2+'px'})};return a});define('sap/viz/controls/common/utils/OSUtil',[],function(){function _(){return undefined!==document.documentElement.style.webkitBoxAlign}function a(){return!!window.XDomainRequest}function b(){return!!window.chrome}function c(){return(undefined!==document.documentElement.style.MozBoxAlign)&&("Gecko"===navigator.product)}function d(){return(/javafx\//i).test(window.navigator.userAgent)}function e(){return _()&&!b()}function f(){return(undefined!==window.navigator.standalone)&&_()&&!b()}return{isIE:a,isChrome:b,isFirefox:c,isJavaFx:d,isSafari:e,isSafariMobile:f,isWebkit:_}});define('sap/viz/controls/chart/views/TitleContextMenu',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','jquery'],function(O,a,U,C,$){var b=function(d,i){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleContextMenu";this._div=d;this._menu=null;this._visible=true;this._shown=false;this._cusMenuItems=i;this._createContextMenu();this._mousedownHandler=$.proxy(this._handleMousedownEvent,this)};O.extend(b,U);b.prototype._createContextMenu=function(){var _=this;this._menu=document.createElement('div');$(this._menu).addClass(C.PREFIX+'contextmenu');$(this._div).append(this._menu);this.hide();this._ul=document.createElement('ul');$(this._ul).addClass([C.CONTEXTMENU_PREFIX+'list',C.CONTEXTMENU_PREFIX+'list-hovered'].join(' '));$(this._ul).appendTo(this._menu)};var E=[];b.prototype._getCusMenuItem=function(n){if(this._cusMenuItems&&this._cusMenuItems.length>0){for(var i=0;i<this._cusMenuItems.length;i++){var m=this._cusMenuItems[i];if(m.name===n){return m}}}return null};b.prototype.updateMenu=function(){var v=[];$(this._ul).empty();for(var i=0;i<this._cusMenuItems.length;i++){var c=this._cusMenuItems[i];this._createMenuItemUI(c)}};b.prototype._createMenuItemUI=function(c){var t=c.text;var e={};e.clickHandler=c.clickHandler;e.scope=c.scope;var d=c.enableValidator.apply(c.scope);var i=c.name;var l=document.createElement('li');var m=document.createElement('div');$(l).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(m).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(l).appendTo(this._ul);$(m).appendTo(l);var T=$("<div>",{"class":C.CONTEXTMENU_PREFIX+"MnuItmTxt"});$(T).appendTo(m);$(T).text(t);if(d){$(T).css("color","black")}else{$(T).css("color","grey")}m.id=i;var _=this;if(d){$(m).click(function(f){if(e.clickHandler){e.clickHandler.apply(e.scope)}_.hide()})}else{$(m).click(function(f){_.hide()})}};b.prototype.isShown=function(){return this._shown};b.prototype.show=function(o){this.updateMenu();if(o&&o.position){var p=$(this._div).innerWidth();var m=$(this._menu).outerWidth();var l=o.position.pageX;if(p<m+l){l=p-m}var t=o.position.pageY;var c=$(this._div).parent().innerHeight();var d=$(this._menu).outerHeight();if(c<d+t){t=c-d}t+=$(this._div).parent().offset().top;if(l<0){l=$(this._div).parent().offset().left}else{l+=$(this._div).parent().offset().left}$(this._menu).css({position:"fixed",left:l+"px",top:t+"px"})}$(this._menu).css('visibility','visible');this._shown=true;document.removeEventListener("mousedown",this._mousedownHandler,true);$(window).off('blur',this._mousedownHandler);document.addEventListener("mousedown",this._mousedownHandler,true);$(window).on('blur',this._mousedownHandler)};b.prototype._handleMousedownEvent=function(e){var i=e.target.id;if(a.isIE()&&i==""){i=e.target.parentNode.id}var c=this._getCusMenuItem(i);if(c){return}this.hide()};b.prototype.hide=function(){$(this._menu).find('*').removeData().off();$(this._menu).css('visibility','hidden');this._shown=false};return b});define('sap/viz/controls/chart/views/TitleEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/chart/views/TitleContextMenu','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/chart/Chart'],function($,C,O,a,E,V,R,T,L,b,c){var d=function(e,u){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleEditor";this._targetDiv=e;this._uiconfig=u;this._editing=false;this.createChildren()};O.extend(d,V);d.prototype.createChildren=function(){var p=this._targetDiv;this._div=$(document.createElement("DIV"));this._textInput=$('<input type="text" spellcheck="false"/>');this._textInput.addClass(C.CHART_PREFIX+'title-text');this._textInput.attr('value',this._vizProxy().getTitleText());this._settingBtn=$(document.createElement("div"));this._settingBtn.addClass(C.CHART_PREFIX+'title-button');var s=$(document.createElement("div")).appendTo(this._settingBtn);s.addClass(C.COMMON_PREFIX+"UVBSharedSprite");s.addClass(C.CHART_PREFIX+"setting-icon");this._settingBtn.hide();var m=[{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_EDIT'),name:'edit',clickHandler:this.enterEditMode,enableValidator:function(){return true},scope:this},{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE'),name:'restore',clickHandler:this.restore,enableValidator:function(){return this.edited()},scope:this}];this._contextMenu=new T(p,m);this._div.append(this._textInput).append(this._settingBtn).appendTo(p);var _=this;document.addEventListener("mousedown",function(e){_._documentMouseDownHandler(e)},true);this._settingBtn.click(function(e){_._popupContextMenu()});this._div.bind("mouseover",function(){_.mouseOver()}).bind("mouseout",function(){_.mouseOut()}).bind("dblclick",function(){_.dblClick()}).bind('keypress',function(e){if(e.keyCode==13){_._documentKeyPressHandler(e);e.preventDefault()}})};d.prototype.editable=function(){return!this._vizProxy().isFakeChart()};d.prototype.edited=function(){return this._vizProxy().isTitleCustomized()};d.prototype.restore=function(){this._editing=false;this._vizProxy().setTitleMode(c.VIZ_TITLE_MODE.auto);this._vizProxy().restoreTitleText()};d.prototype.enterEditMode=function(){if(this.editable()){this._settingBtn.hide();this._editing=true;this._layoutTitleDiv();this._textInput.css({'display':'block'});this._textInput.val(this._vizProxy().getTitleText());this._textInput.focus().select()}};d.prototype._layoutTitleDiv=function(){var e=this._vizProxy().getTitleZone();if(e&&e.length>0){var s=this._targetDiv.scrollLeft();var l=e[0][0],t=e[0][1],w=e[2][0]-e[0][0],h=e[2][1]-e[0][1];var f="position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;";if(this._editing){var p=8;f+="left:"+s+"px;top:"+(t-p)+"px;width:100%;"+"height:"+(h+p*2)+"px;";this._div.addClass(C.CHART_PREFIX+'title-edit')}else{f+="left:"+l+"px;top:"+t+"px;width:"+(w+16)+"px;height:"+h+"px;";if(a.isIE()){f+="background-color:rgba(0,0,0,0)"}this._div.removeClass(C.CHART_PREFIX+'title-edit')};this._div.attr('style',f)}};d.prototype.init=function(){if(b.supportTitle(this._vizModel().type())){this.size();this._show()}else{this._hide()}};d.prototype._show=function(){this.show()};d.prototype._hide=function(){this.hide()};d.prototype.dblClick=function(){if(this.editable()&&!this._editing){this.enterEditMode()}};d.prototype._popupContextMenu=function(){var e=this._vizProxy().getTitleZone();var l=e[0][0],t=e[0][1],w=e[2][0]-e[0][0],h=e[2][1]-e[0][1];var o=95;var p={pageX:l+w-o-this._targetDiv.scrollLeft(),pageY:t+h-this._targetDiv.scrollTop()};this._contextMenu.show({position:p})};d.prototype.mouseOver=function(){var t=this._vizProxy().getProperties().title||{visible:true};if(this.editable()&&!this._editing&&t.visible){this._layoutTitleDiv();this._settingBtn.show()}};d.prototype.mouseOut=function(){if(this.editable()&&!this._editing){this._layoutTitleDiv();if(a.isIE()){this._div.css({'border-width':'0px','background-color':'rgba(0,0,0,0)'})}else{this._div.css({'border-width':'0px','background-color':'transparent'})}this._textInput.css({'display':'none'});this._textInput.blur();if(!this._contextMenu.isShown()){this._settingBtn.hide()}}};d.prototype._documentMouseDownHandler=function(e){if(this._editing&&e.target!==this._textInput[0]){this._commitTitleEdit();e.stopPropagation()}if(this._contextMenu.isShown()&&e.target!=this._settingBtn[0]&&e.target.parentElement!=this._settingBtn[0]){this._settingBtn.hide()}if(!this._editing&&e.which===3&&e.target===this._div[0]){this._div.hide()}};d.prototype._documentKeyPressHandler=function(e){if(this._editing&&e.target===this._textInput[0]){this._commitTitleEdit();e.stopPropagation()}};d.prototype._onVizModelChanged=function(){this.init()};d.prototype._commitTitleEdit=function(){this._editing=false;var t=this._textInput[0].value;if(t!=this._vizProxy().getTitleText()){this._vizProxy().setTitleMode(c.VIZ_TITLE_MODE.manual);this._vizProxy().setTitleText(t)}this.mouseOut()};d.prototype.size=function(){this._layoutTitleDiv();if(this._contextMenu.isShown()){this._popupContextMenu()}};d.prototype.load=function(){this.init()};return d});define('sap/viz/controls/playcontrol/PlayControlEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControlEvent"};O.extend(P,E);P.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";P.UPDATE_CHART_COMPLETE="updateChartComplete";return P});define('sap/viz/controls/playcontrol/PlayControl',["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/playcontrol/PlayControlEvent",'sap/viz/controls/common/feeds/AnalysisObject',"sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/constants/ChartConst"],function($,V,G,C,O,P,A,U,F,a){var b=0,c=1,d=2,D=1,f=1000,g="/controls/playcontrol/assets/paused.svg",k="/controls/playcontrol/assets/inprogress.svg",L=48;var l=function(p){this._player=p;this._t=null;this._lastUpdateTstmp=0};l.prototype._playerUpdateHandler=function(){if(this._player){var t=(new Date()).getTime();if(t-this._lastUpdateTstmp>=f){this._player._progressing();this._lastUpdateTstmp=t}else{if(!this._t){this._t=setTimeout($.proxy(function(){clearTimeout(this._t);this._t=null;this._playerUpdateHandler()},this),t-this._lastUpdateTstmp)}}}};l.prototype.start=function(){this._player._start();if(!this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.addEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)}this._playerUpdateHandler()};l.prototype.pause=function(){if(this._t){clearTimeout(this._t);this._t=null}if(this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)}this._player._pause()};l.prototype.stop=function(){if(this._t){clearTimeout(this._t);this._t=null}if(this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)}this._player._stop()};var m=function(e,u){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControl";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_playcontrol");this._div=e;this._body=null;this._slider=null;this._playBtn=null;this._slicedData=[];this._labelDiv=null;this._timer=new l(this);this._state=b;this._currentVal=0;this._step=D;this._visible=false;this._chartFeedings=[];this._createChildren();this._chartUpdateCompleteHandler=$.proxy(function(){this._dispatchEvent(new P(P.UPDATE_CHART_COMPLETE,this))},this);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_playcontrol")};O.extend(m,V);m.prototype.sliceDimension=function(e){if(arguments.length>0){this._vizModel().playerField(e);return this}else{return this._vizModel().playerField()}};m.prototype.slicedData=function(s){if(arguments.length>0){this._slicedData=s;this._resetControls();this._resetChartFrameDataScale();this._timer.stop()}else{return this._slicedData}};m.prototype._createChildren=function(){var _=this;var e=this._uiConfig;if(!this._body){this._body=$(document.createElement("div")).appendTo(this._div);this._body.addClass(C.PLAYCTRL_PREFIX+"body")}if(!this._playBtnDiv){this._playBtnDiv=$(document.createElement("div")).appendTo(this._body);this._playBtnDiv.addClass(C.PLAYCTRL_PREFIX+"playbtn");this._playBtn=new sap.ui.commons.Button({icon:G.defaultAssetsRoot()+g,iconDesityAware:true,press:$.proxy(_._btnPress,this)});this._playBtn.addStyleClass(C.PLAYCTRL_PREFIX+"playbtn");this._playBtn.placeAt(this._playBtnDiv)}if(!this._sliderDiv){this._sliderDiv=$(document.createElement("div")).appendTo(this._body);this._sliderDiv.addClass(C.PLAYCTRL_PREFIX+"slider");this._slider=new sap.ui.commons.Slider({editable:false,min:0,max:1,smallStepWidth:1,liveChange:$.proxy(this._sliderValueChange,this)});this._slider.placeAt(this._sliderDiv)}if(!this._labelDiv){this._labelDiv=$(document.createElement("div")).appendTo(this._body);this._labelDiv.addClass(C.PLAYCTRL_PREFIX+"label").text("text")}this._resetControls()};m.prototype._progressing=function(){this._currentVal+=this._step;if(this._currentVal>this._slider.getMax()){this._timer.stop();return}this._updateControls();this._updateChartData()};m.prototype._start=function(){this._state=c;this._updateControls();this._updateChartScale();this._enableChartInteraction(false)};m.prototype._stop=function(){this._state=b;this._currentVal=0;this._updateControls();this._updateChartData();this._enableChartInteraction(true)};m.prototype._pause=function(){this._state=d;this._updateControls();this._enableChartInteraction(true)};m.prototype._updateChartData=function(){if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]!==undefined){this._vizProxy().SetDataset(this._slicedData.slices[this._currentVal].data)}};m.prototype._updateChartScale=function(){if(this._vizModel().type()===a.TYPE_GEO_BUBBLE){var p=this._vizProxy().getProperties();if(p&&p.geoContainer){this._vizProxy().updateProperties({properties:{geoContainer:{scale:p.geoContainer.scale,center:p.geoContainer.center}},disableDispatchInteractionCompleteEvent:true})}}};m.prototype._resetChartFixScale=function(){if(this._vizModel().type()===a.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoContainer:{isFixedScale:this.sliceDimension()!=null,scale:null,center:[]}},disableDispatchInteractionCompleteEvent:true})}};m.prototype._resetChartFrameDataScale=function(){function e(j,x){var i,y,z=Number.MAX_VALUE,B=Number.MIN_VALUE,E=false;if(j&&x){for(i=0;i<j.length;i++){y=j[i].name();if(x[y]){z=Math.min(x[y][0],z);B=Math.max(x[y][1],B);E=true}}}return E?[z,B]:[0,0]}function u(i,x,y){var z=x.split("."),j,B;for(j=0,B=i;j<z.length;j++){if(j==z.length-1){B[z[j]]=y}else{B[z[j]]=B[z[j]]||{};B=B[z[j]]}}}var h={},n=[],o=this._vizModel().type(),p=sap.viz.api.manifest.Viz.get(o),q={},r,s,t,v={},w=p&&p[0]?p[0].dataScale:null;if(!w){return}if(this._slicedData&&U.isArray(this._slicedData.measuresInfo)){this._slicedData.measuresInfo.forEach(function(i){q[i.name]=i.range})}if(this._chartFeedings){n=this._chartFeedings.filter(function(i){return i&&i.type()===F.MEASURE});if(n.length>0){n.forEach(function(i){v[i.id()]=e(i.values(),q)})}}for(r in v){if(v.hasOwnProperty(r)){t=v[r]}if(w[r]&&U.isArray(w[r].minValue)){w[r].minValue.forEach(function(i){u(h,i,t[0])})}if(w[r]&&U.isArray(w[r].maxValue)){w[r].maxValue.forEach(function(i){u(h,i,t[1])})}}this._vizProxy().updateProperties({properties:h,disableDispatchInteractionCompleteEvent:true})};m.prototype._enableChartInteraction=function(e){if(this._vizModel().type()===a.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoController:{disableInteraction:!e}},disableDispatchInteractionCompleteEvent:true})}};m.prototype._updateControls=function(){switch(this._state){case b:this._playBtn.setIcon(G.defaultAssetsRoot()+g);break;case c:this._playBtn.setIcon(G.defaultAssetsRoot()+k);break;case d:this._playBtn.setIcon(G.defaultAssetsRoot()+g);break}this._slider.setValue(this._currentVal);if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]!==undefined){this._labelDiv.text(this._slicedData.slices[this._currentVal].dimensionMember);this._alignLabelWithSliderThumb()}};m.prototype._alignLabelWithSliderThumb=function(){this._labelDiv.width("auto");var s=this._sliderDiv.offset().left,e=this._sliderDiv.width(),h=Math.min(e,this._labelDiv.width()),t=$(".sapUiSliGrip",this._sliderDiv).offset()?$(".sapUiSliGrip",this._sliderDiv).offset().left:0;this._labelDiv.width(h+1);this._labelDiv.offset({left:h+t<s+e?t:s+e-h})};m.prototype._resetControls=function(){var h=!!(this._slicedData&&this._slicedData.slices&&this._slicedData.slices.length>0);this._playBtn.setEnabled(h);this._slider.setEditable(h);this._slider.setEnabled(h);this._slider.setMin(0);this._slider.setMax(h?this._slicedData.slices.length-1:1);this._updateControls();this._updateLabelVisiblity()};m.prototype._btnPress=function(){switch(this._state){case b:case d:this._timer.start();break;case c:this._timer.pause();break}};m.prototype._onConnect=function(e){m.superclass._onConnect.apply(this,arguments);this._chartFeedings=this._vizModel().feedingItems();this._sliceDimensionChanged();this._vizProxy().on("initialized.playcontrol",this._chartUpdateCompleteHandler)};m.prototype._onVizModelChanged=function(e){if(e.data.feedingItemsChanged){this._chartFeedings=this._vizModel().feedingItems();this.slicedData([])}if(e.data.sliceDimensionChanged){this._sliceDimensionChanged()}};m.prototype._sliderValueChange=function(){this._currentVal=this._slider.getValue();this._updateControls();this._updateChartScale();this._updateChartData()};m.prototype._sliceDimensionChanged=function(){this.slicedData([]);this._resetChartFixScale();var e={"sliceDimension":this.sliceDimension()};this._dispatchEvent(new P(P.SLICE_DIMENSION_CHANGED,this,e))};m.prototype.validateSize=function(w,h){var e=0,i=0,s,j=$(this._body).height();$(this._body).css({width:w});if(this._playBtnDiv){e=this._playBtnDiv.outerWidth();i=this._playBtnDiv.outerHeight();this._playBtnDiv.css({top:j/2-i/2+"px",left:0+"px",position:"absolute"})}if(this._sliderDiv){s=w-e;this._slider.setWidth(s+"px");sliderHeight=this._slider.getHeight();this._sliderDiv.css({top:j/2+"px",left:e+"px",position:"absolute"})}if(this._labelDiv){setTimeout($.proxy(function(){this._alignLabelWithSliderThumb()},this),0)}if(this._slider.oGrip&&this._slider.oGrip.title){$(".viz-controls-playcontrol-slider #__slider0-grip").mouseover(function(n){$('#__slider0-grip').attr('title'," ")})}};m.prototype.visible=function(v){m.superclass.visible.apply(this,arguments);this._visible=v;this._updateLabelVisiblity()};m.prototype._updateLabelVisiblity=function(){var h=!!(this._slicedData&&this._slicedData.slices&&this._slicedData.slices.length>0);this._labelDiv.css("visibility",h&&this._visible?"visible":"hidden")};m.prototype.save=function(o){var s={},i=0;if(o&&o.emptyDataset===true){s.measuresInfo=[];s.slices=[]}else if(this._slicedData){s.measuresInfo=this._slicedData.measuresInfo;if(U.isArray(this._slicedData.slices)){s.slices=[];for(;i<this._slicedData.slices.length;i++){s.slices.push({data:this._slicedData.slices[i].data.toJSON(),dimensionMember:this._slicedData.slices[i].dimensionMember})}}}return{sliceDimension:A.toJSON(this.sliceDimension()),slicedData:s,value:this._currentVal}};m.prototype.load=function(v){var s=v.slicedData,h=s&&U.isArray(s.slices)&&s.slices.length>0;this.sliceDimension(A.fromJSON(v.sliceDimension));if(h){s.slices=s.slices.map(function(i){return{dimensionMember:i.dimensionMember,data:sap.viz.api.data.CrosstableDataset.fromJSON(i.data)}})}this._slicedData=s;this._currentVal=h?Math.min(v.value,s.slices.length):0;this._resetControls();this._resetChartFrameDataScale();this._resetChartFixScale()};m.prototype.destroy=function(){this._vizProxy().off("initialized.playcontrol",this._chartUpdateCompleteHandler);m.superclass.destroy.apply(this,arguments);if(this._playBtn){this._playBtn.destroy(true)}if(this._slider){this._slider.destroy(true)}$(".viz-controls-playcontrol-slider #__slider0-grip").unbind('mouseover')};return m});define('sap/viz/controls/dedicatedlegend/DedicatedLegend',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager'],function($,V,O,u,L){var D=function(o){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.DedicatedLegend.DedicatedLegend";this._defaultChartOption=undefined;this._position='right';this._openBy=null;try{jQuery.sap.require("sap.m.ResponsivePopover")}catch(e){throw u.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.m','DedicatedLegend')}};O.extend(D,V);D.prototype._onConnect=function(v,m){D.superclass._onConnect.apply(this,arguments);this._olegendDOMID=this._createId('legends');this._oLegendDOM=new sap.ui.core.HTML();this._oPopover=new sap.m.ResponsivePopover(this._createId('legendPopover'),{dal:false,placement:sap.m.PlacementType.Auto,contentWidth:"18rem",title:'Legends',content:[this._oLegendDOM]});this._oPopover.addStyleClass('viz-controls-dedicatedLegend');this._oPopover.attachAfterClose(jQuery.proxy(function(){this._hideLegend()},this));this._oPopover.attachBeforeOpen(jQuery.proxy(function(){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");var o={};$.extend(true,o,{legendGroup:{renderTo:function(){return s}}},(this._defaultChartOption?this._defaultChartOption:a()));this._vizProxy().setProperties(o);var e=parseInt($(s).attr('height'))+5+d(0.5625),f=this._vizProxy().getSize().height*0.8-48-d(0.4375),g=d(1.625);this._oLegendDOM.setContent($(s).outerHTML());if(e>f){if(f<g){this._oPopover.setContentHeight(g+'px')}else{this._oPopover.setContentHeight(f+'px')}}else{this._oPopover.setContentHeight(null)}},this))};D.prototype._open=function(o){this._oPopover.openBy(o)};D.prototype._onDisconnect=function(){D.superclass._onDisconnect.apply(this,arguments)};D.prototype.destroy=function(){D.superclass.destroy.apply(this,arguments);if(this._oLegendDOM){this._oLegendDOM.destroy()}if(this._oPopover){this._oPopover.destroy()}this._olegendDOMID=undefined};D.prototype._createId=function(i){return this._uid+"-"+i};D.prototype.show=function(){if(this._isDefaultLegend()){if(this._defaultChartOption){this._vizProxy().setProperties(this._defaultChartOption)}else{this._showLegend()}}else{if(this._openBy){this._open(this._openBy)}}};D.prototype.hide=function(){if(this._isDefaultLegend()){this._hideLegend()}else{if(this._oPopover.isOpen()){this._oPopover.close()}}};D.prototype.setOpenBy=function(o){if(!arguments.length){return this._openBy}this._openBy=o};D.prototype.parseDefaultLegendProperties=function(p){if(this._oPopover.isOpen()){this._oPopover.close()}var w=this._vizProxy().getProperties();if(w){w=$.extend(false,w,p)}else{w=$.extend(false,a(),p)}if(p&&((p.legend&&p.legend.visible!==undefined)||(p.sizeLegend&&p.sizeLegend.visible))){if(w.legend&&w.sizeLegend&&(w.legend.visible!==w.sizeLegend.visible)){if(this._defaultChartOption){$.extend(true,this._defaultChartOption,b(p))}else{this._defaultChartOption=b(w)}}else{this._defaultChartOption=undefined}}if(w.legendGroup&&w.legendGroup.layout&&w.legendGroup.layout.position){this._position=w.legendGroup.layout.position}if(this._vizProxy().getSize().width>0&&this._vizProxy().getSize().height>0){if(this._isDefaultLegend()){$.extend(true,p,a(),(this._defaultChartOption?this._defaultChartOption:{}),b(p),{legendGroup:{renderTo:null}})}else{$.extend(true,p,_())}}return p};D.prototype.isOpen=function(){return this._oPopover.isOpen()};D.prototype._isDefaultLegend=function(){var p=this._position;return(p==='top'||p==='bottom')?(this._vizProxy().getSize().height>=480):(this._vizProxy().getSize().width>=600)};D.prototype._showLegend=function(){this._vizProxy().setProperties(a())};D.prototype._hideLegend=function(){this._vizProxy().setProperties(_())};var _=function(){return{legend:{visible:false},sizeLegend:{visible:false}}};var a=function(){return{legend:{visible:true},sizeLegend:{visible:true}}};var b=function(p){var r={};if(p&&p.legend&&p.legend.visible!==undefined){r.legend={visible:p.legend.visible}}if(p&&p.sizeLegend&&p.sizeLegend.visible!==undefined){r.sizeLegend={visible:p.sizeLegend.visible}}return r};var c=function(){return parseFloat(getComputedStyle(document.documentElement).fontSize)};var d=function(v){return c()*v};return D});define('sap/viz/controls/frame/VizFrame',['jquery','sap/viz/controls/common/VizControlHost','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/VizFrameConfig','sap/viz/controls/frame/VizFrameEvent','sap/viz/controls/annotation/Annotation','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotationcontrol/AnnotationControl','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/annotationcontrol/AnnotationControlEvent','sap/viz/controls/frame/chartEditor/ChartEditorPlugin','sap/viz/controls/chart/Chart','sap/viz/controls/contextmenu/ContextMenu','sap/viz/controls/custombutton/CustomButton','sap/viz/controls/custombutton/CustomButtonEvent','sap/viz/controls/filterbar0/FilterBar','sap/viz/controls/filterbar0/FilterBarEvent','sap/viz/controls/frame/views/FilterMenu','sap/viz/controls/frame/views/FilterMenuEvent','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/TitleEditor','sap/viz/controls/playcontrol/PlayControl','sap/viz/controls/playcontrol/PlayControlEvent','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/Version','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/utils/Serialization','sap/viz/controls/dedicatedlegend/DedicatedLegend'],function($,V,C,a,E,b,F,c,d,f,O,U,A,g,L,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,B,T,P,D,R,G,H,I,J,K,M,N,S,Q){var W=function W(h,i){W.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrame";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizframe_control');this._div=h;this._uiConfig=i?i:j.instance();if(this._uiConfig.enablePlayControl){try{jQuery.sap.require('sap.ui.commons.Button');jQuery.sap.require('sap.ui.commons.Slider')}catch(e){throw U.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG'),'sap.ui.commons','VizFrame','{enablePlayControl: true}')}}this._layout=null;this._filterBar=null;this._chart=null;this._chartEditorPlugin=new q(this._div,this,this._uiConfig);this._contextMenu=null;this._popupLayout=null;this._annotation=null;this._settingBtn=null;this._fullScreenBtn=null;this._titleEditor=null;this._playControl=null;this._legendControl=null;this._createChildren();this._addChild(this._chart,['enableMorphing','feedAnalysisObjects'],[B.CHART_CHANGED,B.CHART_CHANGING,B.VIZTYPE_CHANGED,F.FEEDS_CHANGED,B.USER_INTERACTION_COMPLETE]);if(this._filterBar){this._addChild(this._filterBar,['analysisObjectsForPicker'],[E.REQUEST_FILTER_VALUES])}if(this._annotationControl){this._addChild(this._annotationControl,[p.ANNOTATION_SELECTED_EVENT,p.ANNOTATION_LAYOUTED_EVENT])}this._addChild(this._annotation,[],[]);if(this._contextMenu&&U.isFunction(this._contextMenu.getEventNames)){this._addChild(this._contextMenu,[],this._contextMenu.getEventNames())}this._addChild(this._fullScreenBtn,[],[k.ENTER_FULL_SCREEN,k.EXIT_FULL_SCREEN]);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizframe_control')};O.extend(W,V);W.HEADER_HEIGHT=40;W.prototype.vizType=function(e){return this._chart.vizType.apply(this._chart,arguments)};W.prototype.filterItems=function(e){if(arguments.length>0){this._beginUpdateProperty();if(this._filterBar){this._filterBar.filterItems(e)}this._endUpdateProperty();return this}else{if(this._filterBar){return this._filterBar.filterItems()}return[]}};W.prototype.clearSelectedPropertyZone=function(){this._chart.clearSelectedPropertyZone()};W.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){var h=this._vizModel().filterItems();if(!this._inUpdatingProperty()){this._chart.showLoadingIcon()}this._dispatchPropertyEvent(new k(k.FILTERS_CHANGED,this,h))}if(e.data.sliceDimensionChanged){if(!this._playControl){var i=this._uiConfig.enablePlayControl===false?false:true;if(i){this._createPlayControl()}}}};W.prototype._commentChangedHandler=function(e){var h={commentChanged:true};this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,h))};W.prototype._vizDefinitionChanged=function(e){this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,e.data))};W.prototype._vizViewChanged=function(e){var h=this._uiConfig.enableTitleEditor===false?false:true;if(h){if(this._titleEditor){this._titleEditor.destroy();this._titleEditor=null}var i=e.data.type;if(f.supportTitle(i)){this._createTitleEditor();this._titleEditor.connect(this.vizUid())}}};W.prototype._createChart=function(){this._layout=document.createElement('div');$(this._div).append(this._layout);var h=J.instance();if(this._uiConfig.controls&&this._uiConfig.controls.chart){h=this._uiConfig.controls.chart}h=$.extend({},h);h.useInfoChart=(this._uiConfig.useInfoChart===true);this._chart=new r(this._layout,h);this._chart.addEventListener(E.VIZ_DEFINITION_CHANGED,this._vizDefinitionChanged,this);this._chart.addEventListener(B.SELECT_PROPERTY_ZONE,$.proxy(function(e){this._dispatchEvent(new B(B.SELECT_PROPERTY_ZONE,this,e.data))},this));this._chart.addEventListener(B.VIZ_VIEW_CHANGED,this._vizViewChanged,this);this._chart.addEventListener(B.CHART_CHANGED,this._chartChangedHandler,this);this._validateSize();this.__vizModel=this._chart.chartModel();this.__vizModel.addEventListener(G.PropertiesChangedEvent,this._onVizModelChanged,this)};W.prototype._chartChangedHandler=function(){if(this._titleEditor){this._titleEditor.init()}};W.prototype.popupLayer=function(){return this._popupLayout};W.prototype._createPopupLayer=function(){this._popupLayout=document.createElement('div');this._popupLayout.id="popupLayout";$(this._div).append(this._popupLayout)};W.prototype._createHeader=function(){if(!this._header$){this._header$=$(document.createElement('div')).appendTo(this._div);this._header$.addClass(C.FRAME_PREFIX+"header")}};W.prototype._createFullScreenButton=function(){var e=N.instance();if(this._uiConfig.controls&&this._uiConfig.controls.fullScreenButton){e=this._uiConfig.controls.fullScreenButton}this._fullScreenBtn=new t(this._header$,e);this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-enter-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._fullScreenBtn.addEventListener(u.CLICK_CUSTOM_BUTTON,$.proxy(function(h){this._isFullScreen=!this._isFullScreen;if(this._isFullScreen){this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-exit-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_RESTORE_DOWN'));this._dispatchEvent(new k(k.ENTER_FULL_SCREEN,this,this._isFullScreen))}else{this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-enter-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._dispatchEvent(new k(k.EXIT_FULL_SCREEN,this,this._isFullScreen))}},this),this)};W.prototype._createSettingButton=function(){var e=N.instance();if(this._uiConfig.controls&&this._uiConfig.controls.settingButton){e=this._uiConfig.controls.settingButton}this._settingBtn=new t(this._header$,e);this._settingBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-setting-icon'].join(' '));this._settingBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_SETTINGS'));this._settingBtn.addEventListener(u.CLICK_CUSTOM_BUTTON,$.proxy(function(h){var i=34;var w={pageX:$(this._div).width(),pageY:i};this._contextMenu.create(null).show(w)},this),this)};W.prototype._createFilterBar=function(){this._filterBarContainer$=$(document.createElement('div')).appendTo(this._header$);this._filterBarContainer$.addClass(C.FRAME_PREFIX+'header-filterbar-container');var e=K.instance();if(this._uiConfig.controls&&this._uiConfig.controls.filterBar){e=this._uiConfig.controls.filterBar}this._filterBar=new v(this._filterBarContainer$,e);this._filterBar.addEventListener(x.HEIGHT_CHANGED,function(h){if(!this._header$){return this}this._header$.css({'height':h.data.height});this._validateSize(true)},this)};W.prototype._createContextMenu=function(){var h;if(this._uiConfig.controls&&this._uiConfig.controls.contextMenu){h=this._uiConfig.controls.contextMenu}else{h=M.instance()}this._contextMenu=new s($(this._popupLayout),h);$(this._layout).bind('contextmenu',$.proxy(function(e){if(this._uiConfig.useCustomizedContextMenu!==true){var i=U.getEventPosition(e);var w={pageX:i.pageX-$(this._div).offset().left,pageY:i.pageY-$(this._div).offset().top};this._contextMenu.create(null).show(w)}return false},this));this._contextMenu.addEventListener("menuItemSelected",(function(e){if(e.data.menuItem.id==="sap.viz.controls.contextmenu.item.comment"){var i=this.vizSelection({'withDataCtx':true});this._dispatchEvent(new k(k.ADD_COMMENT,this,{context:i[0]}))}}).bind(this));if(this._uiConfig.useCustomizedContextMenu===true&&(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getService)){this._chart.addEventListener(B.CONTEXT_MENU_TRIGGERED,function(e){var i='sap.viz.controls.contextmenu.location.'+e.data.type;var w=[];var X=sap.bi.framework.getService('sap.viz.controls.aio','sap.viz.controls.contextmenu.builtIn');if(X){if(X.generator){w=X.generator(e.data.type,this)}else if(X.menus){w=X.menus}if(!$.isArray(w)){w=[]}}var Y={};Y['sap.viz.controls.contextmenu.custom.'+e.data.type]=true;var Z=sap.bi.framework.getService('sap.viz.controls.contextmenu','sap.viz.controls.contextmenu.custom.'+e.data.type);if(Z){var _=[];if(Z.generator){_=Z.generator(i,this,e.data.data)}else if(Z.menus){_=Z.menus}if(!$.isArray(_)){_=[]}_.forEach(function(c1){if($.isArray(c1)){c1.forEach(function(e1){e1=d1(e1)})}else{c1=d1(c1)}w.push(c1);function d1(c1){if(c1&&c1.subMenus){c1.subMenus=e1(c1.subMenus)}return c1;function e1(f1){if(!$.isArray(f1)){return}var g1=[];f1.forEach(function(h1){if(h1!==null&&typeof h1==='string'){if(h1 in Y){return}else{Y[h1]=true}var i1=sap.bi.framework.getService('sap.viz.controls.contextmenu',h1);if(i1){var j1=[];if(i1.generator){j1=i1.generator(h1)}else if(i1.menus){j1=i1.menus}if(!$.isArray(j1)){j1=[]}j1.forEach(function(c1){if($.isArray(c1)){c1.forEach(function(l1){l1=k1(l1)})}else{c1=k1(c1)}g1.push(c1);function k1(l1){if(l1&&l1.subMenus){l1.subMenus=e1(l1.subMenus)}return l1}})}}});return g1}}})}var a1=e.data.point;var b1={pageX:a1.x-$(this._div).offset().left,pageY:a1.y-$(this._div).offset().top};if(w.length===0){w=null}this._contextMenu.create(i,w).show(b1)},this)}};W.prototype._createFilterMenu=function(){this._filterMenu=new y($(this._popupLayout),this._uiConfig);this._filterMenu.addEventListener(z.FILTER_CLICKED,function(e){this._filterMenu.hide();this._addFilter(false)},this);this._filterMenu.addEventListener(z.EXCLUDE_CLICKED,function(e){this._filterMenu.hide();this._addFilter(true)},this);this._chart.addEventListener(B.CHANGED_SELECTED_DATA,function(e){var h=this.vizSelection();var i=h?h.length:0;var w=i>0;var X=i>0;this._filterMenu.show(w,X)},this);this.vizOn("initialized.filterMenu",$.proxy(function(e){if(this._filterMenu){var h=this.vizSelection();var i=h?h.length:0;if(i>0){this._filterMenu.show(true,true)}else{this._filterMenu.hide()}}},this))};W.prototype._createPlayControl=function(){var h=document.createElement('div');this._playControlContainer$=$(h);$(h).css({"position":"relative"});$(this._div).append(h);this._playControl=new P($(h));this._validateSize();this._playControl.addEventListener(D.SLICE_DIMENSION_CHANGED,$.proxy(function(e){this._redrawPlayControl();this._dispatchPropertyEvent(new k(k.SLICE_DIMENSION_CHANGED,this,this._playControl.sliceDimension()))},this));this.vizOn("initialized.playControl",$.proxy(function(e){this._validatePlayControlSize()},this));this._playControl.connect(this.vizUid())};W.prototype._redrawPlayControl=function(){if(this._playControl){var e=this._playControl.sliceDimension();this._playControl.visible(!!e);this._validateSize()}};W.prototype._validatePlayControlSize=function(){var e=this.vizFeedingZone();var h;for(var i=0;i<e.length;i++){var w=e[i];if(w.name==='plot'){h=w.bound[0];break}}if(h&&h.length>0){var X=h[1][0]-h[0][0];var Y=h[0][0];$(this._playControlContainer$).css({"width":X,'left':Y});this._playControl.validateSize(X)}};W.prototype._addFilter=function(i){this._dispatchEvent(new b(B.USER_INTERACTION_COMPLETE,this));sap.viz.base.utils.log.Analyzer.pnrProfiling('vizFrame has dispatch the userInteraction Event');if(this._filterBar){var e=this.vizSelection({'withDataCtx':true});this._vizModel().updateFilterItems(e,i,this.vizData(),this._chart.feeding())}else{var h={"isExclude":i,"feeding":this._chart.feeding()};this._dispatchEvent(new k(k.ADD_FILTER,this,h))}};W.prototype._createTitleEditor=function(){this._titleEditorContainer$=$(this._layout).find("."+C.CHART_PREFIX+"holder");$(this._titleEditorContainer$).css({position:'absolute',width:'100%'});this._titleEditor=new T(this._titleEditorContainer$);this.vizOn("initialized.titleEditor",$.proxy(function(e){if(this._titleEditor){this._titleEditor.init()}},this))};W.prototype._createAnnotation=function(){var h=I.instance();if(this._uiConfig.controls&&this._uiConfig.controls.annotation){h=this._uiConfig.controls.annotation}this._annotation=new l(this._div,h);this._annotation.popupLayer(this._popupLayout);if(this._contextMenu){this._contextMenu.addMenuItem("sap.viz.controls.contextmenu.item.comment",{id:"sap.viz.controls.contextmenu.item.comment",label:L.get("VIZ_CONTEXTMENU_INSERT_COMMENT")})}this.addEventListener(B.CHART_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.setChartInfo({'vizType':this._chart.vizType(),'vizData':this._chart.vizData()});var i=this._chart.size();this._annotation.validateSize(i.width,i.height)}},this));this.addEventListener(B.CHART_CHANGING,$.proxy(function(e){if(this._annotation){this._annotation.clean()}},this));this.addEventListener(F.FEEDS_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.feedsChanged()}},this));this.addEventListener(k.ADD_COMMENT,$.proxy(function(e){if(this._annotation){this._annotation.addComment(this.vizSelection({'withDataCtx':true}))}},this));this.vizOn("initialized.annotation",$.proxy(function(e){if(this._annotation){this._annotation.redraw()}},this))};W.prototype._createAnnotationControl=function(){var e=null;if(this._uiConfig.controls&&this._uiConfig.controls.annotationControl){e=this._uiConfig.controls.annotationControl}else{e=o.instance()}var h=$(document.createElement('div')).insertBefore(this._popupLayout);this._annotationControl=new n(h[0],e);if(this._contextMenu){this._contextMenu.addMenuItem("sap.viz.controls.contextmenu.item.comment",{id:"sap.viz.controls.contextmenu.item.comment",label:L.get("VIZ_CONTEXTMENU_INSERT_COMMENT")})}};W.prototype._createChildren=function(){var e=this._uiConfig.enableFilterBar===false?false:true;var h=this._uiConfig.enableFullScreenButton===false?false:true;var i=this._uiConfig.enableSettingButton===false?false:true;if(e||h||i){this._createHeader()}if(e){this._createFilterBar()}if(h){this._createFullScreenButton()}if(i){this._createSettingButton()}this._createChart();if(this._uiConfig.enableResponsiveLegend===true){this._createDedicatedLegendControl()}this._createPopupLayer();var w=this._uiConfig.enableContextMenu===false?false:true;if(w){this._createContextMenu()}var X=this._uiConfig.enableAnnotation===false?false:true;if(X){this._createAnnotation()}if(this._uiConfig.enableAnnotationControl===true){this._createAnnotationControl()}var Y=this._uiConfig.enableFilterMenu===false?false:true;if(Y){this._createFilterMenu()}var Z=this._uiConfig.enableTitleEditor===false?false:true;if(Z){this._createTitleEditor()}if(this._filterBar){this._filterBar.connect(this.vizUid())}if(this._contextMenu){this._contextMenu.connect(this.vizUid())}if(this._titleEditor){this._titleEditor.connect(this.vizUid())}if(this._annotation){this._annotation.connect(this.vizUid())}if(this._annotationControl){this._annotationControl.connect(this.vizUid())}if(this._legendControl){this._legendControl.connect(this.vizUid())}};W.prototype._validateSize=function(i){var w=$(this._div).width();var h=$(this._div).height();if(this._header$&&this._header$.css('display')!='none'&&!isNaN(this._header$.outerHeight())){if(this._filterBar&&!(i===true)){this._filterBar.validateSize()}h-=this._header$.outerHeight()}if(this._playControl&&this._playControlContainer$.css('visibility')==='visible'&&!isNaN(this._playControlContainer$.outerHeight())){h-=this._playControlContainer$.outerHeight()}$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chart){this._chart.size({width:w,height:h});if(this._legendControl&&this._vizModel().type()){var e={};this._parseLegendProperties(e);this._chart.vizProperties(e)}}if(this._annotation){this._annotation.validateSize(w,h)}if(this._chartEditorPlugin){this._chartEditorPlugin.validateSize(w,h)}if(this._filterMenu){this._filterMenu.size({width:w})}if(this._playControl){this._validatePlayControlSize()}if(this._titleEditor){this._titleEditor.size()}};W.prototype._chartControl=function(){return this._chart};W.prototype.connect=function(e){};W.prototype.disconnect=function(){};W.prototype.destroy=function(){if(this._contextMenu){this._contextMenu.removeAllEventListeners();this._contextMenu.destroy();this._contextMenu=null}if(this._filterMenu){this._filterMenu.removeAllEventListeners();this._filterMenu.destroy();this._filterMenu=null}if(this._chartEditorPlugin){this._chartEditorPlugin.destroy();this._chartEditorPlugin=null}if(this._annotation){this._annotation.destroy();this._annotation=null}if(this._playControl){this._playControl.destroy();this._playControl=null}if(this._legendControl){this._legendControl.destroy();this._legendControl=null}W.superclass.destroy.apply(this,arguments);this._chart=null;this._filterBar=null};W.prototype.vizUid=function(){return this._chart.vizUid()};W.prototype.vizData=function(e){return this._chart.vizData.apply(this._chart,arguments)};W.prototype.vizCss=function(e){return this._chart.vizCss.apply(this._chart,arguments)};W.prototype.vizProperties=function(e){if(!arguments.length){var h=this._chart.vizProperties.apply(this._chart,arguments);if(this._legendControl){h.legendGroup.computedVisibility=h.legendGroup.computedVisibility||this._legendControl.isOpen()}return h}else{if(this._legendControl){this._parseLegendProperties(e)}return this._chart.vizProperties.apply(this._chart,arguments)}};W.prototype.vizDescription=function(){return this._chart.vizDescription.apply(this._chart,arguments)};W.prototype.vizUpdate=function(e){var h;if(!e){return}this._beginUpdateProperty();try{if(e.filters&&this._filterBar){var i=e.filters.value?e.filters.value:e.filters;this._filterBar.filterItems(i)}if(e.properties&&this._legendControl){this._parseLegendProperties(e.properties)}h=this._chart.vizUpdate.apply(this._chart,arguments)}catch(w){this._endUpdateProperty();throw w}this._endUpdateProperty();return h};W.prototype.vizOn=function(e,h){this._chart.vizOn.apply(this._chart,arguments);return this};W.prototype.vizOff=function(e){this._chart.vizOff.apply(this._chart,arguments);return this};W.prototype.vizAction=function(e,h){this._chart.vizAction.apply(this._chart,arguments);return this};W.prototype.vizSelection=function(e,h){return this._chart.vizSelection.apply(this._chart,arguments)};W.prototype.vizFeedingZone=function(){return this._chart.vizFeedingZone.apply(this._chart,arguments)};W.prototype.vizTitle=function(e){return e=this._chart.vizTitle.apply(this._chart,arguments)};W.prototype.createViz=function(e){if(arguments.length>0){if(this._legendControl&&e.properties){this._parseLegendProperties(e.properties)}this._chart.createViz(e);return this}};W.prototype.changeTemplate=function(){return this._chart.changeTemplate.apply(this._chart)};W.prototype.exportViz=function(e){return this._chart.exportViz(e)};W.prototype.loadViz=function(e){this._chart.loadViz(e)};W.prototype.save=function(e){var h={};h['version']=H.VERSION;h["chart"]=this._chart.save(e);if(this._filterBar){h["filterBar"]=this._filterBar.save()}if(this._contextMenu){h["contextMenu"]=this._contextMenu.save()}if(this._annotation){h["annotation"]=this._annotation.save()}if(this._titleEditor){h['titleEditor']=this._titleEditor.save()}if(this._playControl){h['playControl']=this._playControl.save(e)}return h};W.prototype.load=function(e){this._beginUpdateProperty();var h=S.migrateVizFrame(e);this._vizModel().restorePlayerField(null);this._redrawPlayControl();var i=h['version'];i=h["filterBar"];if(i&&this._filterBar){this._filterBar.load(i)}i=h["contextMenu"];if(i&&this._contextMenu){this._contextMenu.load(i)}i=h["chart"];if(i){this._chart.load(i)}i=h["annotation"];if(i&&this._annotation){this._annotation.load(i)}i=h["titleEditor"];if(i&&this._titleEditor){this._titleEditor.load(i)}i=h["playControl"];if(i){if(!this._playControl){var w=this._uiConfig.enablePlayControl===false?false:true;if(w){this._createPlayControl()}}if(this._playControl){this._chart._beginUpdateProperty();this._playControl.load(i);this._chart._endUpdateProperty()}}this._endUpdateProperty()};W.prototype.feeds=function(e){return this._chart.feeds.apply(this._chart,arguments)};W.prototype.getDefaultIncompleteOptions=function(e){return this._chart.getDefaultIncompleteOptions.apply(this._chart,arguments)};W.getDefaultIncompleteOptions=function(e){return r.getDefaultIncompleteOptions.apply(r,arguments)};W.prototype.showMessage=function(e){if(arguments.length==1){this._chart.showMessage(e)}};W.prototype.pauseRender=function(){this._chart.pauseRender()};W.prototype.resumeRender=function(){this._chart.resumeRender()};W.prototype.setTitleGeneratorFunc=function(e){this._chart.setTitleGeneratorFunc(e)};W.prototype.vizTitleMode=function(e){if(arguments.length>0){this._chart.vizTitleMode(e)}else{return this._chart.vizTitleMode()}};W.prototype.annotationControl=function(){return this._annotationControl};W.prototype.chart=function(){return this._chart};W.prototype.filterBar=function(){return this._filterBar};W.prototype.contextMenu=function(){return this._contextMenu};W.prototype.titleEditor=function(){return this._titleEditor};W.prototype.playControl=function(){return this._playControl};W.prototype.exportToSVGString=function(e){return this._chart.exportToSVGString(e)};W.prototype.supportExportToSVG=function(){var e=false;if(this.vizType()){e=f.isBuildInType(this.vizType())||e}return e};W.prototype.selectedPropertyZone=function(e){return this._chart.selectedPropertyZone.apply(this._chart,arguments)};W.prototype.responsiveLegend=function(){if(this._legendControl){return this._legendControl}};W.prototype._createDedicatedLegendControl=function(){this._legendControl=new Q()};W.prototype._parseLegendProperties=function(e){if(this._legendControl){return this._legendControl.parseDefaultLegendProperties(e)}};return W});define('sap/viz/controls/popover/chartpopover/ShapeMarker',[],function(){var _=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
jQuery.sap.declare('sap.viz.chartpopover.ShapeMarker');sap.ui.core.Control.extend('sap.viz.chartpopover.ShapeMarker',{metadata:{properties:{'type':'string','color':'string','markerSize':'int'}},renderer:{render:function(r,c){var m=c.getMarkerSize()?c.getMarkerSize():10;var p={rx:m/2,ry:m/2,type:c.getType(),borderWidth:0};r.write('<div');r.writeClasses();r.write('>');r.write('<svg width='+m+'px height='+m+'px ');r.write('>');r.write("<path d = '"+c._generateShapePath(p)+"'");r.write(" fill = '"+c.getColor()+"'");r.write(" transform = 'translate("+m/2+","+m/2+")'");r.write('</path>');r.write('</svg>');r.write('</div>');r.writeStyles()}}});sap.viz.chartpopover.ShapeMarker.prototype._generateShapePath=function(p){var a;var t=p.borderWidth/2;switch(p.type){case"circle":a="M"+(-p.rx-t)+",0 A"+(p.rx+t)+","+(p.ry+t)+" 0 1,0 "+(p.rx+t)+",0 A";a+=(p.rx+t)+","+(p.ry+t)+" 0 1,0 "+(-p.rx-t)+",0z";break;case"cross":a="M"+(-p.rx-t)+","+(-p.ry/3-t)+"H"+(-p.rx/3-t)+"V"+(-p.ry-t)+"H"+(p.rx/3+t);a+="V"+(-p.ry/3-t)+"H"+(p.rx+t)+"V"+(p.ry/3+t)+"H"+(p.rx/3+t);a+="V"+(p.ry+t)+"H"+(-p.rx/3-t)+"V"+(p.ry/3+t)+"H"+(-p.rx-t)+"Z";break;case"diamond":a="M0,"+(-p.ry-t)+"L"+(p.rx+t)+",0"+" 0,"+(p.ry+t)+" "+(-p.rx-t)+",0"+"Z";break;case"square":a="M"+(-p.rx-t)+","+(-p.ry-t)+"L"+(p.rx+t)+",";a+=(-p.ry-t)+"L"+(p.rx+t)+","+(p.ry+t)+"L"+(-p.rx-t)+","+(p.ry+t)+"Z";break;case"triangle-down":case"triangleDown":a="M0,"+(p.ry+t)+"L"+(p.rx+t)+","+-(p.ry+t)+" "+-(p.rx+t)+","+-(p.ry+t)+"Z";break;case"triangle-up":case"triangleUp":a="M0,"+-(p.ry+t)+"L"+(p.rx+t)+","+(p.ry+t)+" "+-(p.rx+t)+","+(p.ry+t)+"Z";break;case"triangle-left":case"triangleLeft":a="M"+-(p.rx+t)+",0L"+(p.rx+t)+","+(p.ry+t)+" "+(p.rx+t)+","+-(p.ry+t)+"Z";break;case"triangle-right":case"triangleRight":a="M"+(p.rx+t)+",0L"+-(p.rx+t)+","+(p.ry+t)+" "+-(p.rx+t)+","+-(p.ry+t)+"Z";break;case"intersection":a="M"+(p.rx+t)+","+(p.ry+t)+"L"+(p.rx/3+t)+",0L"+(p.rx+t)+","+-(p.ry+t)+"L";a+=(p.rx/2-t)+","+-(p.ry+t)+"L0,"+(-p.ry/3-t)+"L"+(-p.rx/2+t)+","+-(p.ry+t)+"L";a+=-(p.rx+t)+","+-(p.ry+t)+"L"+-(p.rx/3+t)+",0L"+-(p.rx+t)+","+(p.ry+t)+"L";a+=(-p.rx/2+t)+","+(p.ry+t)+"L0,"+(p.ry/3+t)+"L"+(p.rx/2-t)+","+(p.ry+t)+"Z";break;case'squareWithRadius':var r=p.rx;var b=r-3;a="M0,"+-r+"L"+-b+","+-r+"Q"+-r+","+-r+" "+-r+","+-b+"L"+-r+","+b+"Q"+-r+","+r+" "+-b+","+r;a+="L"+b+","+r+"Q"+r+","+r+" "+r+","+b+"L"+r+","+-b+"Q"+r+","+-r+" "+b+","+-r+"Z";break}return a}};return{'create':function(i,s){try{return new sap.viz.chartpopover.ShapeMarker(i,s)}catch(e){_();return arguments.callee.apply(this,arguments)}}}});define('sap/viz/controls/popover/chartpopover/ContentPanel',['sap/viz/controls/popover/chartpopover/ShapeMarker'],function(S){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.ContentPanel');sap.ui.core.Control.extend('sap.viz.chartpopover.ContentPanel',{metadata:{publicMethods:["setContentData"]},renderer:{render:function(r,c){r.renderControl(c._oPanel)}}});sap.viz.chartpopover.ContentPanel.prototype.init=function(){this._measureItemsLen=0;this._defaultItemsLineHeight=1.4375;this._spacing=0.4375*2;var m=new sap.ui.model.json.JSONModel();this._sModelName="sapvizModel";var i=new sap.m.DisplayListItem({label:"{measureName}",value:"{measureValue}"}).addStyleClass('viz-controls-chartPopover-measures-item');this._oList=new sap.m.List({}).addStyleClass('viz-controls-chartPopover-measures-list');this._oList.setModel(m);this._oList.bindAggregation("items","/items",i);this._oShapeLabel=S.create(this._createId('vizShapeMarker'),{}).addStyleClass('viz-controls-chartPopover-dimension-marker');this._oDimLabel=new sap.m.Label(this._createId('vizDimensionLabel'),{}).addStyleClass('viz-controls-chartPopover-dimension-label');this._oPanel=new sap.m.Panel(this._createId('vizPanel'),{content:[this._oShapeLabel,this._oDimLabel,this._oList]})};sap.viz.chartpopover.ContentPanel.prototype.setContentData=function(d){var v=d.val,a='',m=[];this._measureItemsLen=0;if(v){for(var i=0;i<v.length;i++){if(v[i].type==='dimension'){if(a.length>0){a=a+' - '+v[i].value}else{a=v[i].value}}else if(v[i].type=='measure'){m.push({measureName:v[i].name,measureValue:v[i].value})}}if(typeof d.color==='string'){var b=this._oDimLabel.$().css('margin-left');if(b){b=parseInt(b.substr(0,b.length-2));this._oShapeLabel.setMarkerSize(b)}this._oShapeLabel.setColor(d.color).setType((d.shape?d.shape:'square'))}else{this._oPanel.removeContent(this._oShapeLabel)}this._oDimLabel.setText(a);this._oList.getModel().setData({'items':m});this._measureItemsLen=m.length}};sap.viz.chartpopover.ContentPanel.prototype.getContentHeight=function(){return this._measureItemsLen>0?((this._measureItemsLen+1)*this._defaultItemsLineHeight+this._spacing):0};sap.viz.chartpopover.ContentPanel.prototype._createId=function(i){return this.getId()+"-"+i};sap.viz.chartpopover.ContentPanel.prototype.exit=function(i){if(this._oList){this._oList.destroy();this._oList=null}if(this._oShapeLabel){this._oShapeLabel.destroy();this._oShapeLabel=null}if(this._oDimLabel){this._oDimLabel.destroy();this._oDimLabel=null}}};return{'create':function(i,s){try{return new sap.viz.chartpopover.ContentPanel(i,s)}catch(e){_();return arguments.callee.apply(this,arguments)}}}});define('sap/viz/controls/popover/chartpopover/HeaderBar',[],function(){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.HeaderBar');sap.m.Bar.extend('sap.viz.chartpopover.HeaderBar',{metadata:{properties:{'showNavButton':'boolean','title':'string'},publicMethods:[],events:{"navButtonPress":{},"closeButtonPress":{}}},renderer:{}});sap.viz.chartpopover.HeaderBar.prototype.getContentLeft=function(){if(!this._oNavButton){this._oNavButton=new sap.m.Button(this._createId("popoverNavButton"),{type:sap.m.ButtonType.Back,press:jQuery.proxy(function(){this.fireNavButtonPress()},this)}).addStyleClass('sapUiIcon')}this._oNavButton.setVisible(this.getShowNavButton());return[this._oNavButton]};sap.viz.chartpopover.HeaderBar.prototype.getContentMiddle=function(){if(!this._oTitleLabel){this._oTitleLabel=new sap.m.Label(this._createId('popoverHeaderTitle'))}this._oTitleLabel.setText(this.getTitle());return[this._oTitleLabel]};sap.viz.chartpopover.HeaderBar.prototype.getContentRight=function(){if(!this._oCloseButton){this._oCloseButton=new sap.m.Button(this._createId("popoverCloseButton"),{icon:sap.ui.core.IconPool.getIconURI("decline"),press:jQuery.proxy(function(){this.fireCloseButtonPress()},this)}).addStyleClass('sapUiIcon')}return[this._oCloseButton]};sap.viz.chartpopover.HeaderBar.prototype.exit=function(){if(this._oCloseButton){this._oCloseButton.destroy();this._oCloseButton=null}if(this._oTitleLabel){this._oTitleLabel.destroy();this._oTitleLabel=null}if(this._oNavButton){this._oNavButton.destroy();this._oNavButton=null}};sap.viz.chartpopover.HeaderBar.prototype._createId=function(i){return this.getId()+"-"+i}};return{'create':function(i,s){try{return new sap.viz.chartpopover.HeaderBar(i,s)}catch(e){_();return arguments.callee.apply(this,arguments)}}}});define('sap/viz/controls/popover/chartpopover/SubActionItemsPage',[],function(){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.SubActionItemsPage');sap.ui.core.Element.extend('sap.viz.chartpopover.SubActionItemsPage',{metadata:{properties:{items:{type:'sap.m.ListBase[]'}}}});sap.viz.chartpopover.SubActionItemsPage.prototype.init=function(){this._oList=new sap.m.List({});this._oPage=new sap.m.Page(this._createId("listPage"),{showNavButton:false,showHeader:false,content:[this._oList]})};sap.viz.chartpopover.SubActionItemsPage.prototype.exit=function(){if(this._oList){this._oList.destroy();this._oList=null}if(this._oPage){this._oPage.destroy();this._oPage=null}};sap.viz.chartpopover.SubActionItemsPage.prototype.getControl=function(){return this._oPage};sap.viz.chartpopover.SubActionItemsPage.prototype.getPageId=function(){return this._oPage.getId()};sap.viz.chartpopover.SubActionItemsPage.prototype.setItems=function(a){this._oList.removeAllItems();var b;for(var i=0;i<a.length;i++){b=new sap.m.ActionListItem({text:a[i].text,press:a[i].press?a[i].press:function(){}});this._oList.addItem(b)}};sap.viz.chartpopover.SubActionItemsPage.prototype._createId=function(i){return this.getId()+"-"+i}};return{'create':function(i,s){try{return new sap.viz.chartpopover.SubActionItemsPage(i,s)}catch(e){_();return arguments.callee.apply(this,arguments)}}}});define('sap/viz/controls/popover/chartpopover/ChartPopover',['sap/viz/controls/popover/chartpopover/ContentPanel','sap/viz/controls/popover/chartpopover/HeaderBar','sap/viz/controls/popover/chartpopover/SubActionItemsPage'],function(C,H,S){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.ChartPopover');sap.ui.core.Control.extend('sap.viz.chartpopover.ChartPopover',{metadata:{properties:{'customDataControl':{type:'any'},'actionItems':{type:'object[]'},'formatString':{type:'any'}}}});sap.viz.chartpopover.ChartPopover.prototype.init=function(){this._listItemHeight=3;this._options=null;this._oContentPanel=C.create(this._createId('vizContentPanel'),{});this._oSelectedLabel=new sap.m.Label(this._createId('vizSelectedLabel'),{});this._oSelectedBar=new sap.m.Bar(this._createId('vizSelectedBar'),{contentMiddle:[this._oSelectedLabel]}).addStyleClass('viz-controls-chartPopover-vizSelectedBar').addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');this._oHomePage=new sap.m.Page(this._createId('vizHomePage'),{showNavButton:false,showHeader:false,content:[this._oContentPanel]});this._oNavContainer=new sap.m.NavContainer(this._createId('vizNavContainer'),{afterNavigate:jQuery.proxy(function(e){var p=e.getParameter("to").getId();if(p.search('HomePage')!==-1){this._oCustomHeader.setShowNavButton(false).setTitle('Current Selection')}else{this._oCustomHeader.setShowNavButton(true)}},this)});this._oNavContainer.addPage(this._oHomePage);this._oCustomHeader=H.create(this._createId('vizHeaderBar'),{title:'Current Selection',showNavButton:false,closeButtonPress:jQuery.proxy(this.close,this),navButtonPress:jQuery.proxy(this._navigateBack,this)});this._oPopover=new sap.m.ResponsivePopover(this._createId('vizChartPopover'),{modal:false,bounce:true,horizontalScrolling:false,contentWidth:"18rem",contentHeight:'100%',customHeader:this._oCustomHeader,content:[this._oNavContainer]});this._oPopover.addStyleClass('viz-controls-chartPopover');this._oPopover.attachBeforeOpen(jQuery.proxy(this._beforeOpen,this));this._oPopover.attachAfterClose(jQuery.proxy(this._afterClose,this))};sap.viz.chartpopover.ChartPopover.prototype._beforeOpen=function(){var s=0;if(!this._options.data.val||this._options.selectedValues>1){s=this._listItemHeight+0.1}var c=this._oContentPanel.getContentHeight()+s;if(this._oContentPanel.getContentHeight()===0){if(!this._oCustomPanel){this._oHomePage.removeContent(this._oContentPanel);this._oSelectedBar.removeStyleClass('viz-controls-chartPopover-vizSelectedBarBorder')}}if(this.getActionItems()){c+=this.getActionItems().length*this._listItemHeight}this._oPopover.setContentHeight(c+'rem')};sap.viz.chartpopover.ChartPopover.prototype._afterClose=function(){if(this._options&&this._options.selectedValues<1){this._oHomePage.removeContent(this._oSelectedBar)}};sap.viz.chartpopover.ChartPopover.prototype.isOpen=function(){return this._oPopover.isOpen()};sap.viz.chartpopover.ChartPopover.prototype.openBy=function(c,s){if(c){this._updateContent();this._updateActionItems();var t=c.getBoundingClientRect();this._oPopover.setOffsetX(parseInt(t.width)).setOffsetY(parseInt(t.height/2));this._navigateBack();this._oPopover.openBy(c,s)}return this};sap.viz.chartpopover.ChartPopover.prototype.close=function(){this._oPopover.close();return this};sap.viz.chartpopover.ChartPopover.prototype.exit=function(){if(this._oNavContainer){this._oNavContainer.destroy();this._oNavContainer=null}if(this._oContentPanel){this._oContentPanel.destroy();this._oContentPanel=null}if(this._oSelectedLabel){this._oSelectedLabel.destroy();this._oSelectedLabel=null}if(this._oHomePage){this._oHomePage.destroy();this._oHomePage=null}if(this._oCustomHeader){this._oCustomHeader.destroy();this._oCustomHeader=null}if(this._oCustomPanel){this._oCustomPanel.destroy();this._oCustomPanel=null}if(this._oPopover){this._oPopover.destroy();this._oPopover=null}this._options=null};sap.viz.chartpopover.ChartPopover.prototype.setOptions=function(o){var d=this._formatData(o.data);this._options=o;this._oContentPanel.setContentData(d);if(!d.val||o.selectedValues>1){this._oSelectedLabel.setText(o.selectedValues+' values selected');this._oHomePage.insertContent(this._oSelectedBar,1)}else{this._oHomePage.removeContent(this._oSelectedBar)}return this};sap.viz.chartpopover.ChartPopover.prototype._updateContent=function(){var c=this.getCustomDataControl();if(c){if(this._oCustomPanel){this._oHomePage.removeContent(this._oCustomPanel)}this._oCustomPanel=c(this._options);this._oHomePage.removeContent(this._oContentPanel);this._oHomePage.insertContent(this._oCustomPanel,0);this._oSelectedBar.addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder')}else{this._oCustomPanel=null;if(this._oHomePage.indexOfContent(this._oContentPanel)===-1){this._oHomePage.insertContent(this._oContentPanel,0);this._oSelectedBar.addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder')}}return this};sap.viz.chartpopover.ChartPopover.prototype._updateActionItems=function(){if(!this._oActionList){var a=this.getActionItems();if(a&&a.length>0){this._actionItems=jQuery.extend(true,this._actionItems,a);var b,l=[];for(var i=0,c=a.length;i<c;i++){b=a[i];if(b.type==='action'){l.push(new sap.m.ActionListItem(this._createId('actionItems-'+i),{text:b.text,press:b.press?b.press:function(){}}))}else if(b.type==='navigation'){l.push(new sap.m.StandardListItem(this._createId('actionItems-'+i),{title:b.text,type:'Navigation',press:jQuery.proxy(function(e){var d=e.getParameter('id');var f=parseInt(d.substring(d.lastIndexOf('-')+1));var s=this._actionItems[f].children;if(s&&s.length>0){if(!this._oSubActionItemsPage){this._oSubActionItemsPage=S.create();this._oNavContainer.addPage(this._oSubActionItemsPage.getControl())}this._oSubActionItemsPage.setItems(s);this._oCustomHeader.setTitle(this._actionItems[f].text);this._navigateTo(this._oSubActionItemsPage.getPageId())}},this)}))}}this._oActionList=new sap.m.List({items:l}).addStyleClass('viz-controls-chartPopover-actionList');this._oHomePage.addContent(this._oActionList)}}};sap.viz.chartpopover.ChartPopover.prototype._navigateBack=function(){this._oNavContainer.back()};sap.viz.chartpopover.ChartPopover.prototype._navigateTo=function(p){this._oNavContainer.to(p)};sap.viz.chartpopover.ChartPopover.prototype._createId=function(i){return this.getId()+"-"+i};sap.viz.chartpopover.ChartPopover.prototype._formatData=function(d){if(!d.val){return d}var f=sap.viz.api.env.Format.format,a=jQuery.extend(true,{},d),t=a.val.hasOwnProperty("timeMeasure")?a.val.timeMeasure:-1,b=this.getFormatString(),c=null,e={},p;if(typeof b==="string"){c=b}else if(b instanceof Object){e=b}if(t!==-1){var g=a.val.filter(function(i){return i.type==="measure"})[t];g.value=new Date(g.value)}a.val.forEach(function(v){if(v.type==="measure"){p=e[v.id]||c;if(p){v.value=f(v.value,p)}else{v.value=f(v.value)}}});return a}};return{'create':function(i,s){try{if(arguments.length===0){return new sap.viz.chartpopover.ChartPopover()}else if(arguments.length===1){return new sap.viz.chartpopover.ChartPopover(i)}else{return new sap.viz.chartpopover.ChartPopover(i,s)}}catch(e){_();return arguments.callee.apply(this,arguments)}}}});define('sap/viz/controls/popover/PopOver',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/popover/chartpopover/ChartPopover'],function($,V,O,u,L,C){var P=function(o){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.popover.PopOver";try{jQuery.sap.require("sap.m.Label");jQuery.sap.require("sap.m.List");jQuery.sap.require("sap.m.Bar");jQuery.sap.require("sap.m.Page");jQuery.sap.require("sap.m.ActionListItem");jQuery.sap.require("sap.m.ResponsivePopover");jQuery.sap.require("sap.m.StandardListItem");jQuery.sap.require("sap.m.DisplayListItem");jQuery.sap.require("sap.m.Panel");jQuery.sap.require("sap.m.Button")}catch(e){throw u.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.m','PopOver')}this._chartPopover=C.create(o)};O.extend(P,V);P.prototype._onConnect=function(v,m){P.superclass._onConnect.apply(this,arguments);this._vizProxy().on('showTooltip.PopOver',jQuery.proxy(function(e){this._chartPopover.setOptions(e.data).openBy(e.data.target)},this));this._vizProxy().on('hideTooltip.PopOver',jQuery.proxy(function(){this._chartPopover.close()},this))};P.prototype._onDisconnect=function(){P.superclass._onDisconnect.apply(this,arguments);this._vizProxy().off('showTootip.PopOver');this._vizProxy().off('hideTooltip.PopOver')};P.prototype.destroy=function(){P.superclass.destroy.apply(this,arguments);this._vizProxy().off('showTooltip.PopOver');this._vizProxy().off('hideTooltip.PopOver')};P.prototype.setContents=function(c){for(var i=0;i<c.length;i++){this._chartPopover.addContent(c[i])}};P.prototype.setActionItems=function(a){for(var i=0;i<a.length;i++){this._chartPopover.addActionItem(a[i])}};P.prototype.setSubActionItems=function(a){for(var i=0;i<a.length;i++){this._chartPopover.addSubActionItem(a[i])}};P.prototype.setFormatString=function(v){this._chartPopover.setFormatString(v)};return P});(function(g){var e=("sap/viz/controls/Version,sap/viz/controls/common/config/GlobalConfig,sap/viz/controls/common/constants/ChartConst,sap/viz/controls/common/constants/CSSConst,sap/viz/controls/common/constants/DatasetTypeConst,sap/viz/controls/common/constants/FilterEventConst,sap/viz/controls/common/feeds/AnalysisObject,sap/viz/controls/common/feeds/AnalyticalType,sap/viz/controls/common/feeds/AutoFeedingUtils,sap/viz/controls/common/feeds/FeedItem,sap/viz/controls/common/feeds/FeedItemType,sap/viz/controls/common/feeds/HierarchyLevelObject,sap/viz/controls/common/filter/AbstractFilter,sap/viz/controls/common/filter/DateRangeFilter,sap/viz/controls/common/filter/NumericRangeFilter,sap/viz/controls/common/filter/ValueFilter,sap/viz/controls/common/managers/DragManager,sap/viz/controls/common/managers/LangManager,sap/viz/controls/common/utils/InfoChartUtil,sap/viz/controls/common/utils/Serialization,sap/viz/controls/common/utils/Feeds,sap/viz/controls/common/views/menu/MenuGroup,sap/viz/controls/common/views/menu/MenuItem,sap/viz/controls/common/views/feed/FeedListEvent,sap/viz/controls/common/events/FeedEvent,sap/viz/controls/services/FakeDataService,sap/viz/controls/annotationcontrol/AnnotationItem,sap/viz/controls/chart/Chart,sap/viz/controls/chart/views/ChartEvent,sap/viz/controls/plugins/infochart/setup,sap/viz/controls/frame/VizFrame,sap/viz/controls/frame/VizFrameEvent,sap/viz/controls/playcontrol/PlayControl,sap/viz/controls/popover/PopOver,sap/viz/controls/dedicatedlegend/DedicatedLegend").split(/,\s*/);if(e[0]==="// REPLACE_"+"EXPORT_LIST_HERE")e=['sap/viz/controls/annotationcontrol/AnnotationItem','sap/viz/controls/builder/VizBuilder','sap/viz/controls/chart/Chart','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/FilterEventConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/Serialization','sap/viz/controls/common/utils/Feeds','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/views/menu/MenuItem','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/feeding/FeedingPanel','sap/viz/controls/filterbar/FilterBar','sap/viz/controls/filterbar/FilterBarEvent','sap/viz/controls/filterbar/FilterItem','sap/viz/controls/frame/VizFrame','sap/viz/controls/frame/VizFrameEvent','sap/viz/controls/mapbuilder/MapBuilder','sap/viz/controls/playcontrol/PlayControl','sap/viz/controls/plugins/infochart/setup','sap/viz/controls/propertyeditor/PropertyEditor','sap/viz/controls/services/FakeDataService','sap/viz/controls/switchbar/SwitchBar','sap/viz/controls/popover/PopOver','sap/viz/controls/dedicatedlegend/DedicatedLegend','sap/viz/controls/Version'];var j=g.jQuery;if(j){if(jQuery.holdReady){jQuery.holdReady(true)}else{jQuery.readyWait+=1}}require(e,function(){var a=arguments;e.forEach(function(m,i){var n=m.split("/");n.reduce(function(p,c,b){if(!p[c]){if(b<n.length-1){p[c]={}}else{p[c]=a[i]}}return p[c]},g)});if(j){if(jQuery.holdReady){jQuery.holdReady(false)}else{jQuery.ready(true)}}})})(this);if(window.__sap_viz_internal_requirejs_nextTick__!==undefined){if(requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._){requirejs.s.contexts._.nextTick=window.__sap_viz_internal_requirejs_nextTick__}window.__sap_viz_internal_requirejs_nextTick__=undefined}
